!function(e){function t(t){for(var r,a,s=t[0],c=t[1],u=t[2],f=0,d=[];f<s.length;f++)a=s[f],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&d.push(i[a][0]),i[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);d.length;)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={1:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;o.push([257,0]),n()}([,function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function c(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function u(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}Object.create},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getScreen=t.getUI=t.getLayer=t.constructScreen=t.getEngine=t.setScale=t.maxScale=t.scale=t.engine=t.event=void 0;const a=o(n(141)),s=o(n(78)),c=n(123);t.event=new c.EventEmitter;let u,l,f,d,p,h=!1;function m(e){t.maxScale=e;let n=y();setTimeout(()=>{t.event.emit("scale-change",n)},100)}function y(){const e=window.innerWidth;let n;return n=e>=2e3?5:e>=1500?4:e>=900?3:2,n>t.maxScale?t.scale=t.maxScale:t.scale=n,n>t.maxScale?t.maxScale:n}t.scale=3,t.maxScale=3,t.setScale=m,t.getEngine=function(){return t.engine},window.scale=m,t.constructScreen=function(e){t.engine=e.rendering.getEngine();const n=e.rendering.getScene();u=new a.Scene(t.engine),l=s.AdvancedDynamicTexture.CreateFullscreenUI("UI",!0,n,a.Texture.NEAREST_SAMPLINGMODE),f=s.AdvancedDynamicTexture.CreateFullscreenUI("UI",!1,u,a.Texture.NEAREST_SAMPLINGMODE),d=new s.Rectangle,d.thickness=0,d.isPointerBlocker=!1,d.zIndex=1e3,l.addControl(d),p=new s.Rectangle,p.thickness=0,p.isPointerBlocker=!1,p.zIndex=1e3,f.addControl(p),t.engine.onResizeObservable.add(e=>{l.getContext().imageSmoothingEnabled=!1,f.getContext().imageSmoothingEnabled=!1,t.event.emit("resize",e),y(),setTimeout(()=>{t.event.emit("scale-change",t.scale)},50)}),l.getContext().imageSmoothingEnabled=!1,f.getContext().imageSmoothingEnabled=!1,u.autoClear=!1,new a.ArcRotateCamera("Camera",-Math.PI/2,7*Math.PI/16,10,a.Vector3.Zero(),u),h=!0,e.rendering._multiscenes.push(u),y()},t.getLayer=function(e){if(!h)throw"Scenes aren't initialized yet!";if(0==e)return u;throw"Invalid number"},t.getUI=function(e){if(!h)throw"UIs aren't initialized yet!";if(0==e)return l;if(1==e)return f;throw"Invalid number"},t.getScreen=function(e){if(!h)throw"UIs aren't initialized yet!";if(0==e)return d;if(1==e)return p;throw"Invalid number"}},,,,,,,function(e,t,n){e.exports={EPSILON:n(221),create:n(222),clone:n(258),angle:n(259),fromValues:n(223),copy:n(260),set:n(261),equals:n(262),exactEquals:n(263),add:n(264),subtract:n(226),sub:n(265),multiply:n(227),mul:n(266),divide:n(228),div:n(267),min:n(268),max:n(269),floor:n(270),ceil:n(271),round:n(272),scale:n(273),scaleAndAdd:n(274),distance:n(229),dist:n(275),squaredDistance:n(230),sqrDist:n(276),length:n(231),len:n(277),squaredLength:n(232),sqrLen:n(278),negate:n(279),inverse:n(280),normalize:n(224),dot:n(225),cross:n(281),lerp:n(282),random:n(283),transformMat4:n(284),transformMat3:n(285),transformQuat:n(286),rotateX:n(287),rotateY:n(288),rotateZ:n(289),forEach:n(290)}},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hostedOn=t.parms=t.hostname=t.setNoa=t.noa=t.defaultFonts=t.noaOpts=t.updateServerSettings=t.serverSettings=t.defaultServerSettings=t.updateSettings=t.gameSettings=t.defaultSettings=t.gameProtocol=t.gameVersion=void 0;const r=n(247),i=n(137),o=n(70);t.gameVersion="0.2.0-beta.9.1",t.gameProtocol=2,t.defaultSettings={version:"0.0.0",nickname:"Player"+Math.round(1e5*Math.random()),autostep:i.isMobile,gamepad:!1,singleplayer:!1,allowcustom:!1,mouse:i.isMobile?50:15,viewDistance:i.isMobile?3:i.isFirefox?2:6,hotbarsize:9,scale:3},t.gameSettings={...t.defaultSettings,version:t.gameVersion},t.updateSettings=function(e){t.gameSettings={...t.defaultSettings,...e},o.setScale(t.gameSettings.scale),r.saveSettings(t.gameSettings)},t.defaultServerSettings={cheats:!1,control:!1,ingame:!1},t.serverSettings={...t.defaultServerSettings},t.updateServerSettings=function(e){t.serverSettings={...t.serverSettings,...e}},t.noaOpts=function(){return{debug:!0,showFPS:!0,inverseY:!1,inverseX:!1,sensitivityX:t.gameSettings.mouse,sensitivityY:t.gameSettings.mouse,chunkSize:32,chunkAddDistance:t.gameSettings.viewDistance,chunkRemoveDistance:t.gameSettings.viewDistance+.5,blockTestDistance:7,tickRate:i.isMobile?65:50,texturePath:"",playerStart:[0,100,0],playerHeight:1.85,playerWidth:.5,playerAutoStep:t.gameSettings.autostep?1:0,clearColor:[.8,.9,1],ambientColor:[1,1,1],lightDiffuse:[1,1,1],lightSpecular:[1,1,1],groundLightColor:[.5,.5,.5],useAO:!0,AOmultipliers:[.93,.8,.5],reverseAOmultiplier:1,preserveDrawingBuffer:!0,adaptToDeviceRatio:!1,gravity:[0,-14,0],bindings:{forward:["W"],left:["A"],backward:["S"],right:["D"],fire:"<mouse 1>","mid-fire":["<mouse 2>"],"alt-fire":["<mouse 3>"],jump:"<space>",inventory:["E"],muteMusic:["O"],thirdprsn:["M"],chatenter:["<enter>"],chat:["T"],cmd:["/"],tab:["`"],menu:["<escape>"],screenshot:["P"]}}},t.defaultFonts=["silkscreen","Lato","Lato-Italic","Lato-Black","Lato-BlackItalic","Lato-Bold","Lato-BoldItalic","Lato-Light","Lato-LightItalic","Lato-Thin","Lato-ThinItalic"],t.noa=null,t.setNoa=function(e){t.noa=e};let a="???";t.hostname=window.location.hostname,t.parms=new URLSearchParams(window.location.search),a="0.0.0.0"==t.hostname||"localhost"==t.hostname?"Localhost/DEV":"voxelsrv-master.pb4.eu"==t.hostname?"Development":"voxelsrv.pb4.eu"==t.hostname||"pb4.eu"==t.hostname||null!=window.electron?"":"Unofficial/Undefined rehost!",t.hostedOn=a},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,r){function i(){void 0!==o&&e.removeListener("error",o),n([].slice.call(arguments))}var o;"error"!==t&&(o=function(n){e.removeListener(t,i),r(n)},e.once("error",o)),e.once(t,i)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function f(e,t,n,r){var i,o,a,s;if(u(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=l(e))>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=d.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):y(i,i.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)o(c,this,t);else{var u=c.length,l=y(c,u);for(n=0;n<u;++n)o(l[n],this,t)}return!0},s.prototype.addListener=function(e,t){return f(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return f(this,e,t,!0)},s.prototype.once=function(e,t){return u(t),this.on(e,p(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,p(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,o,a;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return h(this,e,!0)},s.prototype.rawListeners=function(e){return h(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},,,,,,,function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createButton=t.createCheckbox=t.createSlider=t.createInput=t.createItem=void 0;const a=n(70),s=n(156),c=o(n(78));t.createItem=function(){const e=new c.Rectangle;e.width=100*a.scale+"px",e.height=18*a.scale+"px",e.isPointerBlocker=!0,e.horizontalAlignment=2,e.thickness=0,e.paddingBottom="10px",e.zIndex=10;const t=new s.FormTextBlock;return t.text=[{text:"MenuItemText",color:"white",font:"Lato"}],t.fontSize=10*a.scale,t.textHorizontalAlignment=2,e.addControl(t),e.onPointerEnterObservable.add(e=>{t.text.forEach(e=>e.underline=!0),t._markAsDirty()}),e.onPointerOutObservable.add(e=>{t.text.forEach(e=>e.underline=!1),t._markAsDirty()}),{item:e,text:t}},t.createInput=function(){const e=new c.Rectangle;e.height=28*a.scale+"px",e.adaptWidthToChildren=!0,e.thickness=0;const t=new c.TextBlock;t.fontFamily="Lato",t.fontSize=9*a.scale,t.textVerticalAlignment=0,t.color="white",t.text="Input",t.top=a.scale,t.verticalAlignment=0,e.addControl(t);const n=new c.InputText;n.thickness=0,n.background="#ffffffaa",n.focusedBackground="#ffffffff",n.placeholderText="Placeholder",n.color="#666666",n.verticalAlignment=0,n.height=15*a.scale+"px",n.width=100*a.scale+"px",n.top=14*a.scale+"px",e.addControl(n);const r=r=>{e.height=28*a.scale+"px",t.fontSize=9*a.scale,n.height=15*a.scale+"px",n.width=100*a.scale+"px",n.top=14*a.scale+"px"};return a.event.on("scale-change",r),e.onDisposeObservable.add(()=>{a.event.off("scale-change",r)}),{main:e,name:t,input:n}},t.createSlider=function(){const e=new c.Rectangle;e.height=28*a.scale+"px",e.adaptWidthToChildren=!0,e.thickness=0;const t=new c.TextBlock;t.fontFamily="Lato",t.fontSize=9*a.scale,t.textVerticalAlignment=0,t.color="white",t.text="Slider",t.top=a.scale,t.verticalAlignment=0,e.addControl(t);const n=new c.Slider;n.minimum=0,n.maximum=100,n.value=0,n.height=13*a.scale+"px",n.width=100*a.scale+"px",n.top=14*a.scale+"px",n.verticalAlignment=0,n.color="#666666",n.thumbColor="#888888",n.background="#ffffffaa",n.borderColor="#00000000",n.barOffset=6,e.addControl(n);const r=r=>{e.height=28*a.scale+"px",t.fontSize=9*a.scale,n.height=10*a.scale+"px",n.width=100*a.scale+"px",n.top=14*a.scale+"px"};return a.event.on("scale-change",r),e.onDisposeObservable.add(()=>{a.event.off("scale-change",r)}),{main:e,name:t,slider:n}},t.createCheckbox=function(){const e=new c.Rectangle;e.height=12*a.scale+"px",e.adaptWidthToChildren=!0,e.isPointerBlocker=!0,e.thickness=0;const t=new c.TextBlock;t.fontFamily="Lato",t.fontSize=9*a.scale,t.textVerticalAlignment=0,t.color="white",t.text="Checkbox",t.top=a.scale,t.verticalAlignment=0,t.width=100*a.scale+"px",e.addControl(t);const n=n=>{e.height=28*a.scale+"px",t.fontSize=9*a.scale,t.width=100*a.scale+"px"};return a.event.on("scale-change",n),e.onDisposeObservable.add(()=>{a.event.off("scale-change",n)}),{main:e,name:t,isChecked:!1}},t.createButton=function(){const e=new c.Rectangle;e.height=17*a.scale+"px",e.width=64*a.scale+"px",e.verticalAlignment=0,e.horizontalAlignment=0,e.thickness=0,e.background="#4d4d4daa",e.color="#666666";const t=new s.FormTextBlock;t.text=[{text:"Text",color:"white",font:"Lato"}],t.textHorizontalAlignment=2,t.fontSize=6*a.scale,t.onPointerEnterObservable.add(e=>{t.text.forEach(e=>e.underline=!0),t._markAsDirty()}),t.onPointerOutObservable.add(e=>{t.text.forEach(e=>e.underline=!1),t._markAsDirty()}),e.addControl(t);const n=n=>{e.height=17*a.scale+"px",e.width=64*a.scale+"px",t.fontSize=6*a.scale};return a.event.on("scale-change",n),e.onDisposeObservable.add(()=>{a.event.off("scale-change",n)}),{button:e,buttonText:t}}},function(e,t,n){"use strict";(function(e){var r=t;function i(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function o(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&i(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=n(340),r.base64=n(341),r.EventEmitter=n(342),r.float=n(343),r.inquire=n(344),r.utf8=n(345),r.pool=n(346),r.LongBits=n(347),r.isNode=Boolean(void 0!==e&&e&&e.process&&e.process.versions&&e.process.versions.node),r.global=r.isNode&&e||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=i,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}}).call(this,n(154))},function(e,t,n){var r=n(233),i=n(291),o="undefined"!=typeof Float64Array;function a(e,t){return e[0]-t[0]}function s(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(a);var r=new Array(n.length);for(e=0;e<r.length;++e)r[e]=n[e][1];return r}function c(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var i="generic"===e;if(-1===t){var o="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(o)()}if(0===t){o="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",o)(u[e][0])}o=["'use strict'"];var a=r(t),c=a.map((function(e){return"i"+e})),l="this.offset+"+a.map((function(e){return"this.stride["+e+"]*i"+e})).join("+"),f=a.map((function(e){return"b"+e})).join(","),d=a.map((function(e){return"c"+e})).join(",");o.push("function "+n+"(a,"+f+","+d+",d){this.data=a","this.shape=["+f+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+a.map((function(e){return"this.shape["+e+"]"})).join("*"),"}})"),1===t?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),t<4?(o.push("function "+n+"_order(){"),2===t?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+c.join(",")+",v){"),i?o.push("return this.data.set("+l+",v)}"):o.push("return this.data["+l+"]=v}"),o.push("proto.get=function "+n+"_get("+c.join(",")+"){"),i?o.push("return this.data.get("+l+")}"):o.push("return this.data["+l+"]}"),o.push("proto.index=function "+n+"_index(",c.join(),"){return "+l+"}"),o.push("proto.hi=function "+n+"_hi("+c.join(",")+"){return new "+n+"(this.data,"+a.map((function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")})).join(",")+","+a.map((function(e){return"this.stride["+e+"]"})).join(",")+",this.offset)}");var p=a.map((function(e){return"a"+e+"=this.shape["+e+"]"})),h=a.map((function(e){return"c"+e+"=this.stride["+e+"]"}));o.push("proto.lo=function "+n+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+h.join(","));for(var m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");o.push("return new "+n+"(this.data,"+a.map((function(e){return"a"+e})).join(",")+","+a.map((function(e){return"c"+e})).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+c.join(",")+"){var "+a.map((function(e){return"a"+e+"=this.shape["+e+"]"})).join(",")+","+a.map((function(e){return"b"+e+"=this.stride["+e+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");o.push("return new "+n+"(this.data,"+a.map((function(e){return"a"+e})).join(",")+","+a.map((function(e){return"b"+e})).join(",")+",c)}");var y=new Array(t),v=new Array(t);for(m=0;m<t;++m)y[m]="a[i"+m+"]",v[m]="b[i"+m+"]";o.push("proto.transpose=function "+n+"_transpose("+c+"){"+c.map((function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+y.join(",")+","+v.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+c+"){var a=[],b=[],c=this.offset");for(m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");return o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+a.map((function(e){return"shape["+e+"]"})).join(",")+","+a.map((function(e){return"stride["+e+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",o.join("\n"))(u[e],s)}var u={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};e.exports=function(e,t,n,r){if(void 0===e)return(0,u.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var a=t.length;if(void 0===n){n=new Array(a);for(var s=a-1,l=1;s>=0;--s)n[s]=l,l*=t[s]}if(void 0===r){r=0;for(s=0;s<a;++s)n[s]<0&&(r-=(t[s]-1)*n[s])}for(var f=function(e){if(i(e))return"buffer";if(o)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(e)?"array":"generic"}(e),d=u[f];d.length<=a+1;)d.push(c(f,d.length-1));return(0,d[a+1])(e,t,n,r)}},,,,,function(e,t){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";var r={MOBILE:"mobile",TABLET:"tablet",SMART_TV:"smarttv",CONSOLE:"console",WEARABLE:"wearable",BROWSER:void 0};e.exports={BROWSER_TYPES:{CHROME:"Chrome",FIREFOX:"Firefox",OPERA:"Opera",YANDEX:"Yandex",SAFARI:"Safari",INTERNET_EXPLORER:"Internet Explorer",EDGE:"Edge",CHROMIUM:"Chromium",IE:"IE",MOBILE_SAFARI:"Mobile Safari",EDGE_CHROMIUM:"Edge Chromium"},DEVICE_TYPES:r,OS_TYPES:{IOS:"iOS",ANDROID:"Android",WINDOWS_PHONE:"Windows Phone",WINDOWS:"Windows",MAC_OS:"Mac OS"},defaultData:{isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1}}},function(e,t,n){"use strict";var r,i=n(2),o=n(0),a=o.BROWSER_TYPES,s=o.OS_TYPES,c=o.DEVICE_TYPES,u=n(4),l=u.checkType,f=u.broPayload,d=u.mobilePayload,p=u.wearPayload,h=u.consolePayload,m=u.stvPayload,y=u.getNavigatorInstance,v=u.isIOS13Check,g=new i,b=g.getBrowser(),w=g.getDevice(),_=g.getEngine(),k=g.getOS(),x=g.getUA(),O=a.CHROME,P=a.CHROMIUM,S=a.IE,C=a.INTERNET_EXPLORER,T=a.OPERA,E=a.FIREFOX,j=a.SAFARI,M=a.EDGE,D=a.YANDEX,I=a.MOBILE_SAFARI,R=c.MOBILE,A=c.TABLET,B=c.SMART_TV,L=c.BROWSER,z=c.WEARABLE,N=c.CONSOLE,F=s.ANDROID,U=s.WINDOWS_PHONE,V=s.IOS,G=s.WINDOWS,W=s.MAC_OS,q=function(){return k.name===s.WINDOWS&&"10"===k.version&&("string"==typeof x&&-1!==x.indexOf("Edg/"))},K=function(){return b.name===M},Y=function(){return v("iPad")},J=w.type===B,H=w.type===N,X=w.type===z,$=b.name===I||Y(),Z=b.name===P,Q=function(){switch(w.type){case R:case A:return!0;default:return!1}}()||Y(),ee=w.type===R,te=w.type===A||Y(),ne=w.type===L,re=k.name===F,ie=k.name===U,oe=k.name===V||Y(),ae=b.name===O,se=b.name===E,ce=b.name===j||b.name===I,ue=b.name===T,le=b.name===C||b.name===S,fe=k.version?k.version:"none",de=k.name?k.name:"none",pe=b.major,he=b.version,me=b.name,ye=w.vendor?w.vendor:"none",ve=w.model?w.model:"none",ge=_.name,be=_.version,we=x,_e=K()||q(),ke=b.name===D,xe=w.type,Oe=(r=y())&&(/iPad|iPhone|iPod/.test(r.platform)||"MacIntel"===r.platform&&r.maxTouchPoints>1)&&!window.MSStream,Pe=Y(),Se=v("iPhone"),Ce=v("iPod"),Te=function(){var e=y(),t=e&&e.userAgent.toLowerCase();return"string"==typeof t&&/electron/.test(t)}(),Ee=q(),je=K(),Me=k.name===G,De=k.name===W,Ie=l(w.type);e.exports={deviceDetect:function(){var e=Ie.isBrowser,t=Ie.isMobile,n=Ie.isTablet,r=Ie.isSmartTV,i=Ie.isConsole,o=Ie.isWearable;return e?f(e,b,_,k,x):r?m(r,_,k,x):i?h(i,_,k,x):t||n?d(Ie,w,k,x):o?p(o,_,k,x):void 0},isSmartTV:J,isConsole:H,isWearable:X,isMobileSafari:$,isChromium:Z,isMobile:Q,isMobileOnly:ee,isTablet:te,isBrowser:ne,isAndroid:re,isWinPhone:ie,isIOS:oe,isChrome:ae,isFirefox:se,isSafari:ce,isOpera:ue,isIE:le,osVersion:fe,osName:de,fullBrowserVersion:pe,browserVersion:he,browserName:me,mobileVendor:ye,mobileModel:ve,engineName:ge,engineVersion:be,getUA:we,isEdge:_e,isYandex:ke,deviceType:xe,isIOS13:Oe,isIPad13:Pe,isIPhone13:Se,isIPod13:Ce,isElectron:Te,isEdgeChromium:Ee,isLegacyEdge:je,isWindows:Me,isMacOs:De}},function(e,t,n){var r;
/*!
 * UAParser.js v0.7.18
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright Â© 2012-2016 Faisal Salman <fyzlman@gmail.com>
 * Dual licensed under GPLv2 or MIT
 */!function(i,o){"use strict";var a="model",s="name",c="type",u="vendor",l="version",f="mobile",d="tablet",p={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},h={rgx:function(e,t){for(var n,r,i,o,a,s,c=0;c<t.length&&!a;){var u=t[c],l=t[c+1];for(n=r=0;n<u.length&&!a;)if(a=u[n++].exec(e))for(i=0;i<l.length;i++)s=a[++r],"object"==typeof(o=l[i])&&o.length>0?2==o.length?"function"==typeof o[1]?this[o[0]]=o[1].call(this,s):this[o[0]]=o[1]:3==o.length?"function"!=typeof o[1]||o[1].exec&&o[1].test?this[o[0]]=s?s.replace(o[1],o[2]):void 0:this[o[0]]=s?o[1].call(this,s,o[2]):void 0:4==o.length&&(this[o[0]]=s?o[3].call(this,s.replace(o[1],o[2])):void 0):this[o]=s||void 0;c+=2}},str:function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(p.has(t[n][r],e))return"?"===n?void 0:n}else if(p.has(t[n],e))return"?"===n?void 0:n;return e}},m={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},y={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[s,l],[/(opios)[\/\s]+([\w\.]+)/i],[[s,"Opera Mini"],l],[/\s(opr)\/([\w\.]+)/i],[[s,"Opera"],l],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark)\/([\w\.-]+)/i],[s,l],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[s,"IE"],l],[/(edge|edgios|edgea)\/((\d+)?[\w\.]+)/i],[[s,"Edge"],l],[/(yabrowser)\/([\w\.]+)/i],[[s,"Yandex"],l],[/(puffin)\/([\w\.]+)/i],[[s,"Puffin"],l],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[s,"UCBrowser"],l],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],l],[/(micromessenger)\/([\w\.]+)/i],[[s,"WeChat"],l],[/(qqbrowserlite)\/([\w\.]+)/i],[s,l],[/(QQ)\/([\d\.]+)/i],[s,l],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[s,l],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[s,l],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[s,l],[/(MetaSr)[\/\s]?([\w\.]+)/i],[s],[/(LBBROWSER)/i],[s],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[l,[s,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[l,[s,"Facebook"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[l,[s,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[s,/(.+)/,"$1 WebView"],l],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[s,/(.+(?:g|us))(.+)/,"$1 $2"],l],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[l,[s,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[s,l],[/(dolfin)\/([\w\.]+)/i],[[s,"Dolphin"],l],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[s,"Chrome"],l],[/(coast)\/([\w\.]+)/i],[[s,"Opera Coast"],l],[/fxios\/([\w\.-]+)/i],[l,[s,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[l,[s,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[l,s],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[s,"GSA"],l],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[s,[l,h.str,m.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[s,l],[/(navigator|netscape)\/([\w\.-]+)/i],[[s,"Netscape"],l],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[s,l]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",p.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",p.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",p.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[a,u,[c,d]],[/applecoremedia\/[\w\.]+ \((ipad)/],[a,[u,"Apple"],[c,d]],[/(apple\s{0,1}tv)/i],[[a,"Apple TV"],[u,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[u,a,[c,d]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[a,[u,"Amazon"],[c,d]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[a,h.str,m.device.amazon.model],[u,"Amazon"],[c,f]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[a,u,[c,f]],[/\((ip[honed|\s\w*]+);/i],[a,[u,"Apple"],[c,f]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[u,a,[c,f]],[/\(bb10;\s(\w+)/i],[a,[u,"BlackBerry"],[c,f]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[a,[u,"Asus"],[c,d]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[u,"Sony"],[a,"Xperia Tablet"],[c,d]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[a,[u,"Sony"],[c,f]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[u,a,[c,"console"]],[/android.+;\s(shield)\sbuild/i],[a,[u,"Nvidia"],[c,"console"]],[/(playstation\s[34portablevi]+)/i],[a,[u,"Sony"],[c,"console"]],[/(sprint\s(\w+))/i],[[u,h.str,m.device.sprint.vendor],[a,h.str,m.device.sprint.model],[c,f]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[u,a,[c,d]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[u,[a,/_/g," "],[c,f]],[/(nexus\s9)/i],[a,[u,"HTC"],[c,d]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[a,[u,"Huawei"],[c,f]],[/(microsoft);\s(lumia[\s\w]+)/i],[u,a,[c,f]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[a,[u,"Microsoft"],[c,"console"]],[/(kin\.[onetw]{3})/i],[[a,/\./g," "],[u,"Microsoft"],[c,f]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[a,[u,"Motorola"],[c,f]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[a,[u,"Motorola"],[c,d]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[u,p.trim],[a,p.trim],[c,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[a,/^/,"SmartTV"],[u,"Samsung"],[c,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[a,[u,"Sharp"],[c,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[u,"Samsung"],a,[c,d]],[/smart-tv.+(samsung)/i],[u,[c,"smarttv"],a],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[u,"Samsung"],a,[c,f]],[/sie-(\w*)/i],[a,[u,"Siemens"],[c,f]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[u,"Nokia"],a,[c,f]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[a,[u,"Acer"],[c,d]],[/android.+([vl]k\-?\d{3})\s+build/i],[a,[u,"LG"],[c,d]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[u,"LG"],a,[c,d]],[/(lg) netcast\.tv/i],[u,a,[c,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[a,[u,"LG"],[c,f]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[a,[u,"Lenovo"],[c,d]],[/linux;.+((jolla));/i],[u,a,[c,f]],[/((pebble))app\/[\d\.]+\s/i],[u,a,[c,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[u,a,[c,f]],[/crkey/i],[[a,"Chromecast"],[u,"Google"]],[/android.+;\s(glass)\s\d/i],[a,[u,"Google"],[c,"wearable"]],[/android.+;\s(pixel c)\s/i],[a,[u,"Google"],[c,d]],[/android.+;\s(pixel xl|pixel)\s/i],[a,[u,"Google"],[c,f]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[a,/_/g," "],[u,"Xiaomi"],[c,f]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[a,/_/g," "],[u,"Xiaomi"],[c,d]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[a,[u,"Meizu"],[c,d]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[a,[u,"OnePlus"],[c,f]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[a,[u,"RCA"],[c,d]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[a,[u,"Dell"],[c,d]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[a,[u,"Verizon"],[c,d]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[u,"Barnes & Noble"],a,[c,d]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[a,[u,"NuVision"],[c,d]],[/android.+;\s(k88)\sbuild/i],[a,[u,"ZTE"],[c,d]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[a,[u,"Swiss"],[c,f]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[a,[u,"Swiss"],[c,d]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[a,[u,"Zeki"],[c,d]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[u,"Dragon Touch"],a,[c,d]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[a,[u,"Insignia"],[c,d]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[a,[u,"NextBook"],[c,d]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[u,"Voice"],a,[c,f]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[u,"LvTel"],a,[c,f]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[a,[u,"Envizen"],[c,d]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[u,a,[c,d]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[a,[u,"MachSpeed"],[c,d]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[u,a,[c,d]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[a,[u,"Rotor"],[c,d]],[/android.+(KS(.+))\s+build/i],[a,[u,"Amazon"],[c,d]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[u,a,[c,d]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[c,p.lowerize],u,a],[/(android[\w\.\s\-]{0,9});.+build/i],[a,[u,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[l,[s,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,l],[/rv\:([\w\.]{1,9}).+(gecko)/i],[l,s]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[s,l],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s,[l,h.str,m.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[l,h.str,m.os.windows.version]],[/\((bb)(10);/i],[[s,"BlackBerry"],l],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]*)/i,/linux;.+(sailfish);/i],[s,l],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[s,"Symbian"],l],[/\((series40);/i],[s],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"],l],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[s,l],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],l],[/(sunos)\s?([\w\.\d]*)/i],[[s,"Solaris"],l],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[s,l],[/(haiku)\s(\w+)/i],[s,l],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[l,/_/g,"."],[s,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[s,"Mac OS"],[l,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]*)/i],[s,l]]},v=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof v))return new v(e,t).getResult();var n=e||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),r=t?p.extend(y,t):y;return this.getBrowser=function(){var e={name:void 0,version:void 0};return h.rgx.call(e,n,r.browser),e.major=p.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return h.rgx.call(e,n,r.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return h.rgx.call(e,n,r.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return h.rgx.call(e,n,r.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return h.rgx.call(e,n,r.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this};v.VERSION="0.7.18",v.BROWSER={NAME:s,MAJOR:"major",VERSION:l},v.CPU={ARCHITECTURE:"architecture"},v.DEVICE={MODEL:a,VENDOR:u,TYPE:c,CONSOLE:"console",MOBILE:f,SMARTTV:"smarttv",TABLET:d,WEARABLE:"wearable",EMBEDDED:"embedded"},v.ENGINE={NAME:s,VERSION:l},v.OS={NAME:s,VERSION:l},void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=v),t.UAParser=v):n(3)?void 0===(r=function(){return v}.call(t,n,t,e))||(e.exports=r):i&&(i.UAParser=v);var g=i&&(i.jQuery||i.Zepto);if(void 0!==g){var b=new v;g.ua=b.getResult(),g.ua.get=function(){return b.getUA()},g.ua.set=function(e){b.setUA(e);var t=b.getResult();for(var n in t)g.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(0),o=i.DEVICE_TYPES,a=i.defaultData,s=t.getNavigatorInstance=function(){return!("undefined"==typeof window||!window.navigator&&!navigator)&&(window.navigator||navigator)},c=t.isIOS13Check=function(e){var t=s();return t&&t.platform&&(-1!==t.platform.indexOf(e)||"MacIntel"===t.platform&&t.maxTouchPoints>1&&!window.MSStream)};e.exports={checkType:function(e){switch(e){case o.MOBILE:return{isMobile:!0};case o.TABLET:return{isTablet:!0};case o.SMART_TV:return{isSmartTV:!0};case o.CONSOLE:return{isConsole:!0};case o.WEARABLE:return{isWearable:!0};case o.BROWSER:return{isBrowser:!0};default:return a}},broPayload:function(e,t,n,r,i){return{isBrowser:e,browserMajorVersion:t.major,browserFullVersion:t.version,browserName:t.name,engineName:n.name||!1,engineVersion:n.version,osName:r.name,osVersion:r.version,userAgent:i}},mobilePayload:function(e,t,n,i){return r({},e,{vendor:t.vendor,model:t.model,os:n.name,osVersion:n.version,ua:i})},stvPayload:function(e,t,n,r){return{isSmartTV:e,engineName:t.name,engineVersion:t.version,osName:n.name,osVersion:n.version,userAgent:r}},consolePayload:function(e,t,n,r){return{isConsole:e,engineName:t.name,engineVersion:t.version,osName:n.name,osVersion:n.version,userAgent:r}},wearPayload:function(e,t,n,r){return{isWearable:e,engineName:t.name,engineVersion:t.version,osName:n.name,osVersion:n.version,userAgent:r}},getNavigatorInstance:s,isIOS13Check:c}}])},,,,,,,,,,,,,,,,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormTextBlock=void 0;const r=n(4),i=n(34),o=n(24);class a extends o.Control{constructor(e,t=[]){super(e),this.name=e,this._text=[],this._textHorizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_CENTER,this._textVerticalAlignment=o.Control.VERTICAL_ALIGNMENT_CENTER,this._resizeToFit=!1,this._lineSpacing=new i.ValueAndUnit(0),this._outlineColor="white",this.shouldhide=!1,this.onTextChangedObservable=new r.Observable,this.onLinesReadyObservable=new r.Observable,this.text=t}get lines(){return this._lines}get resizeToFit(){return this._resizeToFit}set resizeToFit(e){this._resizeToFit!==e&&(this._resizeToFit=e,this._resizeToFit&&(this._width.ignoreAdaptiveScaling=!0,this._height.ignoreAdaptiveScaling=!0),this._markAsDirty())}get text(){return this._text}set text(e){this._text!==e&&(this._text=e,this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this))}get textHorizontalAlignment(){return this._textHorizontalAlignment}set textHorizontalAlignment(e){this._textHorizontalAlignment!==e&&(this._textHorizontalAlignment=e,this._markAsDirty())}get textVerticalAlignment(){return this._textVerticalAlignment}set textVerticalAlignment(e){this._textVerticalAlignment!==e&&(this._textVerticalAlignment=e,this._markAsDirty())}set lineSpacing(e){this._lineSpacing.fromString(e)&&this._markAsDirty()}get lineSpacing(){return this._lineSpacing.toString(this._host)}_getTypeName(){return"FormTextBlock"}_processMeasures(e,t){this._fontOffset||(this._fontOffset=o.Control._GetFontOffset(t.font)),super._processMeasures(e,t),this._lines=this._breakLines(this._currentMeasure.width,t),this.onLinesReadyObservable.notifyObservers(this);let n=0;for(let e=0;e<this._lines.length;e++){const t=this._lines[e];t.width>n&&(n=t.width)}if(this._resizeToFit){let e=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*this._lines.length|0;if(this._lines.length>0&&0!==this._lineSpacing.internalValue){let t=0;t=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),e+=(this._lines.length-1)*t}e!==this._height.internalValue&&(this._height.updateInPlace(e,i.ValueAndUnit.UNITMODE_PIXEL),this._rebuildLayout=!0)}}_drawText(e,t,n,r){var i=this._currentMeasure.width,a=0;switch(this._textHorizontalAlignment){case o.Control.HORIZONTAL_ALIGNMENT_LEFT:a=0;break;case o.Control.HORIZONTAL_ALIGNMENT_RIGHT:a=i-t;break;case o.Control.HORIZONTAL_ALIGNMENT_CENTER:a=(i-t)/2}if((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(r.shadowColor=this.shadowColor,r.shadowBlur=this.shadowBlur,r.shadowOffsetX=this.shadowOffsetX,r.shadowOffsetY=this.shadowOffsetY),null==e)return;const s=r.fillStyle,c=r.font,u=r.strokeStyle,l=r.lineWidth;e.forEach(e=>{if(null==e.text)return;null==e.font&&(e.font=c),r.font=`${this.fontSize} ${e.font}`,r.fillStyle=e.color||s;const t=r.measureText(e.text);r.lineWidth=Math.round(.05*this.fontSizeInPixels),r.lineCap="square",r.strokeStyle=r.fillStyle,e.underline&&(r.beginPath(),r.moveTo(this._currentMeasure.left+a,n+3),r.lineTo(this._currentMeasure.left+a+t.width,n+3),r.stroke(),r.closePath()),r.fillText(e.text,this._currentMeasure.left+a,n),e.linethrough&&(r.beginPath(),r.moveTo(this._currentMeasure.left+a,n-this.fontSizeInPixels/3),r.lineTo(this._currentMeasure.left+a+t.width,n-this.fontSizeInPixels/3),r.stroke(),r.closePath()),r.font=c,r.strokeStyle=u,r.lineWidth=l,a+=t.width}),r.fillStyle=s,r.font=c,r.strokeStyle=u,r.lineWidth=l}_draw(e,t){e.save(),this._applyStates(e),this._renderLines(e),e.restore()}_applyStates(e){super._applyStates(e)}_breakLines(e,t){var n=[];let r=[[]];for(var i of(this.text.forEach(e=>{let t=e.text.split("\n");if(t.length>1){r[r.length-1].push({text:t[0],color:e.color,font:e.font,underline:e.underline,linethrough:e.linethrough});for(let n=1;n<t.length;n++)r.push([{text:t[n],color:e.color,font:e.font,underline:e.underline,linethrough:e.linethrough}])}else r[r.length-1].push(e)}),r))n.push(...this._parseLineWordWrap(i,e,t));return n}_parseLine(e="",t){return{text:e,width:t.measureText(e).width}}_parseLineWordWrap(e=[],t,n){var r=[],i=[],o="";let a=this.fontFamily;e.forEach(e=>{null==e.font&&(e.font=a),e.text.split(" ").forEach(r=>{if(0==r.length)return;n.font=`${this.fontSize} ${e.font}`;let o=n.measureText(r);if(n.font=a,o.width<t)i.push({text:r+" ",font:e.font,color:e.color});else{const s=r.substring(0,Math.ceil(r.length/2)),c=r.substring(Math.floor(r.length/2));n.font=`${this.fontSize} ${e.font}`,o=n.measureText(s);let u=n.measureText(c);n.font=a,o.width<t?i.push({text:s+" ",font:e.font,color:e.color}):i.push({text:" [...] ",font:e.font,color:e.color}),u.width<t?i.push({text:c+" ",font:e.font,color:e.color}):i.push({text:" [...] ",font:e.font,color:e.color,underline:e.underline,linethrough:e.linethrough})}}),o+=e.text});n.font=`${this.fontSize} ${e[0].font}`;let s=n.measureText(o);if(n.font=a,s.width<t)return[{text:e,width:s.width}];let c="",u=0,l=[];for(var f=0;f<i.length;f++){let e=0==f?i[0].text:c+i[f].text;n.font=`${this.fontSize} ${i[f].font}`;let o=n.measureText(e);if(n.font=a,o.width>t){r.push({text:[...l],width:u}),l=[],e="",u=0;for(let e=0;e<f;e++)i.shift();f=-1}else c=e,u=o.width,l.push(i[f])}return r.push({text:[...l],width:u}),r}_renderLines(e){var t=this._currentMeasure.height,n=0;switch(this._textVerticalAlignment){case o.Control.VERTICAL_ALIGNMENT_TOP:n=this._fontOffset.ascent;break;case o.Control.VERTICAL_ALIGNMENT_BOTTOM:n=t-this._fontOffset.height*(this._lines.length-1)-this._fontOffset.descent;break;case o.Control.VERTICAL_ALIGNMENT_CENTER:n=this._fontOffset.ascent+(t-this._fontOffset.height*this._lines.length)/2}n+=this._currentMeasure.top;for(let t=0;t<this._lines.length;t++){const r=this._lines[t];0!==t&&0!==this._lineSpacing.internalValue&&(this._lineSpacing.isPixel?n+=this._lineSpacing.getValue(this._host):n+=this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)),this._drawText(r.text,r.width,n,e),n+=this._fontOffset.height}}computeExpectedHeight(){if(this.text&&this.widthInPixels){const e=document.createElement("canvas").getContext("2d");if(e){this._applyStates(e),this._fontOffset||(this._fontOffset=o.Control._GetFontOffset(e.font));const t=this._lines?this._lines:this._breakLines(this.widthInPixels-this.paddingLeftInPixels-this.paddingRightInPixels,e);let n=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*t.length;if(t.length>0&&0!==this._lineSpacing.internalValue){let e=0;e=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),n+=(t.length-1)*e}return n}}return 0}dispose(){super.dispose(),this.onTextChangedObservable.clear()}}t.FormTextBlock=a},,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.stopListening=t.connect=t.disconnect=t.socketSend=t.socket=void 0;const i=n(95),o=n(137),a=n(216),s=n(358),c=r(n(360)),u=n(215),l=n(245),f=n(254),d=n(214),p=n(255),h=n(361),m=n(256),y=n(77),v=n(218);t.socket=null;let g,b=null,w=null;function _(e){null!=w&&e.off("tick",w),null!=w&&e.off("beforeRender",b)}t.socketSend=function(e,n){null!=t.socket&&t.socket.send(e,n)},t.disconnect=function(){t.socket.close(),_(g),s.destroyGuis(),i.updateServerSettings({ingame:!1}),a.buildMainMenu(g)},t.connect=function e(n,r){document.title="VoxelSrv - Connecting to server...",g=n,g.worldName="World"+Math.round(1e3*Math.random()),t.socket=r,console.log("Username: "+i.gameSettings.nickname,"Server: "+t.socket.server);let k=!0;null!=a.holder&&a.holder.dispose();const x={};t.socket.on("PlayerKick",(function(n){t.socket.close(),g.ents.getPhysics(g.playerEntity).body.airDrag=9999,Object.values(x).forEach(e=>{g.ents.deleteEntity(e,!0)}),console.log("You has been kicked from server \nReason: "+n.reason),_(g),s.destroyGuis(),c.default(n.reason,t.socket.server,e,g),i.updateServerSettings({ingame:!1})})),t.socket.on("LoginRequest",(function(e){g.worldName="World-"+1e4*Math.random(),g.camera.heading=0,g.camera.pitch=0;e.auth,t.socket.send("LoginResponse",{username:i.gameSettings.nickname,protocol:i.gameProtocol,mobile:o.isMobile,client:"VoxelSrv "+i.gameVersion,uuid:i.gameSettings.nickname.toLocaleLowerCase(),secret:""});let n="";t.socket.on("PlayerEntity",(function(e){console.log("Ignoring player-entity: "+e.uuid),n=e.uuid,null!=x[e.uuid]&&null!=g&&g.ents.deleteEntity(x[e.uuid]),delete x[e.uuid]})),k&&t.socket.on("LoginSuccess",(function(r){if(i.updateServerSettings({ingame:!0}),s.destroyGuis(),p.clearStorage(),document.title="VoxelSrv - Playing on "+t.socket.server,d.registerBlocks(g,JSON.parse(r.blocksDef)),d.registerItems(g,JSON.parse(r.itemsDef)),l.setupPlayer(g,JSON.parse(r.inventory),JSON.parse(r.armor),JSON.parse(r.movement)),m.cloudMesh.dispose(),m.setupClouds(g),s.setupGuis(g,t.socket,r,e),g.ents.setPosition(g.playerEntity,r.xPos,r.yPos,r.zPos),!k)return;k=!1,t.socket.on("WorldChunkLoad",(function(e){p.setChunk(e)})),t.socket.on("WorldChunkUnload",(function(e){if(e.type)for(let t=0;t<=8;t++)p.removeChunk(`${e.x}|${t}|${e.z}`);else p.removeChunk(`${e.x}|${e.y}|${e.z}`)})),t.socket.on("WorldBlockUpdate",(function(e){g.setBlock(e.id,e.x,e.y,e.z),p.chunkSetBlock(e.id,e.x,e.y,e.z)})),t.socket.on("UpdateGameplaySetting",(function(e){const t={};t[e.key]=e.value,i.updateServerSettings(t)})),t.socket.on("PlayerInventory",(function(e){const t=JSON.parse(e.inventory);"armor"==e.type?g.ents.getState(g.playerEntity,"inventory").armor=t:"hook"==e.type?g.ents.getState(g.playerEntity,"inventory").hook=t:(g.ents.getState(g.playerEntity,"inventory").items=t.items,g.ents.getState(g.playerEntity,"inventory").tempslot=t.tempslot)})),t.socket.on("PlayerSlotUpdate",(function(e){const t=JSON.parse(e.data),n=g.ents.getState(g.playerEntity,"inventory");"temp"==e.type?n.tempslot=t:"main"==e.type?n.items[e.slot]=t:"armor"==e.type?n.armor.items[e.slot]=t:"crafting"==e.type?n.crafting[e.slot]=t:"hook"==e.type&&(n.hook.items[e.slot]=t)})),t.socket.on("ChatMessage",(function(e){u.addMessage(e.message)})),t.socket.on("TabUpdate",(function(e){v.setTab(e.message)})),t.socket.on("PlayerTeleport",(function(e){g.ents.setPosition(g.playerEntity,e.x,e.y,e.z)})),t.socket.on("PlayerUpdateMovement",(function(e){g.ents.getMovement(g.playerEntity)[e.key]=e.value})),t.socket.on("PlayerUpdatePhysics",(function(e){g.ents.getPhysicsBody(g.playerEntity)[e.key]=e.value})),t.socket.on("PlayerApplyImpulse",(function(e){g.ents.getPhysicsBody(g.playerEntity).applyImpulse([e.x,e.y,e.z])})),t.socket.on("EntityCreate",(async function(e){if(n!=e.uuid){const t=JSON.parse(e.data);x[e.uuid]=g.ents.add(Object.values(t.position),1,2,null,null,!1,!0),f.applyModel(x[e.uuid],e.uuid,t.model,t.texture,t.offset,t.nametag,t.name,t.hitbox)}})),t.socket.on("EntityRemove",(function(e){null!=x[e.uuid]&&g.ents.deleteEntity(x[e.uuid]),delete x[e.uuid]})),t.socket.on("EntityMove",(function(e){if(null!=x[e.uuid]){var t=[e.x,e.y,e.z];g.ents.getState(x[e.uuid],"position").newPosition=t,g.ents.getState(x[e.uuid],"position").rotation=2*e.rotation,g.ents.getState(x[e.uuid],"position").pitch=2*e.pitch}})),t.socket.on("SoundPlay",(function(e){h.playSound(e.sound,e.volume,null!=e.x?[e.x,e.y,e.z]:null,g)}));const o=g.ents.getState(g.playerEntity,"position");let a=[],c=0;w=()=>{const e=g.camera.heading,n=g.camera.pitch;JSON.stringify(a)==JSON.stringify(o.position)&&c==e&&0==n||(a=[...o.position],c=e,t.socket.send("ActionMove",{x:o.position[0],y:o.position[1],z:o.position[2],rotation:e,pitch:n}))},g.on("tick",w),b=async function(){Object.values(x).forEach((async function(e){const t=g.ents.getState(e,"position").position,n=g.ents.getState(e,"position").newPosition,r=g.ents.getState(e,g.entities.names.mesh),i=g.ents.getState(e,"model");if(null!=r&&null!=n&&null!=t){let o=y.create();y.lerp(o,t,n,.1);const a=g.ents.getState(e,"position").rotation,s=g.ents.getState(e,"position").pitch;g.ents.setPosition(e,o[0],o[1],o[2]);const c=[n[0],0,n[2]],u=[t[0],0,t[2]];null==i.x&&(i.x=0,i.y=0,i.z=!1);let l=Math.sin(i.x);if(y.dist(c,u)>.05)i.y=y.dist(c,u)/5,i.x=i.x+i.y,Math.abs(l)>.95?i.z=!0:Math.abs(l)<.05&&(i.z=!1);else{const e=parseFloat(l.toFixed(1));0==e||i.z||(i.x=i.x-.05),0!=e&&i.z&&(i.x=i.x+.05)}i.models.left_arm.rotation.x=-l,i.models.right_arm.rotation.x=l,i.models.right_leg.rotation.x=-l,i.models.left_leg.rotation.x=l;const f=r.mesh.rotation.y;r.mesh.rotation.y=a/2-f>5?a/2:(a/2+f)/2,i.models.head.rotation.x=s/2,null!=i.nametag&&(i.nametag.rotation.y=g.camera.heading-r.mesh.rotation.y,i.nametag.rotation.x=g.camera.pitch)}}))},g.on("beforeRender",b);let _=setInterval(()=>{g.world.playerChunkLoaded&&(g.ents.getPhysics(g.playerEntity).body.airDrag=-1,clearInterval(_))},1)}))}))},t.stopListening=_},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=i;var r=n(77);function i(e,t){if(!(this instanceof i))return new i(e,t);var n=r.create();r.add(n,e,t),this.base=r.min(r.create(),e,n),this.vec=r.clone(t),this.max=r.max(r.create(),e,n),this.mag=r.length(this.vec)}var o=i.prototype;o.width=function(){return this.vec[0]},o.height=function(){return this.vec[1]},o.depth=function(){return this.vec[2]},o.x0=function(){return this.base[0]},o.y0=function(){return this.base[1]},o.z0=function(){return this.base[2]},o.x1=function(){return this.max[0]},o.y1=function(){return this.max[1]},o.z1=function(){return this.max[2]},o.translate=function(e){return r.add(this.max,this.max,e),r.add(this.base,this.base,e),this},o.setPosition=function(e){return r.add(this.max,e,this.vec),r.copy(this.base,e),this},o.expand=function(e){var t=r.create(),n=r.create();return r.max(t,e.max,this.max),r.min(n,e.base,this.base),r.subtract(t,t,n),new i(n,t)},o.intersects=function(e){return!(e.base[0]>this.max[0])&&(!(e.base[1]>this.max[1])&&(!(e.base[2]>this.max[2])&&(!(e.max[0]<this.base[0])&&(!(e.max[1]<this.base[1])&&!(e.max[2]<this.base[2])))))},o.touches=function(e){var t=this.union(e);return null!==t&&(0==t.width()||0==t.height()||0==t.depth())},o.union=function(e){if(!this.intersects(e))return null;var t=Math.max(e.base[0],this.base[0]),n=Math.max(e.base[1],this.base[1]),r=Math.max(e.base[2],this.base[2]);return new i([t,n,r],[Math.min(e.max[0],this.max[0])-t,Math.min(e.max[1],this.max[1])-n,Math.min(e.max[2],this.max[2])-r])}},function(e,t,n){"use strict";(function(e){var r=n(213),i=n(316),o=n(317).Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:i([32,0]),UINT16:i([32,0]),UINT32:i([32,0]),BIGUINT64:i([32,0]),INT8:i([32,0]),INT16:i([32,0]),INT32:i([32,0]),BIGINT64:i([32,0]),FLOAT:i([32,0]),DOUBLE:i([32,0]),DATA:i([32,0]),UINT8C:i([32,0]),BUFFER:i([32,0])});var a="undefined"!=typeof Uint8ClampedArray,s="undefined"!=typeof BigUint64Array,c="undefined"!=typeof BigInt64Array,u=e.__TYPEDARRAY_POOL;u.UINT8C||(u.UINT8C=i([32,0])),u.BIGUINT64||(u.BIGUINT64=i([32,0])),u.BIGINT64||(u.BIGINT64=i([32,0])),u.BUFFER||(u.BUFFER=i([32,0]));var l=u.DATA,f=u.BUFFER;function d(e){if(e){var t=e.length||e.byteLength,n=r.log2(t);l[n].push(e)}}function p(e){e=r.nextPow2(e);var t=r.log2(e),n=l[t];return n.length>0?n.pop():new ArrayBuffer(e)}function h(e){return new Uint8Array(p(e),0,e)}function m(e){return new Uint16Array(p(2*e),0,e)}function y(e){return new Uint32Array(p(4*e),0,e)}function v(e){return new Int8Array(p(e),0,e)}function g(e){return new Int16Array(p(2*e),0,e)}function b(e){return new Int32Array(p(4*e),0,e)}function w(e){return new Float32Array(p(4*e),0,e)}function _(e){return new Float64Array(p(8*e),0,e)}function k(e){return a?new Uint8ClampedArray(p(e),0,e):h(e)}function x(e){return s?new BigUint64Array(p(8*e),0,e):null}function O(e){return c?new BigInt64Array(p(8*e),0,e):null}function P(e){return new DataView(p(e),0,e)}function S(e){e=r.nextPow2(e);var t=r.log2(e),n=f[t];return n.length>0?n.pop():new o(e)}t.free=function(e){if(o.isBuffer(e))f[r.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,n=0|r.log2(t);l[n].push(e)}},t.freeUint8=t.freeUint16=t.freeUint32=t.freeBigUint64=t.freeInt8=t.freeInt16=t.freeInt32=t.freeBigInt64=t.freeFloat32=t.freeFloat=t.freeFloat64=t.freeDouble=t.freeUint8Clamped=t.freeDataView=function(e){d(e.buffer)},t.freeArrayBuffer=d,t.freeBuffer=function(e){f[r.log2(e.length)].push(e)},t.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return p(e);switch(t){case"uint8":return h(e);case"uint16":return m(e);case"uint32":return y(e);case"int8":return v(e);case"int16":return g(e);case"int32":return b(e);case"float":case"float32":return w(e);case"double":case"float64":return _(e);case"uint8_clamped":return k(e);case"bigint64":return O(e);case"biguint64":return x(e);case"buffer":return S(e);case"data":case"dataview":return P(e);default:return null}return null},t.mallocArrayBuffer=p,t.mallocUint8=h,t.mallocUint16=m,t.mallocUint32=y,t.mallocInt8=v,t.mallocInt16=g,t.mallocInt32=b,t.mallocFloat32=t.mallocFloat=w,t.mallocFloat64=t.mallocDouble=_,t.mallocUint8Clamped=k,t.mallocBigUint64=x,t.mallocBigInt64=O,t.mallocDataView=P,t.mallocBuffer=S,t.clearCache=function(){for(var e=0;e<32;++e)u.UINT8[e].length=0,u.UINT16[e].length=0,u.UINT32[e].length=0,u.INT8[e].length=0,u.INT16[e].length=0,u.INT32[e].length=0,u.FLOAT[e].length=0,u.DOUBLE[e].length=0,u.BIGUINT64[e].length=0,u.BIGINT64[e].length=0,u.UINT8C[e].length=0,l[e].length=0,f[e].length=0}}).call(this,n(154))},function(e,t,n){"use strict";function r(e){var t=32;return(e&=-e)&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}t.INT_BITS=32,t.INT_MAX=2147483647,t.INT_MIN=-1<<31,t.sign=function(e){return(e>0)-(e<0)},t.abs=function(e){var t=e>>31;return(e^t)-t},t.min=function(e,t){return t^(e^t)&-(e<t)},t.max=function(e,t){return e^(e^t)&-(e<t)},t.isPow2=function(e){return!(e&e-1||!e)},t.log2=function(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1},t.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},t.popCount=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},t.countTrailingZeros=r,t.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},t.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},t.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var i=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,r=t,i=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--i;e[t]=r<<i&255}}(i),t.reverse=function(e){return i[255&e]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]},t.interleave2=function(e,t){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))<<1},t.deinterleave2=function(e,t){return(e=65535&((e=16711935&((e=252645135&((e=858993459&((e=e>>>t&1431655765)|e>>>1))|e>>>2))|e>>>4))|e>>>16))<<16>>16},t.interleave3=function(e,t,n){return e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2),(e|=(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},t.deinterleave3=function(e,t){return(e=1023&((e=4278190335&((e=251719695&((e=3272356035&((e=e>>>t&1227133513)|e>>>2))|e>>>4))|e>>>8))|e>>>16))<<22>>22},t.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>r(e)+1}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.registerItems=t.registerBlocks=t.blockIDmap=t.blockIDs=t.items=t.blocks=void 0;const a=n(95),s=o(n(141));t.blocks={},t.items={},t.blockIDs={},t.blockIDmap={},t.registerBlocks=function(e,n){const r=e.rendering.getScene();t.blocks=n,Object.values(n).forEach(e=>{t.blockIDs[e.id]=e.rawid,t.blockIDmap[e.rawid]=e.id}),e.registry.registerMaterial("water",[.5,.5,.8,.7],null,!0),e.registry.registerMaterial("barrier",[0,0,0,0],null,!0),console.log("Blocks: ",t.blockIDs),Object.values(n).forEach((function(t){!function(t,n,i,o,c,u,l,f){if(0==i){let r,i=0==c.opaque,s=null!=c.color?Object.values(c.color):[0,0,0];if(null==o&&(o=[""]),1==o.length&&null==c.material)(o[0].startsWith("http://")||o[0].startsWith("https://"))&&1==a.gameSettings.allowcustom?e.registry.registerMaterial(n,s,o[0],i):e.registry.registerMaterial(n,s,""!=o[0]?"textures/"+o[0]+".png":null,i),r=n;else if(null==c.material){r=new Array;for(let t=0;t<o.length;t++)(o[t].startsWith("http://")||o[t].startsWith("https://"))&&1==a.gameSettings.allowcustom?e.registry.registerMaterial(n+t,s,o[t],i):e.registry.registerMaterial(n+t,s,""!=o[t]?"textures/"+o[t]+".png":null,i),r.push(n+t)}else r=c.material;const u=c;u.material=r,e.registry.registerBlock(t,u)}else if(1==i){const i=function(e,t,n,r){const i=r||"sprite-mat";let o;o=(n.startsWith("http://")||n.startsWith("https://"))&&1==a.gameSettings.allowcustom?new s.Texture(n,t,!0,!0,s.Texture.NEAREST_SAMPLINGMODE):new s.Texture("textures/"+n+".png",t,!0,!0,s.Texture.NEAREST_SAMPLINGMODE);o.hasAlpha=!0;const c=s.Mesh.CreatePlane("sprite-"+i,1,t),u=e.rendering.makeStandardMaterial(i);u.backFaceCulling=!1,u.diffuseTexture=o,u.diffuseTexture.vOffset=.99,c.material=u,c.rotation.y+=.81;const l=s.Matrix.Translation(0,.5,0);c.bakeTransformIntoVertices(l);const f=c.clone();return f.rotation.y+=1.62,s.Mesh.MergeMeshes([c,f],!0)}(e,r,o[0],n),u=c;u.blockMesh=i,e.registry.registerBlock(t,u)}else if(2==i){const i=function(e,t,n,r){const i={},o={};for(let c=0;c<6;c++){let u,l=r+"-"+c||"sprite-mat";switch(i[c]=s.Mesh.CreatePlane("sprite-"+l,1,t),o[c]=e.rendering.makeStandardMaterial(l+c),o[c].backFaceCulling=!1,((c<4?n[1]:n[0]).startsWith("http://")||(c<4?n[1]:n[0]).startsWith("https://"))&&1==a.gameSettings.allowcustom?o[c].diffuseTexture=new s.Texture(c<4?n[1]:n[0],t,!0,!0,s.Texture.NEAREST_SAMPLINGMODE):o[c].diffuseTexture=new s.Texture("textures/"+(c<4?n[1]:n[0])+".png",t,!0,!0,s.Texture.NEAREST_SAMPLINGMODE),o[c].diffuseTexture.hasAlpha=!0,i[c].material=o[c],c){case 0:u=s.Matrix.Translation(0,.5,.435),i[c].rotation.y=1.57;break;case 1:u=s.Matrix.Translation(0,.5,-.435),i[c].rotation.y=1.57;break;case 2:u=s.Matrix.Translation(0,.5,.435);break;case 3:u=s.Matrix.Translation(0,.5,-.435);break;case 4:u=s.Matrix.Translation(0,0,-1),i[c].rotation.x=1.57;break;case 5:u=s.Matrix.Translation(0,0,0),i[c].rotation.x=1.57}i[c].bakeTransformIntoVertices(u)}return s.Mesh.MergeMeshes(Object.values(i),!0,!0,void 0,!1,!1)}(e,r,[o[0],o[1]],n),u=c;u.blockMesh=i,e.registry.registerBlock(t,u)}else if(4==i){const i=e.rendering.makeStandardMaterial(n);let u;u=(o[0].startsWith("http://")||o[0].startsWith("https://"))&&1==a.gameSettings.allowcustom?new s.Texture(o[0],r,!0,!0,s.Texture.NEAREST_SAMPLINGMODE):new s.Texture("textures/"+o[0]+".png",r,!0,!0,s.Texture.NEAREST_SAMPLINGMODE),i.diffuseTexture=u,i.opacityTexture=i.diffuseTexture,i.backFaceCulling=!0;const l=s.MeshBuilder.CreateBox(n,{size:1},e.rendering.getScene());l.material=i,l.bakeTransformIntoVertices(s.Matrix.Scaling(1,1,1).setTranslation(new s.Vector3(0,.5,0))),l.opaque=!1,l.material.needDepthPrePass=!0;const f=c;f.blockMesh=l,e.registry.registerBlock(t,f)}}(t.rawid,t.id,t.type,t.texture,t.options,t.hardness,t.miningtime,t.tool)}))},t.registerItems=function(e,n){t.items=n,console.log("Items: ",n)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.addMessage=t.setupChat=t.changeState=t.messages=t.chatContainer=t.input=void 0;const a=n(137),s=n(70),c=n(156),u=o(n(78));t.messages=[];let l=0,f=!1;function d(){l=0,t.messages.forEach(e=>{!f&&e.isVisible&&l>200*s.scale?(e.shouldhide=!0,e.isVisible=!1):e.isVisible&&(l+=e.heightInPixels)}),0!=l?(t.chatContainer.height=l+5+"px",t.chatContainer.isVisible=!0):t.chatContainer.isVisible&&(t.chatContainer.isVisible=!1)}t.changeState=function(e){f=e},t.setupChat=function(){const e=s.getScreen(1);t.input=new u.InputText,t.input.width=100,t.input.horizontalAlignment=0,t.input.verticalAlignment=1,t.input.zIndex=10,t.input.height="36px",t.input.color="white",t.input.background="#111111aa",t.input.focusedBackground="#111111bb",t.input.thickness=0,t.input.isVisible=!1,t.input.shadowColor="",t.input.fontSize="32",t.input.promptMessage="Enter chat message",e.addControl(t.input),t.chatContainer=new u.StackPanel,a.isMobile?(t.chatContainer.verticalAlignment=0,t.chatContainer.horizontalAlignment=1,t.chatContainer.width=140*s.scale+"px"):(t.chatContainer.verticalAlignment=1,t.chatContainer.horizontalAlignment=0,t.chatContainer.top=-26*s.scale+"px",t.chatContainer.width=176*s.scale+"px"),t.chatContainer.name="textContainer",t.chatContainer.useBitmapCache=!0,t.chatContainer.zIndex=10,t.chatContainer.background="#11111177",t.chatContainer.height=0,e.addControl(t.chatContainer);const n=e=>{a.isMobile?t.chatContainer.width=140*s.scale+"px":(t.chatContainer.top=-26*e+"px",t.chatContainer.width=176*e+"px"),t.messages.forEach(t=>{t.fontSize=8*e,t.paddingLeft=2*e+"px",a.isMobile?t.width=140*e+"px":t.width=176*e+"px",t.height=t.computeExpectedHeight()+"px"}),d()};s.event.on("scale-change",n);const r=setInterval(async()=>{if(f){let e=0;t.messages.forEach(t=>{t.shouldhide&&!t.isVisible&&(t.isVisible=!0,e+=1)}),0!=e&&d()}else{let e=0;t.messages.forEach(t=>{t.shouldhide&&t.isVisible&&(t.isVisible=!1),e+=1}),0!=e&&d()}},100);t.chatContainer.onDisposeObservable.add(()=>{clearInterval(r),t.messages.forEach(e=>e.dispose()),t.messages=[],l=0,s.event.off("scale-change",n)})},t.addMessage=async function(e){const n=Object.values(e);let r="";n.forEach(e=>{r+=e.text});const i=new c.FormTextBlock;for(i.fontSize=8*s.scale,i.paddingLeft=2*s.scale+"px",i.textVerticalAlignment=1,i.textHorizontalAlignment=0,i.fontFamily="Lato",a.isMobile?i.width=140*s.scale+"px":i.width=176*s.scale+"px",i.zIndex=11,i.text=n,i.height=i.computeExpectedHeight()+"px",i.useBitmapCache=!0,t.messages.unshift(i),t.chatContainer.addControl(i);t.messages.length>50;)t.messages[t.messages.length-1].dispose(),t.messages.pop();setInterval(async()=>{i.shouldhide=!0,f||(i.isVisible=!1),d()},8e3),d(),console.log("Chat: "+r)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.buildMainMenu=t.holder=void 0;const s=n(70),c=o(n(78)),u=a(n(335)),l=a(n(336)),f=a(n(252)),d=n(95),p=n(130);t.buildMainMenu=function(e){const n=s.getScreen(1);let r,i;t.holder=new c.Rectangle,t.holder.thickness=0,t.holder.isPointerBlocker=!0,t.holder.zIndex=5,n.addControl(t.holder);const o=new c.TextBlock;function a(n){switch(r&&r.dispose(),n){case"singleplayer":r=u.default(e,a),i="singleplayer",document.title="VoxelSrv - Singleplayer Menu";break;case"multiplayer":r=l.default(e,a),i="multiplayer",document.title="VoxelSrv - Multiplayer Menu";break;case"settings":r=f.default(e,a),i="settings",document.title="VoxelSrv - Settings";break;default:r=function(){const e=new c.Rectangle;e.thickness=0,e.horizontalAlignment=2,e.zIndex=10,window.innerHeight>230*s.scale?e.height=230*s.scale+"px":e.height="100%";e.width=220*s.scale+"px",e.background="#11111166";const n=new c.Image("hotbar","./textures/mainlogo.png");n.width=210*s.scale+"px",n.height=64*s.scale+"px",n.verticalAlignment=0,n.horizontalAlignment=2,n.top="5px",t.holder.zIndex=15,e.addControl(n);const r=new c.StackPanel;if(r.zIndex=20,e.addControl(r),null!=window.electron){const e=p.createItem();e.text.text=[{text:"Singleplayer",color:"white",font:"Lato"}],e.item.onPointerClickObservable.add(e=>{a("singleplayer")}),r.addControl(e.item)}const i=p.createItem();i.text.text=[{text:"Multiplayer",color:"white",font:"Lato"}],i.item.onPointerClickObservable.add(e=>{a("multiplayer")}),r.addControl(i.item);const o=p.createItem();o.text.text=[{text:"Settings",color:"white",font:"Lato"}],o.item.onPointerClickObservable.add(e=>{a("settings")}),r.addControl(o.item);const u=p.createItem();u.text.text=[{text:"Discord",color:"white",font:"Lato"}],u.item.onPointerClickObservable.add(e=>{window.open("https://discord.com/invite/K9PdsDh","_blank")}),r.addControl(u.item);const l=p.createItem();l.text.text=[{text:"Github",color:"white",font:"Lato"}],l.item.onPointerClickObservable.add(e=>{window.open("https://github.com/VoxelSrv/voxelsrv","_blank")}),r.addControl(l.item);const f=t=>{window.innerHeight>230*s.scale?e.height=230*s.scale+"px":e.height="100%",e.width=220*s.scale+"px",n.width=210*s.scale+"px",n.height=64*s.scale+"px",r._children.forEach(e=>{e.width=100*s.scale+"px",e.height=18*s.scale+"px",e._children[0].fontSize=10*s.scale})};return s.event.on("scale-change",f),e.onDisposeObservable.add(()=>{s.event.off("scale-change",f)}),e}(),i="main",document.title="VoxelSrv - Main Menu"}t.holder.addControl(r)}o.text=d.hostedOn?`VoxelSRV ${d.gameVersion}/${d.hostedOn}`:"VoxelSRV "+d.gameVersion,o.fontFamily="Lato",o.fontSize="26px",o.color="white",o.textHorizontalAlignment=0,o.textVerticalAlignment=1,o.left="5px",o.top="-5px",o.shadowColor="#111111",o.shadowOffsetX=1,o.shadowOffsetY=1,t.holder.addControl(o),a("main")}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PeerSocket=t.MPSocket=t.BaseSocket=void 0;const s=o(n(337)),c=a(n(356));class u{constructor(){this.listeners={}}send(e,t){const n=s.parseToMessage("client",e,t);null!=n&&this.socket.send(n)}close(){this.listeners={}}emit(e,t){null!=this.listeners[e]&&this.listeners[e].forEach(e=>{e(t)})}on(e,t){null!=this.listeners[e]||(this.listeners[e]=new Array),this.listeners[e].push(t)}}t.BaseSocket=u;t.MPSocket=class extends u{constructor(e){super(),this.server=e,this.socket=new WebSocket(e),this.socket.binaryType="arraybuffer",this.socket.onopen=()=>{setTimeout(()=>this.emit("connection",{}),500)},this.socket.onerror=()=>{setTimeout(()=>this.emit("PlayerKick",{reason:"Can't connect to "+e}),500)},this.socket.onclose=()=>{setTimeout(()=>this.emit("PlayerKick",{reason:"Connection closed!"}),500)},this.socket.onmessage=e=>{const t=s.parseToObject("server",new Uint8Array(e.data));null!=t&&this.emit(t.type,t.data)}}close(){this.listeners={},this.socket.close()}};t.PeerSocket=class extends u{constructor(e){super(),this.server=e,this.peer=new c.default,this.socket=this.peer.connect(e),console.log("Your peer id: "+this.peer.id),this.socket.on("open",()=>setTimeout(()=>this.emit("connection",{}),500)),this.socket.on("close",()=>setTimeout(()=>this.emit("PlayerKick",{reason:"Connection closed!"}),500)),this.socket.on("error",()=>setTimeout(()=>this.emit("PlayerKick",{reason:"Can't connect to peer"}),500)),this.socket.on("data",e=>{const t=s.parseToObject("server",new Uint8Array(e.data));null!=t&&this.emit(t.type,t.data)})}close(){this.listeners={},this.socket.close()}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.setTab=t.setupTab=t.messages=t.tabContainer=t.input=void 0;const a=n(70),s=n(156),c=o(n(78));t.messages=[];let u=0;function l(){u=0,t.messages.forEach(e=>{u+=e.heightInPixels}),0!=u&&(t.tabContainer.height=u+5+"px")}t.setupTab=function(){const e=a.getScreen(1);t.tabContainer=new c.StackPanel,t.tabContainer.verticalAlignment=2,t.tabContainer.horizontalAlignment=2,t.tabContainer.width=180*a.scale+"px",t.tabContainer.name="textContainer",t.tabContainer.useBitmapCache=!0,t.tabContainer.zIndex=100,t.tabContainer.background="#11111155",e.addControl(t.tabContainer);const n=e=>{t.tabContainer.width=180*a.scale+"px",t.messages.forEach(t=>{t.fontSize=8*e,t.paddingLeft=2*e+"px",t.width=176*e+"px",t.height=t.computeExpectedHeight()+"px"}),l(),t.tabContainer.isVisible=!1};a.event.on("scale-change",n),t.tabContainer.onDisposeObservable.add(()=>{t.messages.forEach(e=>e.dispose()),t.messages=[],u=0,a.event.off("scale-change",n)}),t.tabContainer.isVisible=!1},t.setTab=async function(e){t.messages.forEach(e=>e.dispose()),t.messages=[];const n=Object.values(e);let r="";n.forEach(e=>{r+=e.text});const i=new s.FormTextBlock;i.fontSize=8*a.scale,i.paddingLeft=2*a.scale+"px",i.textVerticalAlignment=1,i.textHorizontalAlignment=2,i.fontFamily="Lato",i.width=176*a.scale+"px",i.text=n,i.height=i.computeExpectedHeight()+"px",i.useBitmapCache=!0,t.messages.unshift(i),t.tabContainer.addControl(i),l()}},function(e,t,n){"use strict";n.r(t),n.d(t,"updatePositionExtents",(function(){return i}));var r=n(77);function i(e){var t=e.width/2,n=e._localPosition,r=e._extents;r[0]=n[0]-t,r[1]=n[1],r[2]=n[2]-t,r[3]=n[0]+t,r[4]=n[1]+e.height,r[5]=n[2]+t}t.default=function(e){return{name:"position",order:60,state:{position:null,width:1,height:1,_localPosition:null,_renderPosition:null,_extents:null},onAdd:function(t,n){var o=[0,0,0];n.position&&r.copy(o,n.position),n.position=o,n._localPosition=r.create(),n._renderPosition=r.create(),n._extents=new Float32Array(6),e.globalToLocal(n.position,null,n._localPosition),r.copy(n._renderPosition,n._localPosition),i(n)},onRemove:null,system:function(t,n){var o=e.worldOriginOffset;n.forEach(e=>{r.add(e.position,e._localPosition,o),i(e)})}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"setPhysicsFromPosition",(function(){return o}));var r=n(77);t.default=function(e){return{name:"physics",order:40,state:{body:null},onAdd:function(t,n){n.body=e.physics.addBody(),o(n,e.ents.getPositionData(n.__id))},onRemove:function(t,n){if(e.ents.hasPosition(n.__id)){var r=e.ents.getPositionData(n.__id);a(n,r),s(n,r,0,!1)}e.physics.removeBody(n.body)},system:function(t,n){n.forEach(t=>{a(t,e.ents.getPositionData(t.__id))})},renderSystem:function(t,n){var r=(e.positionInCurrentTick*e._tickRate-e._tickRate)/1e3;n.forEach(t=>{var n=t.__id,i=e.ents.getPositionData(n),o=e.ents.cameraSmoothed(n);s(t,i,r,o)})}}};var i=r.create();function o(e,t){var n=e.body.aabb,i=t._extents;r.copy(n.base,i),r.set(n.vec,t.width,t.height,t.width),r.add(n.max,n.base,n.vec)}function a(e,t){var n=e.body.aabb.base,i=t.width/2;r.set(t._localPosition,n[0]+i,n[1],n[2]+i)}function s(e,t,n,o){var a=e.body.velocity;r.scaleAndAdd(i,t._localPosition,a,n),o&&r.lerp(i,t._renderPosition,i,.3),r.copy(t._renderPosition,i)}},function(e,t){e.exports=1e-6},function(e,t){e.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},function(e,t){e.exports=function(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}},function(e,t){e.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o);return e}},function(e,t){e.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}},function(e,t){e.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}},function(e,t){e.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}},function(e,t,n){"use strict";e.exports=function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}},,,,,,,,,function(e,t,n){"use strict";var r=[],i=[],o=[],a=[],s=[],c=[],u=[],l=[],f=[],d=[],p=[],h=[];e.exports=function(e,t,n,m,y,v){for(var g=u,b=f,w=d,_=h,k=0;k<3;k++)g[k]=+n[k],w[k]=+t.max[k],b[k]=+t.base[k];v||(v=1e-10);var x=function(e,t,n,u,f,d){var h=r,m=i,y=o,v=a,g=s,b=c,w=l,_=Math.floor,k=0,x=0,O=0,P=0,S=0;if(C(),0===O)return 0;for(P=j();x<=O;){if(T(P))if(E())return k;P=j()}for(k+=O,S=0;S<3;S++)u[S]+=n[S],f[S]+=n[S];return k;function C(){if(x=0,0!==(O=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2])))for(var e=0;e<3;e++){var t=n[e]>=0;v[e]=t?1:-1;var r=t?f[e]:u[e];h[e]=t?u[e]:f[e],m[e]=M(r,v[e]),y[e]=D(h[e],v[e]),w[e]=n[e]/O,g[e]=Math.abs(1/w[e]);var i=t?m[e]+1-r:r-m[e];b[e]=g[e]<1/0?g[e]*i:1/0}}function T(t){for(var n=v[0],r=0===t?m[0]:y[0],i=m[0]+n,o=v[1],a=1===t?m[1]:y[1],s=m[1]+o,c=v[2],u=2===t?m[2]:y[2],l=m[2]+c,f=r;f!=i;f+=n)for(var d=a;d!=s;d+=o)for(var p=u;p!=l;p+=c)if(e(f,d,p))return!0;return!1}function E(){k+=x;var e=v[P],r=x/O,i=p;for(S=0;S<3;S++){var o=n[S]*r;u[S]+=o,f[S]+=o,i[S]=n[S]-o}if(e>0?f[P]=Math.round(f[P]):u[P]=Math.round(u[P]),t(k,P,e,i))return!0;for(S=0;S<3;S++)n[S]=i[S];return C(),0===O}function j(){var e=b[0]<b[1]?b[0]<b[2]?0:2:b[1]<b[2]?1:2,t=b[e]-x;for(x=b[e],m[e]+=v[e],b[e]+=g[e],S=0;S<3;S++)h[S]+=t*w[S],y[S]=D(h[S],v[S]);return e}function M(e,t){return _(e-t*d)}function D(e,t){return _(e+t*d)}}(e,m,g,b,w,v);if(!y){for(k=0;k<3;k++)_[k]=n[k]>0?w[k]-t.max[k]:b[k]-t.base[k];t.translate(_)}return x}},function(e,t,n){"use strict";e.exports={init:function(e){var t=i.nextPow2(e);a.length<t&&(r.free(a),a=r.mallocInt32(t));s.length<t&&(r.free(s),s=r.mallocInt32(t));c.length<t&&(r.free(c),c=r.mallocInt32(t));u.length<t&&(r.free(u),u=r.mallocInt32(t));l.length<t&&(r.free(l),l=r.mallocInt32(t));f.length<t&&(r.free(f),f=r.mallocInt32(t));var n=8*t;d.length<n&&(r.free(d),d=r.mallocDouble(n))},sweepBipartite:function(e,t,n,r,i,l,f,m,y,v){for(var g=0,b=2*e,w=e-1,_=b-1,k=n;k<r;++k){var x=l[k],O=b*k;d[g++]=i[O+w],d[g++]=-(x+1),d[g++]=i[O+_],d[g++]=x}for(k=f;k<m;++k){x=v[k]+(1<<28);var P=b*k;d[g++]=y[P+w],d[g++]=-x,d[g++]=y[P+_],d[g++]=x}var S=g>>>1;o(d,S);var C=0,T=0;for(k=0;k<S;++k){var E=0|d[2*k+1];if(E>=1<<28)p(c,u,T--,E=E-(1<<28)|0);else if(E>=0)p(a,s,C--,E);else if(E<=-(1<<28)){E=-E-(1<<28)|0;for(var j=0;j<C;++j){if(void 0!==(M=t(a[j],E)))return M}h(c,u,T++,E)}else{E=-E-1|0;for(j=0;j<T;++j){var M;if(void 0!==(M=t(E,c[j])))return M}h(a,s,C++,E)}}},sweepComplete:function(e,t,n,r,i,m,y,v,g,b){for(var w=0,_=2*e,k=e-1,x=_-1,O=n;O<r;++O){var P=m[O]+1<<1,S=_*O;d[w++]=i[S+k],d[w++]=-P,d[w++]=i[S+x],d[w++]=P}for(O=y;O<v;++O){P=b[O]+1<<1;var C=_*O;d[w++]=g[C+k],d[w++]=1|-P,d[w++]=g[C+x],d[w++]=1|P}var T=w>>>1;o(d,T);var E=0,j=0,M=0;for(O=0;O<T;++O){var D=0|d[2*O+1],I=1&D;if(O<T-1&&D>>1==d[2*O+3]>>1&&(I=2,O+=1),D<0){for(var R=-(D>>1)-1,A=0;A<M;++A){if(void 0!==(B=t(l[A],R)))return B}if(0!==I)for(A=0;A<E;++A){if(void 0!==(B=t(a[A],R)))return B}if(1!==I)for(A=0;A<j;++A){var B;if(void 0!==(B=t(c[A],R)))return B}0===I?h(a,s,E++,R):1===I?h(c,u,j++,R):2===I&&h(l,f,M++,R)}else{R=(D>>1)-1;0===I?p(a,s,E--,R):1===I?p(c,u,j--,R):2===I&&p(l,f,M--,R)}}},scanBipartite:function(e,t,n,r,i,c,u,l,f,m,y,v){var g=0,b=2*e,w=t,_=t+e,k=1,x=1;r?x=1<<28:k=1<<28;for(var O=i;O<c;++O){var P=O+k,S=b*O;d[g++]=u[S+w],d[g++]=-P,d[g++]=u[S+_],d[g++]=P}for(O=f;O<m;++O){P=O+x;var C=b*O;d[g++]=y[C+w],d[g++]=-P}var T=g>>>1;o(d,T);var E=0;for(O=0;O<T;++O){var j=0|d[2*O+1];if(j<0){var M=!1;if((P=-j)>=1<<28?(M=!r,P-=1<<28):(M=!!r,P-=1),M)h(a,s,E++,P);else{var D=v[P],I=b*P,R=y[I+t+1],A=y[I+t+1+e];e:for(var B=0;B<E;++B){var L=a[B],z=b*L;if(!(A<u[z+t+1]||u[z+t+1+e]<R)){for(var N=t+2;N<e;++N)if(y[I+N+e]<u[z+N]||u[z+N+e]<y[I+N])continue e;var F,U=l[L];if(void 0!==(F=r?n(D,U):n(U,D)))return F}}}}else p(a,s,E--,j-k)}},scanComplete:function(e,t,n,r,i,s,c,u,l,f,p){for(var h=0,m=2*e,y=t,v=t+e,g=r;g<i;++g){var b=g+(1<<28),w=m*g;d[h++]=s[w+y],d[h++]=-b,d[h++]=s[w+v],d[h++]=b}for(g=u;g<l;++g){b=g+1;var _=m*g;d[h++]=f[_+y],d[h++]=-b}var k=h>>>1;o(d,k);var x=0;for(g=0;g<k;++g){var O=0|d[2*g+1];if(O<0){if((b=-O)>=1<<28)a[x++]=b-(1<<28);else{var P=p[b-=1],S=m*b,C=f[S+t+1],T=f[S+t+1+e];e:for(var E=0;E<x;++E){var j=a[E],M=c[j];if(M===P)break;var D=m*j;if(!(T<s[D+t+1]||s[D+t+1+e]<C)){for(var I=t+2;I<e;++I)if(f[S+I+e]<s[D+I]||s[D+I+e]<f[S+I])continue e;var R=n(M,P);if(void 0!==R)return R}}}}else{for(b=O-(1<<28),E=x-1;E>=0;--E)if(a[E]===b){for(I=E+1;I<x;++I)a[I-1]=a[I];break}--x}}}};var r=n(212),i=n(213),o=n(321),a=r.mallocInt32(1024),s=r.mallocInt32(1024),c=r.mallocInt32(1024),u=r.mallocInt32(1024),l=r.mallocInt32(1024),f=r.mallocInt32(1024),d=r.mallocDouble(8192);function p(e,t,n,r){var i=t[r],o=e[n-1];e[i]=o,t[o]=i}function h(e,t,n,r){e[n]=r,t[r]=n}},function(e,t,n){"use strict";e.exports=function(e,t){var n="abcdef".split("").concat(t),r=[];e.indexOf("lo")>=0&&r.push("lo=e[k+n]");e.indexOf("hi")>=0&&r.push("hi=e[k+o]");return n.push("for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m".replace("_",r.join()).replace("$",e)),Function.apply(void 0,n)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.setupPlayer=t.setupControls=void 0;const a=o(n(141)),s=n(137),c=n(95),u=n(214),l=n(248),f=n(215),d=n(172),p=n(70),h=n(253),m=n(218),y=n(362);t.setupControls=function(e){const t=e.playerEntity,n=e.rendering.getScene(),r=p.getUI(1);function i(){let t=n.createPickingRay(window.innerWidth/2,window.innerHeight/2,a.Matrix.Identity(),e.rendering.getScene().activeCameras[0]);const r=n.pickWithRay(t,e=>e.name.startsWith("hitbox-"),!0);return r.pickedMesh?[r.pickedMesh.name.substring(7),r.distance]:null}e.container.canvas.requestPointerLock(),e.container.canvas.addEventListener("click",()=>{c.serverSettings.ingame&&(l.inventory.isVisible||f.input.isVisible||h.pauseScreen.isVisible||(e.container.canvas.requestPointerLock(),f.input.isVisible=!1,f.input.text=""))}),e.blockTargetIdCheck=function(e){return null!=u.blockIDmap[e]&&0!=e&&null!=u.blocks[u.blockIDmap[e]]&&1!=u.blocks[u.blockIDmap[e]].options.fluid},e.inputs.down.on("fire",(async function(){if(!c.serverSettings.ingame)return;if(e.targetedBlock){const t=e.targetedBlock.position;return d.socketSend("ActionClick",{type:"left",x:t[0],y:t[1],z:t[2],onBlock:!0}),void d.socketSend("ActionBlockBreak",{x:t[0],y:t[1],z:t[2]})}d.socketSend("ActionClick",{type:"left",x:0,y:0,z:0,onBlock:!1});const t=i();t&&d.socketSend("ActionClickEntity",{type:"left",uuid:t[0],distance:t[1]})})),e.inputs.up.on("fire",(function(){c.serverSettings.ingame})),e.inputs.down.on("alt-fire",(function(){if(!c.serverSettings.ingame)return;if(null!=e.targetedBlock){const t=e.targetedBlock.adjacent,n=e.targetedBlock.position;return d.socketSend("ActionClick",{type:"right",x:n[0],y:n[1],z:n[2],onBlock:!0}),void(0==e.ents.isTerrainBlocked(t[0],t[1],t[2])&&d.socketSend("ActionBlockPlace",{x:t[0],y:t[1],z:t[2],x2:n[0],y2:n[1],z2:n[2]}))}d.socketSend("ActionClick",{type:"right",x:0,y:0,z:0,onBlock:!1});const t=i();t&&d.socketSend("ActionClickEntity",{type:"right",uuid:t[0],distance:t[1]})})),e.inputs.down.on("mid-fire",(function(){if(c.serverSettings.ingame&&e.targetedBlock&&0!=e.targetedBlock.blockID){const n=function(n,r){const i=e.ents.getState(t,"inventory"),o=Object.entries(i.items);for(let e=0;e<o.length;e++)if(null!=o[e]&&null!=o[e][1]&&o[e][1].id==n&&o[e][1].count>=r)return parseInt(o[e][0]);return-1}(u.blocks[u.blockIDmap[e.targetedBlock.blockID]].id,1),r=e.ents.getState(t,"inventory").selected;-1!=n&&n<9?(d.socketSend("ActionInventoryClick",{type:"select",slot:n}),e.ents.getState(t,"inventory").selected=n):-1!=n&&d.socketSend("ActionInventoryClick",{type:"switch",slot:n,slot2:r})}})),e.inputs.down.on("thirdprsn",(function(){c.serverSettings.ingame&&(document.pointerLockElement,e.container.canvas)})),e.inputs.down.on("inventory",(function(){c.serverSettings.ingame&&(f.input.isVisible||h.pauseScreen.isVisible||(l.inventory.isVisible?(l.inventory.isVisible=!1,e.container.canvas.requestPointerLock(),d.socketSend("ActionInventoryClose",{inventory:"main"})):(d.socketSend("ActionInventoryOpen",{inventory:"main"}),l.inventory.isVisible=!0,document.exitPointerLock())))})),e.inputs.down.on("chat",(function(){c.serverSettings.ingame&&(l.inventory.isVisible||f.input.isVisible||h.pauseScreen.isVisible||(f.input.isVisible=!0,f.changeState(!0),document.exitPointerLock(),r.moveFocusToControl(f.input),f.input.text=""))})),e.inputs.down.on("cmd",(function(){c.serverSettings.ingame&&(l.inventory.isVisible||f.input.isVisible||h.pauseScreen.isVisible||(f.input.isVisible=!0,f.changeState(!0),document.exitPointerLock(),r.moveFocusToControl(f.input),f.input.text="/"))})),e.inputs.down.on("menu",e=>{if(c.serverSettings.ingame)return f.input.isVisible?(f.input.isVisible=!1,f.input.text="",void f.changeState(!1)):l.inventory.isVisible?(l.inventory.isVisible=!1,void d.socketSend("ActionInventoryClose",{inventory:"main"})):h.pauseScreen.isVisible?void(h.pauseScreen.isVisible=!1):(document.exitPointerLock(),void(h.pauseScreen.isVisible=!0))}),e.inputs.down.on("chatenter",(function(){c.serverSettings.ingame&&(f.input.isVisible=!1,d.socketSend("ActionMessage",{message:f.input.text}),f.input.text="",f.changeState(!1))})),e.inputs.down.on("tab",(function(){m.tabContainer.isVisible=!0})),e.inputs.up.on("tab",(function(){m.tabContainer.isVisible=!1})),e.inputs.up.on("screenshot",(function(){f.input.isVisible||document.pointerLockElement==e.container.canvas&&y(e.container.canvas,{filename:"VoxelSRV-"+Date.now()+".png"})})),e.on("tick",(async function(){if(!c.serverSettings.ingame)return;const n=e.inputs.state.scrolly;if(0!==n){let r=e.ents.getState(t,"inventory").selected;r+=n>0?1:-1,r>=c.gameSettings.hotbarsize?r=0:r<0&&(r=8),d.socketSend("ActionInventoryClick",{slot:r,type:"select"}),e.ents.getState(e.playerEntity,"inventory").selected=r}})),e.inputs.bind("numberkey","1","2","3","4","5","6","7","8","9"),e.inputs.down.on("numberkey",n=>{if(c.serverSettings.ingame&&document.pointerLockElement==e.container.canvas){const r=parseInt(n.key);let i=e.ents.getState(t,"inventory").selected;i=r-1,d.socketSend("ActionInventoryClick",{slot:i,type:"select"}),e.ents.getState(e.playerEntity,"inventory").selected=i}}),setTimeout(()=>{e.on("tick",async()=>{c.serverSettings.ingame&&(document.pointerLockElement!=e.container.canvas&&!s.isMobile||f.input.isVisible||h.pauseScreen.isVisible||l.inventory.isVisible?e.ents.getState(e.playerEntity,"receivesInputs").ignore=!0:e.ents.getState(e.playerEntity,"receivesInputs").ignore=!1)})},100)},t.setupPlayer=function(e,t,n,r){const i=e.playerEntity,o=e.entities.getPositionData(i),s=e.rendering.getScene(),c=(o.width,o.height),u=(e.ents.getPositionData(e.playerEntity).height,[0,c/2,0]);e.rendering.getScene().cameras[0].fov=1;const l=e.entities.getMovement(i);r&&Object.entries(r).forEach(e=>{l[e[0]]=e[1]}),null!=t&&e.ents.addComponentAgain(i,"inventory",t),null!=n&&(e.ents.getState(i,"inventory").armor=n),e.ents.getState(i,"inventory").crafting={1:{},2:{},3:{},4:{}},e.entities.addComponentAgain(i,e.entities.names.mesh,{mesh:new a.Mesh("main",s),offset:u})}},,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.saveSettings=t.getSettings=t.getWorldList=t.db=void 0;const i=r(n(334));class o extends i.default{constructor(){super("voxelsrv-storage"),this.version(1).stores({main:"name, data",resources:"name, data, active",worlds:"name, data, settings, lastplay"})}}t.db=new o,t.getWorldList=async function(){return await t.db.worlds.orderBy("lastplay").toArray()},t.getSettings=async function(){const e=(await t.db.main.where("name").equals("settings").toArray())[0];return console.log(e),null!=e?e.data:{}},t.saveSettings=async function(e){t.db.main.put({name:"settings",data:e})}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createSlot=t.buildInventory=t.inventory=t.buildHotbar=t.hotbar=void 0;const a=n(137),s=n(70),c=n(214),u=o(n(78));t.buildHotbar=function(e,n){const r=s.getScreen(1);t.hotbar=new u.Rectangle,t.hotbar.zIndex=5,t.hotbar.verticalAlignment=1,t.hotbar.width=184*s.scale+"px",t.hotbar.height=24*s.scale+"px",t.hotbar.thickness=0,r.addControl(t.hotbar);const i=new u.Image("hotbar","./textures/gui/hotbar.png");i.width=184*s.scale+"px",i.height=24*s.scale+"px",t.hotbar.addControl(i);const o=new u.Image("hotbar","./textures/gui/selected.png");o.zIndex=8,o.width=24*s.scale+"px",o.height=24*s.scale+"px",o.left=-19*s.scale*4+"px",t.hotbar.addControl(o);const c=new Array(9);for(let r=0;r<9;r++){c[r]=f(s.scale);const i=c[r].container;i.zIndex=9,i.isPointerBlocker=!0,i.left=-20*s.scale*4+20*s.scale*r+"px",i.onPointerClickObservable.add(t=>{e.ents.getState(e.playerEntity,"inventory").selected=r,n.send("ActionInventoryClick",{slot:r,type:"select"})}),t.hotbar.addControl(i)}const l=new u.Image("hotbar","./textures/gui/inventoryopen.png");a.isMobile&&(l.zIndex=8,l.verticalAlignment=1,l.width=24*s.scale+"px",l.height=24*s.scale+"px",l.left=19*s.scale*6+"px",l.onPointerClickObservable.add(()=>{t.inventory.isVisible=!0}),r.addControl(l));const p=async()=>{const t=e.ents.getState(e.playerEntity,"inventory");o.left=-20*s.scale*4+20*s.scale*t.selected+"px";for(let e=0;e<9;e++)d(c[e],t.items[e])};e.on("tick",p);const h=e=>{t.hotbar.width=184*e+"px",t.hotbar.height=24*e+"px",i.width=184*e+"px",i.height=24*e+"px",o.width=24*e+"px",o.height=24*e+"px";for(let e=0;e<9;e++)c[e].container.height=16*s.scale+"px",c[e].container.width=16*s.scale+"px",c[e].container.left=-20*s.scale*4+20*s.scale*e+"px",c[e].item.width=16*s.scale+"px",c[e].item.height=16*s.scale+"px",c[e].count.fontSize=8*s.scale+"px",c[e].count.left=2*s.scale+"px",c[e].count.top=4*s.scale+"px",c[e].count.shadowOffsetX=s.scale,c[e].count.shadowOffsetY=s.scale;a.isMobile&&(l.width=24*s.scale+"px",l.height=24*s.scale+"px",l.left=19*s.scale*6+"px")};s.event.on("scale-change",h),t.hotbar.onDisposeObservable.add(()=>{s.event.off("scale-change",h),e.off("tick",p),l.dispose()})};let l=0;function f(e){const t={item:new u.Image("hotbar",""),container:new u.Rectangle,count:new u.TextBlock},n=t.container;n.zIndex=20,n.height=16*e+"px",n.width=16*e+"px",n.thickness=0;const r=t.item;r.width=16*e+"px",r.height=16*e+"px",n.addControl(r);const i=t.count;return i.text="",i.fontFamily="silkscreen",i.color="#f0f0f0",i.fontSize=8*e+"px",i.left=2*e+"px",i.top=4*e+"px",i.shadowColor="#111111",i.shadowOffsetX=e,i.shadowOffsetY=e,n.addControl(i),t}function d(e,t){if(null!=t&&null!=t.id){e.item.alpha=1,e.count.alpha=1;const n=c.items[t.id];let r;return r=null==n?"./textures/error.png":n.texture.startsWith("https://")&&n.texture.startsWith("http://")?n.texture:"./textures/"+n.texture+".png",e.item.source=r,1==t.count?e.count.text="":t.count<=10?e.count.text=" "+t.count.toString():e.count.text=t.count.toString(),!0}return e.item.alpha=0,e.count.alpha=0,e.item.source="",e.count.text="",!1}t.buildInventory=function(e,n){function r(){return e.ents.getState(e.playerEntity,"inventory")}const i=s.getScreen(1);t.inventory=new u.Rectangle,t.inventory.zIndex=15,t.inventory.verticalAlignment=2,t.inventory.background="#00000077",t.inventory.thickness=0,t.inventory.isVisible=!1,i.addControl(t.inventory);const o=new u.Image("inventory","./textures/gui/container/inventory.png");o.width=180*s.scale+"px",o.height=176*s.scale+"px",o.zIndex=18,t.inventory.addControl(o);const a=new u.Rectangle;a.zIndex=20,a.verticalAlignment=2,a.top=67*s.scale+"px",a.height=20*s.scale+"px",a.width=164*s.scale+"px",a.thickness=0,t.inventory.addControl(a);const p=new Array(9),h=new Array(36),m=[],y=new Array(5);for(let e=1;e<4;e++){const r=new u.Rectangle;r.zIndex=30,r.verticalAlignment=2,r.height=20*s.scale+"px",r.width=164*s.scale+"px",r.top=9*s.scale+18*(e-1)*s.scale+"px",r.thickness=0,t.inventory.addControl(r),m[e]=r;for(let t=9*e;t<9*e+9;t++){h[t]=f(s.scale);const e=h[t].container;e.zIndex=50,e.left=-18*s.scale*4+18*s.scale*(t%9)+"px",e.onPointerClickObservable.add(e=>{let r="left";switch(e.buttonIndex){case 0:r="left";break;case 1:r="middle";break;case 2:r="right"}n.send("ActionInventoryClick",{slot:t+27*l,type:r,inventory:"main"}),console.log("ActionInventoryClick",{slot:t+27*l,type:r,inventory:"main"})}),e.onPointerEnterObservable.add(t=>{e.background="#ffffff22"}),e.onPointerOutObservable.add(t=>{e.background="#00000000"}),e.isPointerBlocker=!0,r.addControl(e)}}const v=f(s.scale);v.container.zIndex=50,v.container.verticalAlignment=0,v.container.horizontalAlignment=0,v.container.isPointerBlocker=!1,v.count.isPointerBlocker=!1,v.item.isPointerBlocker=!1,t.inventory.addControl(v.container);for(let e=0;e<9;e++){p[e]=f(s.scale);const t=p[e].container;t.zIndex=40,t.left=-18*s.scale*4+18*s.scale*e+"px",t.onPointerClickObservable.add(t=>{let r="left";switch(t.buttonIndex){case 0:r="left";break;case 1:r="middle";break;case 2:r="right"}n.send("ActionInventoryClick",{slot:e,type:r,inventory:"main"})}),t.onPointerEnterObservable.add(e=>{t.background="#ffffff22"}),t.onPointerOutObservable.add(e=>{t.background="#00000000"}),t.isPointerBlocker=!0,a.addControl(t)}const g=new u.Rectangle;g.zIndex=40,g.verticalAlignment=2,g.top=-39*s.scale+"px",g.left=-72*s.scale+"px",g.height=72*s.scale+"px",g.width=18*s.scale+"px",g.thickness=0,t.inventory.addControl(g);const b=new Array(4);for(let e=0;e<4;e++){b[e]=f(s.scale);const t=b[e].container;t.zIndex=50,t.verticalAlignment=0,t.top=18*s.scale*e+"px",t.onPointerClickObservable.add(t=>{let r="left";switch(t.buttonIndex){case 0:r="left";break;case 1:r="middle";break;case 2:r="right"}n.send("ActionInventoryClick",{slot:e,type:r,inventory:"armor"})}),t.onPointerEnterObservable.add(e=>{t.background="#ffffff22"}),t.onPointerOutObservable.add(e=>{t.background="#00000000"}),t.isPointerBlocker=!0,g.addControl(t)}const w=new u.Rectangle;w.zIndex=40,w.verticalAlignment=2,w.top=-29*s.scale+"px",w.left=18*s.scale+"px",w.height=72*s.scale+"px",w.width=118*s.scale+"px",w.thickness=0,t.inventory.addControl(w);for(let e=0;e<5;e++){y[e]=f(s.scale);const t=y[e].container;t.zIndex=50,t.verticalAlignment=0,4==e?(t.left=48*s.scale+"px",t.top=10*s.scale+"px"):(e%2==1&&(t.left=18*s.scale+"px"),e>1&&(t.top=18*s.scale+"px")),t.onPointerClickObservable.add(t=>{let r="left";switch(t.buttonIndex){case 0:r="left";break;case 1:r="middle";break;case 2:r="right"}n.send("ActionInventoryClick",{slot:e,type:r,inventory:"crafting"})}),t.onPointerEnterObservable.add(e=>{t.background="#ffffff22"}),t.onPointerOutObservable.add(e=>{t.background="#00000000"}),t.isPointerBlocker=!0,w.addControl(t)}i.onPointerMoveObservable.add(e=>{v.container.left=e.x+10,v.container.top=e.y+10});const _={};if(r().size>36){const e=new u.Rectangle;_.box=e,e.height=15*s.scale+"px",e.width=22*s.scale+"px",e.zIndex=25,e.thickness=0,e.top=-6*s.scale+"px",e.left=71*s.scale+"px",t.inventory.addControl(e);const n=r(),i=new u.Image("button1","./textures/gui/button-right.png");_.button1=i,i.zIndex=25,i.horizontalAlignment=1,i.height=15*s.scale+"px",i.width=11*s.scale+"px",i.onPointerClickObservable.add(e=>{l+=1,9+27*l>n.size&&(l=0)}),i.isPointerBlocker=!0,e.addControl(i);const o=new u.Image("button2","./textures/gui/button-left.png");_.button2=o,o.zIndex=25,o.horizontalAlignment=0,o.height=15*s.scale+"px",o.width=11*s.scale+"px",o.onPointerClickObservable.add(e=>{l-=1,l<0&&(l=Math.round(27/((n.size-9)/27)/3-1))}),o.isPointerBlocker=!0,e.addControl(o)}const k=async()=>{if(0==t.inventory.isVisible)return;const e=r();if(null!=e.tempslot&&null!=e.tempslot.id){v.item.alpha=1,v.count.alpha=1;const t=c.items[e.tempslot.id];let n;n=null==t?"./textures/error.png":t.texture.startsWith("https://")&&t.texture.startsWith("http://")?t.texture:"./textures/"+t.texture+".png",v.item.source=n,1==e.tempslot.count?v.count.text="":e.tempslot.count<=10?v.count.text=" "+e.tempslot.count.toString():v.count.text=e.tempslot.count.toString()}else v.item.alpha=0,v.count.alpha=0,v.item.source="",v.count.text="";for(let t=0;t<9;t++)d(p[t],e.items[t]);for(let t=9;t<36;t++)d(h[t],e.items[27*l+t]);for(let t=0;t<4;t++){if(0==d(b[t],e.armor.items[t])){let e;switch(b[t].count.alpha=0,t){case 0:e="./textures/item/empty_armor_slot_helmet.png";break;case 1:e="./textures/item/empty_armor_slot_chestplate.png";break;case 2:e="./textures/item/empty_armor_slot_leggings.png";break;case 3:e="./textures/item/empty_armor_slot_boots.png"}b[t].item.source=e,b[t].count.text=""}}for(let t=0;t<5;t++)d(y[t],e.crafting[t])};e.on("tick",k);const x=e=>{o.width=180*e+"px",o.height=176*e+"px",a.top=67*e+"px",a.height=20*e+"px",a.width=164*e+"px",g.top=-39*e+"px",g.left=-72*e+"px",g.height=72*e+"px",g.width=18*e+"px",null!=_.box&&(_.box.height=15*e+"px",_.box.width=22*e+"px",_.box.top=-6*e+"px",_.box.left=71*e+"px",_.button1.height=15*e+"px",_.button1.width=11*e+"px",_.button2.height=15*e+"px",_.button2.width=11*e+"px"),v.container.height=16*e+"px",v.container.width=16*e+"px",v.item.width=16*e+"px",v.item.height=16*e+"px",v.count.fontSize=8*e+"px",v.count.left=2*e+"px",v.count.top=4*e+"px",v.count.shadowOffsetX=e,v.count.shadowOffsetY=e;for(let t=0;t<p.length;t++)p[t].container.height=16*e+"px",p[t].container.width=16*e+"px",p[t].container.left=-18*e*4+18*e*(t%9)+"px",p[t].item.width=16*e+"px",p[t].item.height=16*e+"px",p[t].count.fontSize=8*e+"px",p[t].count.left=2*e+"px",p[t].count.top=4*e+"px",p[t].count.shadowOffsetX=e,p[t].count.shadowOffsetY=e;for(let t=0;t<b.length;t++)b[t].container.height=16*e+"px",b[t].container.width=16*e+"px",b[t].item.width=16*e+"px",b[t].item.height=16*e+"px",b[t].count.fontSize=8*e+"px",b[t].count.left=2*e+"px",b[t].count.top=4*e+"px",b[t].count.shadowOffsetX=e,b[t].count.shadowOffsetY=e;for(let t=1;t<4;t++){m[t].height=20*e+"px",m[t].width=164*e+"px",m[t].top=9*e+18*(t-1)*e+"px";for(let n=9*t;n<9*t+9;n++)h[n].container.left=-18*e*4+18*e*(n%9)+"px",h[n].container.height=16*e+"px",h[n].container.width=16*e+"px",h[n].item.width=16*e+"px",h[n].item.height=16*e+"px",h[n].count.fontSize=8*e+"px",h[n].count.left=2*e+"px",h[n].count.top=4*e+"px",h[n].count.shadowOffsetX=e,h[n].count.shadowOffsetY=e}w.top=-29*e+"px",w.left=18*e+"px",w.height=72*e+"px",w.width=118*e+"px";for(let t=0;t<5;t++)4==t?(y[t].container.left=48*e+"px",y[t].container.top=10*e+"px"):(t%2==1&&(y[t].container.left=18*e+"px"),t>1&&(y[t].container.top=18*e+"px")),y[t].container.height=16*e+"px",y[t].container.width=16*e+"px",y[t].item.width=16*e+"px",y[t].item.height=16*e+"px",y[t].count.fontSize=8*e+"px",y[t].count.left=2*e+"px",y[t].count.top=4*e+"px",y[t].count.shadowOffsetX=e,y[t].count.shadowOffsetY=e};s.event.on("scale-change",x),t.inventory.onDisposeObservable.add(()=>{s.event.off("scake-change",x),e.off("tick",k)})},t.createSlot=f},function(e,t,n){"use strict";e.exports=n(339)},function(e,t,n){"use strict";e.exports=f;var r,i=n(131),o=i.LongBits,a=i.base64,s=i.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function f(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var d=function(){return i.Buffer?function(){return(f.create=function(){return new r})()}:function(){return new f}};function p(e,t,n){t[n]=255&e}function h(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function y(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}f.create=d(),f.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(f.alloc=i.pool(f.alloc,i.Array.prototype.subarray)),f.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},h.prototype=Object.create(c.prototype),h.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},f.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new h((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},f.prototype.int32=function(e){return e<0?this._push(m,10,o.fromNumber(e)):this.uint32(e)},f.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},f.prototype.uint64=function(e){var t=o.from(e);return this._push(m,t.length(),t)},f.prototype.int64=f.prototype.uint64,f.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(m,t.length(),t)},f.prototype.bool=function(e){return this._push(p,1,e?1:0)},f.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},f.prototype.sfixed32=f.prototype.fixed32,f.prototype.fixed64=function(e){var t=o.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},f.prototype.sfixed64=f.prototype.fixed64,f.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},f.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var v=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};f.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(i.isString(e)){var n=f.alloc(t=a.length(e));a.decode(e,n,0),e=n}return this.uint32(t)._push(v,t,e)},f.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(p,1,0)},f.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},f.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},f.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},f.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},f._configure=function(e){r=e,f.create=d(),r._configure()}},function(e,t,n){"use strict";e.exports=c;var r,i=n(131),o=i.LongBits,a=i.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},f=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function d(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function h(){if(this.pos+8>this.len)throw s(this,8);return new o(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}c.create=f(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return p(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|p(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=f(),r._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return h.call(this)[t](!0)},sfixed64:function(){return h.call(this)[t](!1)}})}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=n(70),s=o(n(78)),c=n(130),u=n(95);t.default=function(e,t){const n=new s.Rectangle;n.thickness=0,n.horizontalAlignment=2,n.zIndex=10,window.innerHeight>230*a.scale?n.height=230*a.scale+"px":n.height="100%",n.width=220*a.scale+"px",n.background="#11111166";const r=new s.TextBlock;r.fontFamily="Lato",r.fontSize=11*a.scale,r.textVerticalAlignment=0,r.color="white",r.text="Settings",r.top=a.scale,n.addControl(r);const i=new s.StackPanel;i.verticalAlignment=0,i.top=18*a.scale+"px",i.width=210*a.scale+"px",i.height="80%",n.addControl(i);const o=c.createInput();o.name.text="Nickname",o.input.placeholderText="Write your nickname",o.input.text=u.gameSettings.nickname,o.input.promptMessage="Enter your nickname",i.addControl(o.main);const l=c.createSlider();l.name.text="Mouse sensitivity: "+u.gameSettings.mouse,l.slider.value=u.gameSettings.mouse,l.slider.minimum=1,l.slider.maximum=80,l.slider.step=1,l.slider.onValueChangedObservable.add(e=>{l.name.text="Mouse sensitivity: "+e}),i.addControl(l.main);const f=c.createSlider();f.name.text="GUI scale: "+u.gameSettings.scale,f.slider.value=u.gameSettings.scale,f.slider.minimum=2,f.slider.maximum=5,f.slider.step=1,f.slider.onValueChangedObservable.add(e=>{f.name.text="GUI scale: "+e}),i.addControl(f.main);const d=c.createCheckbox();d.name.text="Enable gamepad: "+u.gameSettings.gamepad,d.isChecked=u.gameSettings.gamepad,d.main.onPointerClickObservable.add(()=>{d.isChecked=!d.isChecked,d.name.text="Enable gamepad: "+d.isChecked}),i.addControl(d.main);const p=c.createSlider();p.name.text="View Distance: "+u.gameSettings.viewDistance,p.slider.value=u.gameSettings.viewDistance,p.slider.minimum=2,p.slider.maximum=16,p.slider.step=1,p.slider.onValueChangedObservable.add(e=>{p.name.text="View Distance: "+e}),i.addControl(p.main);const h=c.createItem();h.item.verticalAlignment=1,h.text.text=[{text:"Back",color:"white",font:"Lato"}],h.item.onPointerClickObservable.add(()=>{u.updateSettings({nickname:o.input.text,mouse:l.slider.value,scale:f.slider.value,gamepad:d.isChecked,viewDistance:p.slider.value}),e.camera.sensitivityX=l.slider.value,e.camera.sensitivityY=l.slider.value,e.world.chunkAddDistance=p.slider.value,e.world.chunkRemoveDistance=p.slider.value,n.dispose(),t("main")}),n.addControl(h.item);const m=e=>{window.innerHeight>230*a.scale?n.height=230*a.scale+"px":n.height="100%",n.width=220*a.scale+"px",r.fontSize=11*a.scale,i.top=18*a.scale+"px",i.width=210*a.scale+"px",h.item.width=100*a.scale+"px",h.item.height=18*a.scale+"px",h.text.fontSize=10*a.scale};return a.event.on("scale-change",m),n.onDisposeObservable.add(()=>{a.event.off("scale-change",m)}),n}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.pauseScreen=void 0;const s=n(70),c=o(n(78)),u=n(172),l=n(130),f=a(n(252));t.default=function(e){const n=s.getScreen(1);let r,i;t.pauseScreen=new c.Rectangle,t.pauseScreen.zIndex=20,t.pauseScreen.verticalAlignment=2,t.pauseScreen.background="#00000077",t.pauseScreen.thickness=0,t.pauseScreen.isVisible=!1,n.addControl(t.pauseScreen);const o=new c.Rectangle;o.thickness=0,o.horizontalAlignment=2,o.zIndex=10,o.height=200*s.scale+"px",o.width=160*s.scale+"px",o.background="#11111166",t.pauseScreen.addControl(o);const a=new c.TextBlock;function d(n){switch(n){case"settings":r=f.default(e,d),i="settings",t.pauseScreen.addControl(r);break;default:r.dispose(),r=null,o.isVisible=!0,i="main"}}a.fontFamily="Lato",a.fontSize=11*s.scale,a.textVerticalAlignment=0,a.color="white",a.text="Pause",a.top=s.scale,o.addControl(a);const p=new c.StackPanel;o.addControl(p);const h=l.createItem();h.item.verticalAlignment=1,h.text.text=[{text:"Back to game",color:"white",font:"Lato"}],h.item.onPointerClickObservable.add(()=>{t.pauseScreen.isVisible=!1,e.container.canvas.requestPointerLock()}),p.addControl(h.item);const m=l.createItem();m.item.verticalAlignment=1,m.text.text=[{text:"Settings",color:"white",font:"Lato"}],m.item.onPointerClickObservable.add(()=>{o.isVisible=!1,d("settings")}),p.addControl(m.item);const y=l.createItem();y.text.text=[{text:"Discord",color:"white",font:"Lato"}],y.item.onPointerClickObservable.add(e=>{window.open("https://discord.com/invite/K9PdsDh","_blank")}),p.addControl(y.item);const v=l.createItem();v.item.verticalAlignment=1,v.text.text=[{text:"Disconnect",color:"white",font:"Lato"}],v.item.onPointerClickObservable.add(()=>{t.pauseScreen.dispose(),u.disconnect()}),p.addControl(v.item);const g=e=>{o.height=200*s.scale+"px",o.width=160*s.scale+"px",a.fontSize=11*s.scale,p._children.forEach(e=>{e.width=100*s.scale+"px",e.height=18*s.scale+"px",e._children[0].fontSize=10*s.scale})};return s.event.on("scale-change",g),o.onDisposeObservable.add(()=>{s.event.off("scale-change",g)}),o}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.applyModel=t.defineModelComp=void 0;const a=o(n(141)),s=n(95),c={};let u;function l(e,t){const n=u.rendering.getScene(),r=[e.geometry.texturewidth,e.geometry.textureheight],i=new a.Mesh("main",n),o=e.geometry.bones,c={};for(var l=0;l<o.length;l++){const e=o[l],d=e.cubes,p=new Array(d.length),h=e.pivot;for(let i=0;i<d.length;i++){let o=0;null!=d[i].inflate&&(o=d[i].inflate);const c=new Array(6),l=d[i].size,h=d[i].origin,m=d[i].uv;c[0]=new a.Vector4((m[0]+l[2])/r[0],(r[1]-l[1]-l[2]-m[1])/r[1],(l[2]+l[0]+m[0])/r[0],(r[1]-l[2]-m[1])/r[1]),c[1]=new a.Vector4((m[0]+2*l[2]+l[0])/r[0],(r[1]-l[1]-l[2]-m[1])/r[1],(2*l[2]+2*l[0]+m[0])/r[0],(r[1]-l[2]-m[1])/r[1]),c[2]=new a.Vector4(m[0]/r[0],(r[1]-l[1]-l[2]-m[1])/r[1],(m[0]+l[2])/r[0],(r[1]-l[2]-m[1])/r[1]),c[3]=new a.Vector4((m[0]+l[2]+l[0])/r[0],(r[1]-l[1]-l[2]-m[1])/r[1],(l[2]+2*l[0]+m[0])/r[0],(r[1]-l[2]-m[1])/r[1]),c[4]=new a.Vector4((l[0]+l[2]+m[0])/r[0],(r[1]-l[2]-m[1])/r[1],(m[0]+l[2])/r[0],(r[1]-m[1])/r[1]),c[5]=new a.Vector4((2*l[0]+l[2]+m[0])/r[0],(r[1]-l[2]-m[1])/r[1],(m[0]+l[2]+l[0])/r[0],(r[1]-m[1])/r[1]),p[i]=a.MeshBuilder.CreateBox("part-"+e.name+"-"+i,{height:.06*(l[1]+o),width:.06*(l[0]+o),depth:.06*(l[2]+o),faceUV:c,wrap:!0},n),p[i].position=new a.Vector3(.06*-(h[0]+(l[0]-o/2)/2),.06*(h[1]+(l[1]-o/2)/2),.06*(h[2]+(l[2]-o/2)/2));var f=u.rendering.makeStandardMaterial("modelmaterial-"+e.name+"-"+i);p[i].material=f,(t.startsWith("http://")||t.startsWith("https://"))&&1==s.gameSettings.allowcustom?f.diffuseTexture=new a.Texture(t,n,!0,!0,a.Texture.NEAREST_SAMPLINGMODE):f.diffuseTexture=new a.Texture("textures/"+t+".png",n,!0,!0,a.Texture.NEAREST_SAMPLINGMODE),p[i].opaque=!1,f.diffuseTexture.hasAlpha=!0}const m=a.Mesh.MergeMeshes(p,!0,!0,void 0,!0,!0);m.setParent(i),m.setPivotMatrix(a.Matrix.Translation(.06*-h[0],.06*-h[1],.06*-h[2])),c[e.name]=m,u.rendering.addMeshToScene(m)}return{main:i,models:c}}function f(e,t,n){const r=u.rendering.getScene(),i="bold 96px 'lato'",o=new a.DynamicTexture("DynamicTexture",64,r,!1).getContext();o.font=i;const s=o.measureText(t).width+8,c=s*(.3/144),l=new a.DynamicTexture("DynamicTexture",{width:s,height:144},r,!1),f=u.rendering.makeStandardMaterial("nametag");f.diffuseTexture=l,f.emissiveTexture=f.diffuseTexture,f.diffuseTexture.hasAlpha=!0,f.opacityTexture=f.diffuseTexture,l.drawText(t,null,null,i,"#eeeeee","#00000066",!0);const d=a.MeshBuilder.CreatePlane("plane",{width:c,height:.3},r);return d.material=f,d.setPositionWithLocalVector(new a.Vector3(0,n+.2,0)),d.opaque=!1,d.setParent(e),u.rendering.addMeshToScene(d),d}t.defineModelComp=function(e){u=e,u.ents.createComponent({name:"model",state:{models:{}}})},t.applyModel=function(e,t,n,r,i,o,s,d){const p=u.rendering.getScene();if(null==c[n])fetch("./models/"+n+".json").then(e=>e.json()).then((function(h){const m=l(h,r);c[n]=h,o&&(m.nametag=f(m.main,s,u.ents.getPositionData(e).height)),u.ents.addComponent(e,"model",m);const y=a.MeshBuilder.CreateBox("hitbox-"+t,{height:d[1],width:d[0],depth:d[2]},p);y.setParent(m.main),y.setPositionWithLocalVector(new a.Vector3(0,d[1]/2,0)),y.material=u.rendering.makeStandardMaterial(),y.material.wireframe=!0,u.rendering.addMeshToScene(y,!1),u.entities.addComponent(e,u.entities.names.mesh,{mesh:m.main,offset:i})}));else{const t=l(c[n],r);o&&(t.nametag=f(t.main,s,u.ents.getPositionData(e).height)),u.ents.addComponent(e,"model",t),u.entities.addComponent(e,u.entities.names.mesh,{mesh:t.main,offset:i})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearStorage=t.chunkSetBlock=t.getChunk=t.removeChunk=t.setChunk=t.event=void 0;const r=n(132),i=n(123);t.event=new i.EventEmitter;let o={};t.setChunk=function(e){let n;if(e.compressed){let t=0;t=e.type?262144:35}if(n=new Uint16Array(e.data.buffer,e.data.byteOffset),e.type){const a=new r(n,[32,256,32]);for(var i=0;i<8;i++){const n=new r(new Uint16Array(32768),[32,32,32]),s=[e.x,i,e.z].join("|");for(let e=0;e<32;e++)for(let t=0;t<32;t++)for(let r=0;r<32;r++){const o=a.get(e,r+32*i,t);n.set(e,r,t,o),o>255&&console.log(o)}t.event.emit("load-"+s,n),t.event.emit("loadany",s,n),o[s]=n}}else{const i=[e.x,e.y,e.z].join("|"),a=new r(n,[32,32,32]);t.event.emit("load-"+i,a),t.event.emit("loadany",i,a),o[i]=a}},t.removeChunk=function(e){delete o[e]},t.getChunk=function(e){return new Promise((n,i)=>{null!=o[e]?n(new r(o[e].data,o[e].shape)):(t.event.once("load-"+e,e=>n(new r(e.data,e.shape))),setTimeout(()=>{i("Timeout")},1e5))})},t.chunkSetBlock=function(e,t,n,r){const i=[Math.floor(t/32),Math.floor(n/32),Math.floor(r/32)].join("|");if(null==o[i])return;let a=t%32,s=n%32,c=r%32;a<0&&(a+=32),s<0&&(s+=32),c<0&&(c+=32),o[i].set(a,s,c,e)},t.clearStorage=function(){o={}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.setupClouds=t.cloudMesh=t.setupSkybox=void 0;const a=o(n(141));t.setupSkybox=function(e){const t=e.rendering.getScene(),n=a.Mesh.CreateSphere("skyBox",32,1e3,t);e.rendering.addMeshToScene(n)},t.setupClouds=function(e){const n=e.rendering.getScene();t.cloudMesh=a.MeshBuilder.CreatePlane("cloudMesh",{height:1500,width:1500},n);const r=new a.StandardMaterial("cloud",n),i=new a.Texture("./textures/environment/clouds.png",n,!0,!0,a.Texture.NEAREST_SAMPLINGMODE);i.hasAlpha=!0,i.vScale=.75,i.uScale=.75,r.diffuseTexture=i,r.opacityTexture=i,r.backFaceCulling=!1,r.emissiveColor=new a.Color3(1,1,1),t.cloudMesh.rotation.x=-Math.PI/2,t.cloudMesh.material=r,e.rendering.addMeshToScene(t.cloudMesh,!1),t.cloudMesh.setPositionWithLocalVector(new a.Vector3(0,0,200));let o=[...e.camera.getPosition()];const s=()=>{null!=e.ents.getState(e.playerEntity,e.ents.names.mesh)&&t.cloudMesh.setParent(e.ents.getState(e.playerEntity,e.ents.names.mesh).mesh),i.vOffset+=1e-5+(o[2]-e.camera.getPosition()[2])/1e4,i.uOffset-=(o[0]-e.camera.getPosition()[0])/1e4,o=[...e.camera.getPosition()],t.cloudMesh.setPositionWithLocalVector(new a.Vector3(0,0,200-e.camera.getPosition()[1]))};e.on("beforeRender",s),t.cloudMesh.onDisposeObservable.add(()=>{e.off("beforeRender",s)})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(137),o=r(n(368)),a=n(245),s=n(254),c=n(95),u=n(70),l=n(217),f=n(247),d=n(256),p=n(216),h=n(172),m=n(364),y=n(365),v=n(366),g=n(255),b=n(132);c.defaultFonts.forEach(e=>document.fonts.load(`10pt "${e}"`)),f.getSettings().then(e=>c.updateSettings(e));const w=new o.default(c.noaOpts());w.ents.createComponent({name:"inventory",state:{items:{},selected:0,tempslot:{},armor:{},crafting:{}}}),c.setNoa(w),w.ents.getPhysics(w.playerEntity).body.airDrag=9999,w.world.maxChunksPendingCreation=1/0,u.constructScreen(w),d.setupClouds(w),s.defineModelComp(w),a.setupControls(w),y.setupGamepad(w),w.world.on("worldDataNeeded",async(e,t)=>{const n=e.split("|");e=`${n[0]}|${n[1]}|${n[2]}`,g.getChunk(e).then(t=>w.world.setChunkData(`${e}|${n[3]}`,t)).catch(()=>{w.world._chunkIDsPending.remove(e)})}),g.event.on("loadany",(e,t)=>{w.world.setChunkData(e,new b(t.data,t.shape))});let _=0;w.on("beforeRender",async()=>{c.serverSettings.ingame||(_++,w.camera.heading=_/2e3,w.camera.pitch=0)}),window.onerror=function(e,t,n,r,i){alert(e+"\nPlease report this error at: https://github.com/VoxelSrv/voxelsrv/issues")},window.connect=e=>{h.connect(w,new l.MPSocket(e))},window.peer=e=>{h.connect(w,new l.PeerSocket(e))},window.forceplay=()=>{c.updateServerSettings({ingame:!0})},window.onload=function(){if(i.isMobile){m.setupMobile(w);const e=document.createElement("link");e.rel="stylesheet",e.href="mobile.css",document.head.appendChild(e),document.documentElement.addEventListener("click",(function(){document.fullscreenElement||(document.documentElement.requestFullscreen(),screen.orientation.lock("landscape"))}))}i.isFirefox&&v.warningFirefox();const e=new URLSearchParams(window.location.search);if(e.get("server")){const t=new l.MPSocket("ws://"+e.get("server"));h.connect(w,t)}else if(e.get("peer")){const t=new l.PeerSocket(e.get("peer"));h.connect(w,t)}else setTimeout(()=>{p.buildMainMenu(w)},50);null!=window.electron&&window.electron.on("world-started",(e,t)=>{h.connect(w,new l.MPSocket("ws://localhost:"+t))})}},function(e,t){e.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},function(e,t,n){e.exports=function(e,t){var n=r(e[0],e[1],e[2]),a=r(t[0],t[1],t[2]);i(n,n),i(a,a);var s=o(n,a);return s>1?0:Math.acos(s)};var r=n(223),i=n(224),o=n(225)},function(e,t){e.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},function(e,t){e.exports=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}},function(e,t,n){e.exports=function(e,t){var n=e[0],i=e[1],o=e[2],a=t[0],s=t[1],c=t[2];return Math.abs(n-a)<=r*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=r*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-c)<=r*Math.max(1,Math.abs(o),Math.abs(c))};var r=n(221)},function(e,t){e.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}},function(e,t,n){e.exports=n(226)},function(e,t,n){e.exports=n(227)},function(e,t,n){e.exports=n(228)},function(e,t){e.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}},function(e,t){e.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}},function(e,t){e.exports=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}},function(e,t,n){e.exports=n(229)},function(e,t,n){e.exports=n(230)},function(e,t,n){e.exports=n(231)},function(e,t,n){e.exports=n(232)},function(e,t){e.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},function(e,t){e.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],c=n[2];return e[0]=i*c-o*s,e[1]=o*a-r*c,e[2]=r*s-i*a,e}},function(e,t){e.exports=function(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e}},function(e,t){e.exports=function(e,t){t=t||1;var n=2*Math.random()*Math.PI,r=2*Math.random()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],c=n[2],u=n[3],l=u*r+s*o-c*i,f=u*i+c*r-a*o,d=u*o+a*i-s*r,p=-a*r-s*i-c*o;return e[0]=l*u+p*-a+f*-c-d*-s,e[1]=f*u+p*-s+d*-a-l*-c,e[2]=d*u+p*-c+l*-s-f*-a,e}},function(e,t){e.exports=function(e,t,n,r){var i=n[1],o=n[2],a=t[1]-i,s=t[2]-o,c=Math.sin(r),u=Math.cos(r);return e[0]=t[0],e[1]=i+a*u-s*c,e[2]=o+a*c+s*u,e}},function(e,t){e.exports=function(e,t,n,r){var i=n[0],o=n[2],a=t[0]-i,s=t[2]-o,c=Math.sin(r),u=Math.cos(r);return e[0]=i+s*c+a*u,e[1]=t[1],e[2]=o+s*u-a*c,e}},function(e,t){e.exports=function(e,t,n,r){var i=n[0],o=n[1],a=t[0]-i,s=t[1]-o,c=Math.sin(r),u=Math.cos(r);return e[0]=i+a*u-s*c,e[1]=o+a*c+s*u,e[2]=t[2],e}},function(e,t,n){e.exports=function(e,t,n,i,o,a){var s,c;t||(t=3);n||(n=0);c=i?Math.min(i*t+n,e.length):e.length;for(s=n;s<c;s+=t)r[0]=e[s],r[1]=e[s+1],r[2]=e[s+2],o(r,r,a),e[s]=r[0],e[s+1]=r[1],e[s+2]=r[2];return e};var r=n(222)()},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i,o){var a=+t[0],s=+t[1],c=+t[2],u=+n[0],l=+n[1],f=+n[2],d=Math.sqrt(u*u+l*l+f*f);if(0===d)throw new Error("Can't raycast along a zero vector");return function(e,t,n,r,i,o,a,s,c,u){for(var l=0,f=Math.floor,d=0|f(t),p=0|f(n),h=0|f(r),m=i>0?1:-1,y=o>0?1:-1,v=a>0?1:-1,g=Math.abs(1/i),b=Math.abs(1/o),w=Math.abs(1/a),_=g<1/0?g*(m>0?d+1-t:t-d):1/0,k=b<1/0?b*(y>0?p+1-n:n-p):1/0,x=w<1/0?w*(v>0?h+1-r:r-h):1/0,O=-1;l<=s;){var P=e(d,p,h);if(P)return c&&(c[0]=t+l*i,c[1]=n+l*o,c[2]=r+l*a),u&&(u[0]=u[1]=u[2]=0,0===O&&(u[0]=-m),1===O&&(u[1]=-y),2===O&&(u[2]=-v)),P;_<k?_<x?(d+=m,l=_,_+=g,O=0):(h+=v,l=x,x+=w,O=2):k<x?(p+=y,l=k,k+=b,O=1):(h+=v,l=x,x+=w,O=2)}return c&&(c[0]=t+l*i,c[1]=n+l*o,c[2]=r+l*a),u&&(u[0]=u[1]=u[2]=0),0}(e,a,s,c,u/=d,l/=d,f/=d,r=void 0===r?64:+r,i,o)}},function(e,t,n){"use strict";var r=n(123).EventEmitter,i=n(294),o=n(298),a=n(299),s=n(300),c=n(301),u=n(302),l=n(233),f=Math.min;n(303);var d=n(304),p=n(305),h=function(){var e,t,n=new Array(256);for(e=0;e<256;++e)n[e]="UNK";for(e in a)"<"===(t=a[e]).charAt(0)&&">"===t.charAt(t.length-1)&&(t=t.substring(1,t.length-1)),t=t.replace(/\s/g,"-"),n[parseInt(e)]=t;return n}(),m=c(Object.keys(s(h)));function y(e){return u.eq(m,e)}function v(e){return y(h[e])}function g(){r.call(this),this._curKeyState=new Array(m.length),this._pressCount=new Array(m.length),this._releaseCount=new Array(m.length),this._tickInterval=null,this._rafHandle=null,this._tickRate=0,this._lastTick=p(),this._frameTime=0,this._paused=!0,this._width=0,this._height=0,this._wantFullscreen=!1,this._wantPointerLock=!1,this._fullscreenActive=!1,this._pointerLockActive=!1,this._rafFunction=C.bind(void 0,this,!0),this.preventDefaults=!0,this.stopPropagation=!1;for(var e=0;e<m.length;++e)this._curKeyState[e]=!1,this._pressCount[e]=this._releaseCount[e]=0;this.element=null,this.bindings={},this.frameSkip=100,this.tickCount=0,this.frameCount=0,this.startTime=p(),this.tickTime=this._tickRate,this.frameTime=10,this.stickyFullscreen=!1,this.stickyPointerLock=!1,this.scroll=[0,0,0],this.mouseX=0,this.mouseY=0,this.prevMouseX=0,this.prevMouseY=0}i.inherits(g,r);var b=g.prototype;function w(e,t,n){if(n in t){for(var r=t[n],i=0,o=0,a=r.length;o<a;++o)i+=e[y(r[o])];return i}var s=y(n);return s>=0?e[s]:0}function _(e){var t=e.element;e._wantFullscreen&&!e._fullscreenActive&&(t.requestFullscreen||t.requestFullScreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.mozRequestFullscreen||t.mozRequestFullScreen||function(){}).call(t);e._wantPointerLock&&!e._pointerLockActive&&(t.requestPointerLock||t.webkitRequestPointerLock||t.mozRequestPointerLock||t.msRequestPointerLock||t.oRequestPointerLock||function(){}).call(t)}b.keyNames=m,b.bind=function(e){var t,n;t=e in this.bindings?this.bindings[e]:[];for(var r=1,i=arguments.length;r<i;++r)if(y(n=arguments[r])>=0)t.push(n);else if(n in this.bindings)for(var o=this.bindings[n],a=0;a<o.length;++a)t.push(o[a]);(t=c(t)).length>0&&(this.bindings[e]=t),this.emit("bind",e,t)},b.unbind=function(e){e in this.bindings&&delete this.bindings[e],this.emit("unbind",e)},b.down=function(e){return function(e,t,n){if(n in t){for(var r=t[n],i=0,o=r.length;i<o;++i)if(e[y(r[i])])return!0;return!1}var a=y(n);return a>=0&&e[a]}(this._curKeyState,this.bindings,e)},b.wasDown=function(e){return this.down(e)||!!this.press(e)},b.up=function(e){return!this.down(e)},b.wasUp=function(e){return this.up(e)||!!this.release(e)},b.press=function(e){return w(this._pressCount,this.bindings,e)},b.release=function(e){return w(this._releaseCount,this.bindings,e)},Object.defineProperty(b,"paused",{get:function(){return this._paused},set:function(e){!!e!==this._paused&&(this._paused?(this._paused=!1,this._lastTick=p()-Math.floor(this._frameTime*this._tickRate),this._tickInterval=setInterval(C,this._tickRate,this,!1),this._rafHandle=requestAnimationFrame(this._rafFunction)):(this._paused=!0,this._frameTime=f(1,(p()-this._lastTick)/this._tickRate),clearInterval(this._tickInterval)))}});var k=document.exitFullscreen||document.cancelFullscreen||document.cancelFullScreen||document.webkitCancelFullscreen||document.webkitCancelFullScreen||document.mozCancelFullscreen||document.mozCancelFullScreen||function(){};function x(e){e._fullscreenActive=document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||!1,!e.stickyFullscreen&&e._fullscreenActive&&(e._wantFullscreen=!1)}Object.defineProperty(b,"fullscreen",{get:function(){return this._fullscreenActive},set:function(e){!e?(this._wantFullscreen=!1,(document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||!1)&&k.call(document)):(this._wantFullscreen=!0,_(this));return this._fullscreenActive}});var O=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock||function(){};function P(e,t){e._pointerLockActive=e.element===(document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement||null),!e.stickyPointerLock&&e._pointerLockActive&&(e._wantPointerLock=!1)}function S(e,t,n){e._curKeyState[t]!==n&&(n?e._pressCount[t]++:e._releaseCount[t]++,e._curKeyState[t]=n)}function C(e,t){!function(e){var t,n,r,i=p()+e.frameSkip,o=e._pressCount,a=e._releaseCount,s=e._tickRate,c=m.length;for(;!e._paused&&p()>=e._lastTick+s;){if(p()>i)return void(e._lastTick=p()+s);for(n=p(),e.emit("tick"),r=p(),e.tickTime=r-n,++e.tickCount,e._lastTick+=s,t=0;t<c;++t)o[t]=a[t]=0;e._pointerLockActive?(e.prevMouseX=e.mouseX=e.width>>1,e.prevMouseY=e.mouseY=e.height>>1):(e.prevMouseX=e.mouseX,e.prevMouseY=e.mouseY),e.scroll[0]=e.scroll[1]=e.scroll[2]=0}}(e),t&&function(e){var t;e._rafHandle=requestAnimationFrame(e._rafFunction),t=e._paused?e._frameTime:f(1,(p()-e._lastTick)/e._tickRate);++e.frameCount;var n=p();e.emit("render",t);var r=p();e.frameTime=r-n}(e)}function T(e,t){e.preventDefaults&&t.preventDefault(),e.stopPropagation&&t.stopPropagation()}function E(e,t){T(e,t);var n=v(t.keyCode||t.char||t.which||t.charCode);n>=0&&S(e,n,!1)}function j(e,t){if(function(e){return document.activeElement===document.body||document.activeElement===e.element}(e))if(T(e,t),t.metaKey)N(e,t);else{var n=v(t.keyCode||t.char||t.which||t.charCode);n>=0&&S(e,n,!0)}}Object.defineProperty(b,"pointerLock",{get:function(){return this._pointerLockActive},set:function(e){return!!e?(this._wantPointerLock=!0,_(this)):(this._wantPointerLock=!1,O.call(document)),this._pointerLockActive}}),Object.defineProperty(b,"width",{get:function(){return this.element.clientWidth}}),Object.defineProperty(b,"height",{get:function(){return this.element.clientHeight}});var M=l(32).map((function(e){return y("mouse-"+(e+1))}));function D(e,t){if(T(e,t),e._pointerLockActive){var n=t.movementX||t.mozMovementX||t.webkitMovementX||0,r=t.movementY||t.mozMovementY||t.webkitMovementY||0;e.mouseX+=n,e.mouseY+=r}else e.mouseX=t.clientX-e.element.offsetLeft,e.mouseY=t.clientY-e.element.offsetTop;return!1}function I(e,t){return T(e,t),S(e,M[t.button],!0),!1}function R(e,t){return T(e,t),S(e,M[t.button],!1),!1}function A(e,t){return T(e,t),e._pointerLockActive?(e.prevMouseX=e.mouseX=e.width>>1,e.prevMouseY=e.mouseY=e.height>>1):(e.prevMouseX=e.mouseX=t.clientX-e.element.offsetLeft,e.prevMouseY=e.mouseY=t.clientY-e.element.offsetTop),!1}function B(e,t){return T(e,t),function(e,t){for(var n=0;n<32;++n)S(e,M[n],!!(t&1<<n))}(e,0),!1}function L(e,t){T(e,t);var n=1;switch(t.deltaMode){case 0:n=1;break;case 1:n=12;break;case 2:n=e.height}return e.scroll[0]+=t.deltaX*n,e.scroll[1]+=t.deltaY*n,e.scroll[2]+=t.deltaZ*n||0,!1}function z(e,t){return T(e,t),!1}function N(e,t){var n,r=m.length,i=e._curKeyState,o=e._releaseCount;for(n=0;n<r;++n)i[n]&&++o[n],i[n]=!1;return!1}function F(e,t){var n=0|e.element.clientWidth,r=0|e.element.clientHeight;n===e._width&&r===e._height||(e._width=n,e._height=r,e.emit("resize",n,r))}function U(){var e=document.createElement("div");return e.tabindex=1,e.style.position="absolute",e.style.left="0px",e.style.right="0px",e.style.top="0px",e.style.bottom="0px",e.style.height="100%",e.style.overflow="hidden",document.body.appendChild(e),document.body.style.overflow="hidden",document.body.style.height="100%",e}e.exports=function(e){var t=!!(e=e||{}).fullscreen,n=t;void 0!==typeof e.pointerLock&&(n=!!e.pointerLock);var r=new g;return r._tickRate=e.tickRate||30,r.frameSkip=e.frameSkip||5*(r._tickRate+5),r.stickyFullscreen=!!e.stickyFullscreen||!!e.sticky,r.stickyPointerLock=!!e.stickyPointerLock||!!e.sticky,e.bindings&&(r.bindings=e.bindings),setTimeout((function(){o((function(){var i=e.element;if("string"==typeof i){var o=document.querySelector(i);o||(o=document.getElementById(i)),o||(o=document.getElementByClass(i)[0]),o||(o=U()),r.element=o}else r.element="object"==typeof i&&i?i:"function"==typeof i?i():U();r.element.style&&(r.element.style["-webkit-touch-callout"]="none",r.element.style["-webkit-user-select"]="none",r.element.style["-khtml-user-select"]="none",r.element.style["-moz-user-select"]="none",r.element.style["-ms-user-select"]="none",r.element.style["user-select"]="none"),r._width=r.element.clientWidth,r._height=r.element.clientHeight;var a=F.bind(void 0,r);"undefined"!=typeof MutationObserver?new MutationObserver(a).observe(r.element,{attributes:!0,subtree:!0}):r.element.addEventListener("DOMSubtreeModified",a,!1);window.addEventListener("resize",a,!1),window.addEventListener("keydown",j.bind(void 0,r),!1),window.addEventListener("keyup",E.bind(void 0,r),!1),r.element.oncontextmenu=z.bind(void 0,r),r.element.addEventListener("mousedown",I.bind(void 0,r),!1),r.element.addEventListener("mouseup",R.bind(void 0,r),!1),r.element.addEventListener("mousemove",D.bind(void 0,r),!1),r.element.addEventListener("mouseenter",A.bind(void 0,r),!1);var s=B.bind(void 0,r);r.element.addEventListener("mouseleave",s,!1),r.element.addEventListener("mouseout",s,!1),window.addEventListener("mouseleave",s,!1),window.addEventListener("mouseout",s,!1);var c=N.bind(void 0,r);r.element.addEventListener("blur",c,!1),r.element.addEventListener("focusout",c,!1),r.element.addEventListener("focus",c,!1),window.addEventListener("blur",c,!1),window.addEventListener("focusout",c,!1),window.addEventListener("focus",c,!1),d(r.element,L.bind(void 0,r),!1);var u=x.bind(void 0,r);document.addEventListener("fullscreenchange",u,!1),document.addEventListener("mozfullscreenchange",u,!1),document.addEventListener("webkitfullscreenchange",u,!1),r.element.addEventListener("click",_.bind(void 0,r),!1);var l=P.bind(void 0,r);document.addEventListener("pointerlockchange",l,!1),document.addEventListener("mozpointerlockchange",l,!1),document.addEventListener("webkitpointerlockchange",l,!1),document.addEventListener("pointerlocklost",l,!1),document.addEventListener("webkitpointerlocklost",l,!1),document.addEventListener("mozpointerlocklost",l,!1),r.fullscreen=t,r.pointerLock=n,r.bind("mouse-left","mouse-1"),r.bind("mouse-right","mouse-3"),r.bind("mouse-middle","mouse-2"),r._lastTick=p(),r.startTime=p(),r.paused=!1,r.emit("init")}))}),0),r}},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),c=r[n];n<o;c=r[++n])m(c)||!w(c)?a+=" "+c:a+=" "+s(c);return a},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,a={};function s(e,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(n)?r.showHidden=n:n&&t._extend(r,n),g(r.showHidden)&&(r.showHidden=!1),g(r.depth)&&(r.depth=2),g(r.colors)&&(r.colors=!1),g(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),l(r,e,r.depth)}function c(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function u(e,t){return e}function l(e,n,r){if(e.customInspect&&n&&x(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return v(i)||(i=l(e,i,r)),i}var o=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(v(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(y(t))return e.stylize(""+t,"number");if(h(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,n);if(o)return o;var a=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),k(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(n);if(0===a.length){if(x(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return e.stylize(Date.prototype.toString.call(n),"date");if(k(n))return f(n)}var u,w="",O=!1,P=["{","}"];(p(n)&&(O=!0,P=["[","]"]),x(n))&&(w=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(w=" "+RegExp.prototype.toString.call(n)),_(n)&&(w=" "+Date.prototype.toUTCString.call(n)),k(n)&&(w=" "+f(n)),0!==a.length||O&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),u=O?function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)T(t,String(a))?o.push(d(e,t,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(d(e,t,n,r,i,!0))})),o}(e,n,r,s,a):a.map((function(t){return d(e,n,r,s,t,O)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(u,w,P)):P[0]+w+P[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,i,o){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),T(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(c.value)<0?(s=m(n)?l(e,c.value,null):l(e,c.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),g(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function p(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function m(e){return null===e}function y(e){return"number"==typeof e}function v(e){return"string"==typeof e}function g(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===O(e)}function w(e){return"object"==typeof e&&null!==e}function _(e){return w(e)&&"[object Date]"===O(e)}function k(e){return w(e)&&("[object Error]"===O(e)||e instanceof Error)}function x(e){return"function"==typeof e}function O(e){return Object.prototype.toString.call(e)}function P(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(g(o)&&(o=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=e.pid;a[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else a[n]=function(){};return a[n]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=h,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=g,t.isRegExp=b,t.isObject=w,t.isDate=_,t.isError=k,t.isFunction=x,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(296);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(){var e=new Date,t=[P(e.getHours()),P(e.getMinutes()),P(e.getSeconds())].join(":");return[e.getDate(),S[e.getMonth()],t].join(" ")}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",C(),t.format.apply(t,arguments))},t.inherits=n(297),t._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var E="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function j(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(E&&e[E]){var t;if("function"!=typeof(t=e[E]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,E,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),E&&Object.defineProperty(t,E,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=E,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};t.apply(this,n).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(j,t,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(295))},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?u=c.concat(u):f=-1,u.length&&p())}function p(){if(!l){var e=s(d);l=!0;for(var t=u.length;t;){for(c=u,u=[];++f<t;)c&&c[f].run();f=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new h(e,t)),1!==u.length||l||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){var r,i,o,a,s;e.exports=(i=[],o=document,a=o.documentElement.doScroll,(s=(a?/^loaded|^c/:/^loaded|^i|^c/).test(o.readyState))||o.addEventListener("DOMContentLoaded",r=function(){for(o.removeEventListener("DOMContentLoaded",r),s=1;r=i.shift();)r()}),function(e){s?setTimeout(e,0):i.push(e)})},function(e,t){var n,r="undefined"!=typeof window?window.navigator.userAgent:"",i=/OS X/.test(r),o=/Opera/.test(r),a=!/like Gecko/.test(r)&&!o,s=e.exports={0:i?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:i?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num--\x3e",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:i&&a?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:o?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(n=58;n<65;++n)s[n]=String.fromCharCode(n);for(n=48;n<58;++n)s[n]=n-48+"";for(n=65;n<91;++n)s[n]=String.fromCharCode(n);for(n=96;n<106;++n)s[n]="<num-"+(n-96)+">";for(n=112;n<136;++n)s[n]="F"+(n-111)},function(e,t,n){"use strict";e.exports=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}},function(e,t,n){"use strict";e.exports=function(e,t,n){return 0===e.length?e:t?(n||e.sort(t),function(e,t){for(var n=1,r=e.length,i=e[0],o=e[0],a=1;a<r;++a)if(o=i,t(i=e[a],o)){if(a===n){n++;continue}e[n++]=i}return e.length=n,e}(e,t)):(n||e.sort(),function(e){for(var t=1,n=e.length,r=e[0],i=e[0],o=1;o<n;++o,i=r)if(i=r,(r=e[o])!==i){if(o===t){t++;continue}e[t++]=r}return e.length=t,e}(e))}},function(e,t,n){"use strict";function r(e,t,n,r,i,o){var a=["function ",e,"(a,l,h,",r.join(","),"){",o?"":"var i=",n?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",i?".get(m)":"[m]"];return o?t.indexOf("c")<0?a.push(";if(x===y){return m}else if(x<=y){"):a.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):a.push(";if(",t,"){i=m;"),n?a.push("l=m+1}else{h=m-1}"):a.push("h=m-1}else{l=m+1}"),a.push("}"),o?a.push("return -1};"):a.push("return i};"),a.join("")}function i(e,t,n,i){return new Function([r("A","x"+e+"y",t,["y"],!1,i),r("B","x"+e+"y",t,["y"],!0,i),r("P","c(x,y)"+e+"0",t,["y","c"],!1,i),r("Q","c(x,y)"+e+"0",t,["y","c"],!0,i),"function dispatchBsearch",n,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",n].join(""))()}e.exports={ge:i(">=",!1,"GE"),gt:i(">",!1,"GT"),lt:i("<",!0,"LT"),le:i("<=",!0,"LE"),eq:i("-",!0,"EQ",!0)}},function(e,t){for(var n=0,r=["ms","moz","webkit","o"],i=0;i<r.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[r[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[r[i]+"CancelAnimationFrame"]||window[r[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var r=(new Date).getTime(),i=Math.max(0,16-(r-n)),o=window.setTimeout((function(){e(r+i)}),i);return n=r+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})},function(e,t){var n,r,i="";function o(e,t,o,a){e[n](i+t,"wheel"==r?o:function(e){!e&&(e=window.event);var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"==r?(t.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(t.deltaX=-1/40*e.wheelDeltaX)):t.deltaY=e.detail,o(t)},a||!1)}window.addEventListener?n="addEventListener":(n="attachEvent",i="on"),r="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.exports=function(e,t,n){o(e,r,t,n),"DOMMouseScroll"==r&&o(e,"MozMousePixelScroll",t,n)}},function(e,t){"object"==typeof window.performance?window.performance.now?e.exports=function(){return window.performance.now()}:window.performance.webkitNow&&(e.exports=function(){return window.performance.webkitNow()}):Date.now?e.exports=Date.now:e.exports=function(){return(new Date).getTime()}},function(e,t,n){var r=n(307),i=n(123).EventEmitter,o=n(308);function a(e,t){this.element=e||document,t=t||{},this.preventDefaults=!!t.preventDefaults,this.stopPropagation=!!t.stopPropagation,this.allowContextMenu=!!t.allowContextMenu,this.disabled=!!t.disabled,this.down=new i,this.up=new i,this.state={dx:0,dy:0,scrollx:0,scrolly:0,scrollz:0},this._keybindmap={},this._keyStates={},this._bindPressCounts={},this._ignoreMousemoveOnce=!1,this.initEvents()}function s(e,t,n){v(n.keyCode,r[n.keyCode],t,e,n)}function c(e,t,n){return v(-1-n.button,"<mouse "+(n.button+1)+">",t,e,n),!1}function u(e){if(!e.allowContextMenu)return!1}function l(e,t){if(e._ignoreMousemoveOnce)e._ignoreMousemoveOnce=!1;else{var n=t.movementX||t.mozMovementX||0,r=t.movementY||t.mozMovementY||0;if(t.touches&&0==(n|r)){var i=function(e){for(var t,n=e.changedTouches,r=0;r<n.length;++r)n[r].identifier==p&&(t=n[r]);if(!t)return[0,0];var i=[t.clientX-f,t.clientY-d];return f=t.clientX,d=t.clientY,i}(t);n=i[0],r=i[1]}e.state.dx+=n,e.state.dy+=r}}e.exports=function(e,t){return new a(e,t)},a.prototype.initEvents=function(){window.addEventListener("keydown",s.bind(void 0,this,!0),!1),window.addEventListener("keyup",s.bind(void 0,this,!1),!1),this.element.addEventListener("mousedown",c.bind(void 0,this,!0),!1),this.element.addEventListener("mouseup",c.bind(void 0,this,!1),!1),this.element.oncontextmenu=u.bind(void 0,this),this.element.addEventListener("dragstart",c.bind(void 0,this,!1),!1),this.element.addEventListener("mousemove",l.bind(void 0,this),!1),this.element.addEventListener("touchmove",l.bind(void 0,this),!1),this.element.addEventListener("touchstart",h.bind(void 0,this),!1),o(this.element,m.bind(void 0,this),!1),document.addEventListener("pointerlockchange",y.bind(void 0,this),!1),document.addEventListener("mozpointerlockchange",y.bind(void 0,this),!1)},a.prototype.bind=function(e){for(var t=1;t<arguments.length;++t){var n=arguments[t],r=this._keybindmap[n]||[];-1==r.indexOf(e)&&r.push(e),this._keybindmap[n]=r}this.state[e]=!!this.state[e]},a.prototype.unbind=function(e){for(var t in this._keybindmap){var n=this._keybindmap[t],r=n.indexOf(e);r>-1&&n.splice(r,1)}},a.prototype.tick=function(){this.state.dx=this.state.dy=0,this.state.scrollx=this.state.scrolly=this.state.scrollz=0},a.prototype.getBoundKeys=function(){var e=[];for(var t in this._keybindmap)e.push(t);return e};var f=0,d=0,p=null;function h(e,t){var n=t.changedTouches[0];f=n.clientX,d=n.clientY,p=n.identifier}function m(e,t){var n=1;switch(t.deltaMode){case 0:n=1;break;case 1:n=12;break;case 2:n=e.element.clientHeight||window.innerHeight}return e.state.scrollx+=t.deltaX*n,e.state.scrolly+=t.deltaY*n,e.state.scrollz+=t.deltaZ*n||0,!1}function y(e,t){(document.pointerLockElement||document.mozPointerLockElement||null)&&(e._ignoreMousemoveOnce=!0)}function v(e,t,n,r,i){var o=r._keybindmap[t];if(o){if(r.preventDefaults&&i.preventDefault(),r.stopPropagation&&i.stopPropagation(),b(r._keyStates[e],n))for(var a=0;a<o.length;++a)g(o[a],n,r,i);r._keyStates[e]=n}}function g(e,t,n,r){var i=n._bindPressCounts[e]||0;if((i+=t?1:-1)<0&&(i=0),n._bindPressCounts[e]=i,b(n.state[e],i)){var o=t?n.down:n.up;n.disabled||o.emit(e,r)}n.state[e]=!!i}function b(e,t){return e?!t:t}},function(e,t,n){"use strict";var r,i="undefined"!=typeof window?window.navigator.userAgent:"",o=/OS X/.test(i),a=/Opera/.test(i),s=!/like Gecko/.test(i)&&!a,c=e.exports={0:o?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:o?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num--\x3e",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:o&&s?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:a?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(r=58;r<65;++r)c[r]=String.fromCharCode(r);for(r=48;r<58;++r)c[r]=r-48+"";for(r=65;r<91;++r)c[r]=String.fromCharCode(r);for(r=96;r<106;++r)c[r]="<num-"+(r-96)+">";for(r=112;r<136;++r)c[r]="F"+(r-111)},function(e,t){var n,r,i="";function o(e,t,o,a){e[n](i+t,"wheel"==r?o:function(e){!e&&(e=window.event);var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"==r?(t.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(t.deltaX=-1/40*e.wheelDeltaX)):t.deltaY=e.detail,o(t)},a||!1)}window.addEventListener?n="addEventListener":(n="attachEvent",i="on"),r="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.exports=function(e,t,n){o(e,r,t,n),"DOMMouseScroll"==r&&o(e,"MozMousePixelScroll",t,n)}},function(e,t,n){"use strict";var r=n(211),i=n(77),o=n(242),a=n(310);e.exports=function(e,t,n){return new c(e,t,n)};var s={gravity:[0,-10,0],minBounceImpulse:.5,airDrag:.1,fluidDrag:.4,fluidDensity:2};function c(e,t,n){e=Object.assign({},s,e),this.gravity=e.gravity,this.airDrag=e.airDrag,this.fluidDensity=e.fluidDensity,this.fluidDrag=e.fluidDrag,this.minBounceImpulse=e.minBounceImpulse,this.bodies=[],this.testSolid=t,this.testFluid=n}c.prototype.addBody=function(e,t,n,i,o,s){e=e||new r([0,0,0],[1,1,1]),void 0===t&&(t=1),void 0===n&&(n=1),void 0===i&&(i=0),void 0===o&&(o=1);var c=new a(e,t,n,i,o,s);return this.bodies.push(c),c},c.prototype.removeBody=function(e){var t=this.bodies.indexOf(e);t<0||(this.bodies.splice(t,1),e.aabb=e.onCollide=null)};var u=i.create(),l=i.create(),f=i.create(),d=i.create(),p=i.create();c.prototype.tick=function(e){e/=1e3;var t=O(0,i.squaredLength(this.gravity));this.bodies.forEach(n=>function(e,t,n,r){if(i.copy(p,t.resting),t.mass<=0)return i.set(t.velocity,0,0,0),i.set(t._forces,0,0,0),void i.set(t._impulses,0,0,0);var a=r||0===t.gravityMultiplier;if(function(e,t,n,r){if(t._sleepFrameCount>0)return!1;if(r)return!0;var a=!1,s=.5*n*n*t.gravityMultiplier;return i.scale(x,e.gravity,s),o(e.testSolid,t.aabb,x,(function(){return a=!0,!0}),!0),a}(e,t,n,a))return;t._sleepFrameCount--,function(e,t){var n=t.aabb,r=Math.floor(n.base[0]),o=Math.floor(n.base[2]),a=Math.floor(n.base[1]),s=Math.floor(n.max[1]);if(!e.testFluid(r,a,o))return t.inFluid=!1,void(t.ratioInFluid=0);var c=1,u=a+1;for(;u<=s&&e.testFluid(r,u,o);)c++,u++;var l=(a+c-n.base[1])/n.vec[1];l>1&&(l=1);var f=n.vec[0]*n.vec[1]*n.vec[2]*l,d=h;i.scale(d,e.gravity,-e.fluidDensity*f),t.applyForce(d),t.inFluid=!0,t.ratioInFluid=l}(e,t),S(t._forces),S(t._impulses),S(t.velocity),S(t.resting),i.scale(u,t._forces,1/t.mass),i.scaleAndAdd(u,u,e.gravity,t.gravityMultiplier),i.scale(l,t._impulses,1/t.mass),i.scaleAndAdd(l,l,u,n),i.add(t.velocity,t.velocity,l),t.friction&&(m(0,t,l),m(1,t,l),m(2,t,l));var s=t.airDrag>=0?t.airDrag:e.airDrag;t.inFluid&&(s=t.fluidDrag>=0?t.fluidDrag:e.fluidDrag,s*=1-(1-t.ratioInFluid)**2);var c=Math.max(1-s*n/t.mass,0);i.scale(t.velocity,t.velocity,c),i.scale(f,t.velocity,n),i.set(t._forces,0,0,0),i.set(t._impulses,0,0,0),t.autoStep&&P(g,t.aabb);v(e,t.aabb,f,t.resting),t.autoStep&&function(e,t,n,r){if(t.resting[1]>=0&&!t.inFluid)return;var a=0!==t.resting[0],s=0!==t.resting[2];if(!a&&!s)return;var c=Math.abs(r[0]/r[2]);if(!a&&c>4)return;if(!s&&c<1/4)return;i.add(w,n.base,r);var u=e.testSolid;o(u,n,r,(function(e,t,n,r){if(1!==t)return!0;r[t]=0}));var l=t.aabb.base[1],f=Math.floor(l+1.001)-l;i.set(_,0,f,0);var d=!1;if(o(u,n,_,(function(e,t,n,r){return d=!0,!0})),d)return;if(i.subtract(k,w,n.base),k[1]=0,v(e,n,k,b),a&&!O(n.base[0],w[0]))return;if(s&&!O(n.base[2],w[2]))return;P(t.aabb,n),t.resting[0]=b[0],t.resting[2]=b[2],t.onStep&&t.onStep()}(e,t,g,f);for(var y=0;y<3;++y)d[y]=0,t.resting[y]&&(p[y]||(d[y]=-t.velocity[y]),t.velocity[y]=0);var C=i.length(d);C>.001&&(i.scale(d,d,t.mass),t.onCollide&&t.onCollide(d),t.restitution>0&&C>e.minBounceImpulse&&(i.scale(d,d,t.restitution),t.applyImpulse(d)));i.squaredLength(t.velocity)>1e-5&&t._markActive()}(this,n,e,t))};var h=i.create();function m(e,t,n){var r=t.resting[e],o=n[e];if(0!==r&&!(r*o<=0)){i.copy(y,t.velocity),y[e]=0;var a=i.length(y);if(!O(a,0)){var s=Math.abs(t.friction*o),c=a>s?(a-s)/a:0;t.velocity[(e+1)%3]*=c,t.velocity[(e+2)%3]*=c}}}var y=i.create();function v(e,t,n,r){return i.set(r,0,0,0),o(e.testSolid,t,n,(function(e,t,n,i){r[t]=n,i[t]=0}))}var g=new r([],[]),b=i.create(),w=i.create(),_=i.create(),k=i.create();var x=i.create();function O(e,t){return Math.abs(e-t)<1e-5}function P(e,t){for(var n=0;n<3;n++)e.base[n]=t.base[n],e.max[n]=t.max[n],e.vec[n]=t.vec[n]}var S=function(){}},function(e,t,n){"use strict";var r=n(211),i=n(77);function o(e,t,n,o,a,s,c){this.aabb=new r(e.base,e.vec),this.mass=t,this.friction=n,this.restitution=o,this.gravityMultiplier=a,this.onCollide=s,this.autoStep=!!c,this.airDrag=-1,this.fluidDrag=-1,this.onStep=null,this.velocity=i.create(),this.resting=[0,0,0],this.inFluid=!1,this._ratioInFluid=0,this._forces=i.create(),this._impulses=i.create(),this._sleepFrameCount=10}e.exports=o,o.prototype.setPosition=function(e){a(e),i.subtract(e,e,this.aabb.base),this.aabb.translate(e),this._markActive()},o.prototype.getPosition=function(){return i.clone(this.aabb.base)},o.prototype.applyForce=function(e){a(e),i.add(this._forces,this._forces,e),this._markActive()},o.prototype.applyImpulse=function(e){a(e),i.add(this._impulses,this._impulses,e),this._markActive()},o.prototype._markActive=function(){this._sleepFrameCount=10},o.prototype.atRestX=function(){return this.resting[0]},o.prototype.atRestY=function(){return this.resting[1]},o.prototype.atRestZ=function(){return this.resting[2]};var a=function(){}},function(e,t,n){"use strict";e.exports=
/*!
 * ent-comp: a light, *fast* Entity Component System in JS
 * @url      github.com/andyhall/ent-comp
 * @author   Andy Hall <andy@fenomas.com>
 * @license  MIT
*/
function e(){var t=this;this.components={},this.comps=this.components;var n=this.components,i=1,o={},a=[],s=[],c=[],u=[],l=[];function f(e){Object.keys(o).forEach(t=>{o[t].hash[e]&&d(e,t)})}function d(e,t){var i=n[t],a=o[t];a&&a.hash[e]&&(i.onRemove&&(i.multi?a.hash[e].forEach(t=>{i.onRemove(e,t)}):i.onRemove(e,a.hash[e])),i.multi&&(a.hash[e].length=0),r.remove(a,e))}function p(e,t,r){var i=n[t],a=o[t].hash[e];if(a){var s=a.indexOf(r);s<0||(i.onRemove&&i.onRemove(e,r),a.splice(s,1),0===a.length&&d(e,t))}}function h(){m||(m=!0,setTimeout((function(){m=!1,y()}),1))}this._storage=o,this._systems=a,this._renderSystems=s,this.createEntity=function(e){var n=i++;return e&&e.length&&e.forEach(e=>t.addComponent(n,e)),n},this.deleteEntity=function(e,n){return n?f(e):(c.push(e),h()),t},this.createComponent=function(e){if(!e)throw"Missing component definition";var t=e.name;if(!t)throw"Component definition must have a name property.";if("string"!=typeof t)throw"Component name must be a string.";if(""===t)throw"Component name must be a non-empty string.";if(o[t])throw`Component ${t} already exists.`;var i={};return i.name=t,i.order=isNaN(e.order)?99:e.order,i.state=e.state||{},i.onAdd=e.onAdd||null,i.onRemove=e.onRemove||null,i.system=e.system||null,i.renderSystem=e.renderSystem||null,i.multi=!!e.multi,n[t]=i,o[t]=r.create(),i.system&&(a.push(t),a.sort((e,t)=>n[e].order-n[t].order)),i.renderSystem&&(s.push(t),s.sort((e,t)=>n[e].order-n[t].order)),t},this.deleteComponent=function(e){var r=o[e];if(!r)throw"Unknown component: "+e;r.list.forEach(n=>{var r=n.__id||n[0].__id;t.removeComponent(r,e,!0)});var i=a.indexOf(e),c=s.indexOf(e);return i>-1&&a.splice(i,1),c>-1&&s.splice(c,1),delete n[e],delete o[e],t},this.addComponent=function(e,t,i){var a=n[t],s=o[t];if(!s)throw`Unknown component: ${t}.`;var c=!1;if(u.forEach(n=>{n.id===e&&n.compName===t&&(c=!0)}),c&&v(),s.hash[e]&&!a.multi)throw`Entity ${e} already has component: ${t}.`;var l=Object.assign({},{__id:e},a.state,i);if(l.__id=e,a.multi){var f=s.hash[e];f||(f=[],r.add(s,e,f)),f.push(l)}else r.add(s,e,l);return a.onAdd&&a.onAdd(e,l),this},this.hasComponent=function(e,t){var n=o[t];if(!n)throw`Unknown component: ${t}.`;return void 0!==n.hash[e]},this.removeComponent=function(e,r,i){var a=n[r],s=o[r];if(!s)throw`Unknown component: ${r}.`;if(!s.hash[e]){if(a.multi)return t;throw`Entity ${e} does not have component: ${r} to remove.`}return i?d(e,r):(u.push({id:e,compName:r}),h()),t},this.getState=function(e,t){var n=o[t];if(!n)throw`Unknown component: ${t}.`;return n.hash[e]},e.prototype.getStatesList=function(e){var t=o[e];if(!t)throw`Unknown component: ${e}.`;return t.list},this.getStateAccessor=function(e){if(!o[e])throw`Unknown component: ${e}.`;var t=o[e].hash;return function(e){return t[e]}},this.getComponentAccessor=function(e){if(!o[e])throw`Unknown component: ${e}.`;var t=o[e].hash;return function(e){return void 0!==t[e]}},this.tick=function(e){return y(),a.forEach(t=>{var r=o[t].list;n[t].system(e,r)}),y(),t},this.render=function(e){return y(),s.forEach(t=>{var r=o[t].list;n[t].renderSystem(e,r)}),y(),t},this.removeMultiComponent=function(e,r,i,a){var s=n[r],c=o[r];if(!c)throw`Unknown component: ${r}.`;if(!s.multi)throw"removeMultiComponent called on non-multi component";var u=c.hash[e];if(!u||!u[i])throw`Multicomponent ${r} instance not found at index ${i}`;var f=u[i];return a?p(e,r,f):l.push({id:e,compName:r,state:f}),t};var m=!1;function y(){v(),function(e){for(;l.length;){var t=l.pop();p(t.id,t.compName,t.state),t.state=null}}(),function(){for(;c.length;){f(c.pop())}}()}function v(){for(;u.length;){var e=u.pop();d(e.id,e.compName)}}};var r=n(312)},function(e,t,n){"use strict";e.exports={create:function(){return{list:[],hash:{},_map:{}}},add:function(e,t,n){e.list.push(n),e.hash[t]=n,e._map[t]=e.list.length-1},remove:function(e,t){var n=e._map[t];if(n===e.list.length-1)e.list.pop();else{var r=e.list.pop();e.list[n]=r;var i=r.__id||r[0].__id;e._map[i]=n}delete e.hash[t],delete e._map[t]}}},function(e,t,n){var r={"./collideEntities.js":314,"./collideTerrain.js":325,"./fadeOnZoom.js":326,"./followsEntity.js":327,"./mesh.js":328,"./movement.js":329,"./physics.js":220,"./position.js":219,"./receivesInputs.js":330,"./shadow.js":331,"./smoothCamera.js":332};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=313},function(e,t,n){"use strict";n.r(t);var r=n(315);t.default=function(e){var t=[];return{name:"collideEntities",order:70,state:{cylinder:!1,collideBits:1,collideMask:1,callback:null},onAdd:null,onRemove:null,system:function(i,o){for(var a=e.ents,s=0;s<o.length;s++){var c=o[s].__id,u=a.getPositionData(c);t[s]=u._extents}t.length=o.length,r(t,(function(r,i){var a=o[r],s=o[i];(function(e,t,r,i){if(e.cylinder)return t.cylinder?function(e,t){var n=(e[3]-e[0])/2,r=(t[3]-t[0])/2,i=e[0]+n-(t[0]+r),o=e[2]+n-(t[2]+r),a=n+r;return i*i+o*o<=a*a}(r,i):n(r,i);if(t.cylinder)return n(i,r);return!0})(a,s,t[r],t[i])&&function(e,t,n){var r=t.__id,i=n.__id;t.collideMask&n.collideBits&&t.callback&&t.callback(i);n.collideMask&t.collideBits&&n.callback&&n.callback(r);e.ents.onPairwiseEntityCollision(r,i)}(e,a,s)}))}};function n(e,t){var n=(e[3]-e[0])/2,r=e[0]+n,o=e[2]+n,a=i(r,t[0],t[3])-r,s=i(o,t[2],t[5])-o;return a*a+s*s<=n*n}function i(e,t,n){return e<t?t:e>n?n:e}}},function(e,t,n){"use strict";e.exports=function(e,t,n){switch(arguments.length){case 1:return f(e);case 2:return"function"==typeof t?u(e,e,t,!0):d(e,t);case 3:return u(e,t,n,!1);default:throw new Error("box-intersect: Invalid arguments")}};var r,i=n(212),o=n(243),a=n(322);function s(e,t){for(var n=0;n<e;++n)if(!(t[n]<=t[n+e]))return!0;return!1}function c(e,t,n,r){for(var i=0,o=0,a=0,c=e.length;a<c;++a){var u=e[a];if(!s(t,u)){for(var l=0;l<2*t;++l)n[i++]=u[l];r[o++]=a}}return o}function u(e,t,n,r){var s=e.length,u=t.length;if(!(s<=0||u<=0)){var l=e[0].length>>>1;if(!(l<=0)){var f,d=i.mallocDouble(2*l*s),p=i.mallocInt32(s);if((s=c(e,l,d,p))>0){if(1===l&&r)o.init(s),f=o.sweepComplete(l,n,0,s,d,p,0,s,d,p);else{var h=i.mallocDouble(2*l*u),m=i.mallocInt32(u);(u=c(t,l,h,m))>0&&(o.init(s+u),f=1===l?o.sweepBipartite(l,n,0,s,d,p,0,u,h,m):a(l,n,r,s,d,p,u,h,m),i.free(h),i.free(m))}i.free(d),i.free(p)}return f}}}function l(e,t){r.push([e,t])}function f(e){return r=[],u(e,e,l,!0),r}function d(e,t){return r=[],u(e,t,l,!1),r}},function(e,t,n){"use strict";e.exports=function(e,t){switch(void 0===t&&(t=0),typeof e){case"number":if(e>0)return function(e,t){var n,r;for(n=new Array(e),r=0;r<e;++r)n[r]=t;return n}(0|e,t);break;case"object":if("number"==typeof e.length)return function e(t,n,r){var i=0|t[r];if(i<=0)return[];var o,a=new Array(i);if(r===t.length-1)for(o=0;o<i;++o)a[o]=n;else for(o=0;o<i;++o)a[o]=e(t,n,r+1);return a}(e,t,0)}return[]}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(318),i=n(319),o=n(320);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=d(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(t,n),i=(e=s(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|p(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):d(e,t);if("Buffer"===t.type&&o(t.data))return d(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(l(t),e=s(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|p(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function h(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(e).length;default:if(r)return F(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return E(this,t,n);case"utf8":case"utf-8":return S(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return P(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:g(e,t,n,r,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):g(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,r,i){var o,a=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=n;o<s;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+c>s&&(n=s-c),o=n;o>=0;o--){for(var f=!0,d=0;d<c;d++)if(u(e,o+d)!==u(t,d)){f=!1;break}if(f)return o}return-1}function b(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function w(e,t,n,r){return V(F(t,e.length-n),e,n,r)}function _(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function k(e,t,n,r){return _(e,t,n,r)}function x(e,t,n,r){return V(U(t),e,n,r)}function O(e,t,n,r){return V(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function P(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function S(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,c,u=e[i],l=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f<=n)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(c=(15&u)<<12|(63&o)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return f(null,e)},c.allocUnsafeSlow=function(e){return f(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},c.byteLength=h,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(r,i),l=e.slice(t,n),f=0;f<s;++f)if(u[f]!==l[f]){o=u[f],a=l[f];break}return o<a?-1:a<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return _(this,e,t,n);case"latin1":case"binary":return k(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function T(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function E(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=N(e[o]);return i}function j(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function I(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function R(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function A(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,o){return o||A(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function L(e,t,n,r,o){return o||A(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):R(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):R(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=c.isBuffer(e)?e:F(new c(e,r).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var z=/[^+\/0-9A-Za-z-_]/g;function N(e){return e<16?"0"+e.toString(16):e.toString(16)}function F(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function U(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(154))},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),a=r[0],s=r[1],c=new o(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),l=0,f=s>0?a-4:a;for(n=0;n<f;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(l(e,a,a+16383>s?s:a+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,u=c>>1,l=-7,f=n?i-1:0,d=n?-1:1,p=e[t+f];for(f+=d,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=d,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+f],f+=d,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=u}return(p?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,f=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+f>=1?d/c:d*Math.pow(2,1-f))*c>=2&&(a++,c/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*c-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+p]=255&s,p+=h,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[n+p]=255&a,p+=h,a/=256,u-=8);e[n+p-h]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";e.exports=function(e,t){t<=128?r(0,t-1,e):function e(t,n,l){var f=(n-t+1)/6|0,d=t+f,p=n-f,h=t+n>>1,m=h-f,y=h+f,v=d,g=m,b=h,w=y,_=p,k=t+1,x=n-1,O=0;c(v,g,l)&&(O=v,v=g,g=O);c(w,_,l)&&(O=w,w=_,_=O);c(v,b,l)&&(O=v,v=b,b=O);c(g,b,l)&&(O=g,g=b,b=O);c(v,w,l)&&(O=v,v=w,w=O);c(b,w,l)&&(O=b,b=w,w=O);c(g,_,l)&&(O=g,g=_,_=O);c(g,b,l)&&(O=g,g=b,b=O);c(w,_,l)&&(O=w,w=_,_=O);for(var P=l[2*g],S=l[2*g+1],C=l[2*w],T=l[2*w+1],E=2*v,j=2*b,M=2*_,D=2*d,I=2*h,R=2*p,A=0;A<2;++A){var B=l[E+A],L=l[j+A],z=l[M+A];l[D+A]=B,l[I+A]=L,l[R+A]=z}o(m,t,l),o(y,n,l);for(var N=k;N<=x;++N)if(u(N,P,S,l))N!==k&&i(N,k,l),++k;else if(!u(N,C,T,l))for(;;){if(u(x,C,T,l)){u(x,P,S,l)?(a(N,k,x,l),++k,--x):(i(N,x,l),--x);break}if(--x<N)break}s(t,k-1,P,S,l),s(n,x+1,C,T,l),k-2-t<=32?r(t,k-2,l):e(t,k-2,l);n-(x+2)<=32?r(x+2,n,l):e(x+2,n,l);x-k<=32?r(k,x,l):e(k,x,l)}(0,t-1,e)};function r(e,t,n){for(var r=2*(e+1),i=e+1;i<=t;++i){for(var o=n[r++],a=n[r++],s=i,c=r-2;s-- >e;){var u=n[c-2],l=n[c-1];if(u<o)break;if(u===o&&l<a)break;n[c]=u,n[c+1]=l,c-=2}n[c]=o,n[c+1]=a}}function i(e,t,n){t*=2;var r=n[e*=2],i=n[e+1];n[e]=n[t],n[e+1]=n[t+1],n[t]=r,n[t+1]=i}function o(e,t,n){t*=2,n[e*=2]=n[t],n[e+1]=n[t+1]}function a(e,t,n,r){t*=2,n*=2;var i=r[e*=2],o=r[e+1];r[e]=r[t],r[e+1]=r[t+1],r[t]=r[n],r[t+1]=r[n+1],r[n]=i,r[n+1]=o}function s(e,t,n,r,i){t*=2,i[e*=2]=i[t],i[t]=n,i[e+1]=i[t+1],i[t+1]=r}function c(e,t,n){t*=2;var r=n[e*=2],i=n[t];return!(r<i)&&(r!==i||n[e+1]>n[t+1])}function u(e,t,n,r){var i=r[e*=2];return i<t||i===t&&r[e+1]<n}},function(e,t,n){"use strict";e.exports=function(e,t,n,o,l,k,x,O,P){!function(e,t){var n=8*i.log2(t+1)*(e+1)|0,o=i.nextPow2(6*n);v.length<o&&(r.free(v),v=r.mallocInt32(o));var a=i.nextPow2(2*n);g.length<a&&(r.free(g),g=r.mallocDouble(a))}(e,o+x);var S,C=0,T=2*e;b(C++,0,0,o,0,x,n?16:0,-1/0,1/0),n||b(C++,0,0,x,0,o,1,-1/0,1/0);for(;C>0;){var E=6*(C-=1),j=v[E],M=v[E+1],D=v[E+2],I=v[E+3],R=v[E+4],A=v[E+5],B=2*C,L=g[B],z=g[B+1],N=1&A,F=!!(16&A),U=l,V=k,G=O,W=P;if(N&&(U=O,V=P,G=l,W=k),!(2&A&&(D=p(e,j,M,D,U,V,z),M>=D)||4&A&&(M=h(e,j,M,D,U,V,L))>=D)){var q=D-M,K=R-I;if(F){if(e*q*(q+K)<1<<22){if(void 0!==(S=c.scanComplete(e,j,t,M,D,U,V,I,R,G,W)))return S;continue}}else{if(e*Math.min(q,K)<128){if(void 0!==(S=a(e,j,t,N,M,D,U,V,I,R,G,W)))return S;continue}if(e*q*K<1<<22){if(void 0!==(S=c.scanBipartite(e,j,t,N,M,D,U,V,I,R,G,W)))return S;continue}}var Y=f(e,j,M,D,U,V,L,z);if(M<Y)if(e*(Y-M)<128){if(void 0!==(S=s(e,j+1,t,M,Y,U,V,I,R,G,W)))return S}else if(j===e-2){if(void 0!==(S=N?c.sweepBipartite(e,t,I,R,G,W,M,Y,U,V):c.sweepBipartite(e,t,M,Y,U,V,I,R,G,W)))return S}else b(C++,j+1,M,Y,I,R,N,-1/0,1/0),b(C++,j+1,I,R,M,Y,1^N,-1/0,1/0);if(Y<D){var J=u(e,j,I,R,G,W),H=G[T*J+j],X=d(e,j,J,R,G,W,H);if(X<R&&b(C++,j,Y,D,X,R,(4|N)+(F?16:0),H,z),I<J&&b(C++,j,Y,D,I,J,(2|N)+(F?16:0),L,H),J+1===X){if(void 0!==(S=F?_(e,j,t,Y,D,U,V,J,G,W[J]):w(e,j,t,N,Y,D,U,V,J,G,W[J])))return S}else if(J<X){var $;if(F){if($=m(e,j,Y,D,U,V,H),Y<$){var Z=d(e,j,Y,$,U,V,H);if(j===e-2){if(Y<Z&&void 0!==(S=c.sweepComplete(e,t,Y,Z,U,V,J,X,G,W)))return S;if(Z<$&&void 0!==(S=c.sweepBipartite(e,t,Z,$,U,V,J,X,G,W)))return S}else Y<Z&&b(C++,j+1,Y,Z,J,X,16,-1/0,1/0),Z<$&&(b(C++,j+1,Z,$,J,X,0,-1/0,1/0),b(C++,j+1,J,X,Z,$,1,-1/0,1/0))}}else $=N?y(e,j,Y,D,U,V,H):m(e,j,Y,D,U,V,H),Y<$&&(j===e-2?S=N?c.sweepBipartite(e,t,J,X,G,W,Y,$,U,V):c.sweepBipartite(e,t,Y,$,U,V,J,X,G,W):(b(C++,j+1,Y,$,J,X,N,-1/0,1/0),b(C++,j+1,J,X,Y,$,1^N,-1/0,1/0)))}}}}};var r=n(212),i=n(213),o=n(323),a=o.partial,s=o.full,c=n(243),u=n(324),l=n(244),f=l("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),d=l("lo===p0",["p0"]),p=l("lo<p0",["p0"]),h=l("hi<=p0",["p0"]),m=l("lo<=p0&&p0<=hi",["p0"]),y=l("lo<p0&&p0<=hi",["p0"]),v=r.mallocInt32(1024),g=r.mallocDouble(1024);function b(e,t,n,r,i,o,a,s,c){var u=6*e;v[u]=t,v[u+1]=n,v[u+2]=r,v[u+3]=i,v[u+4]=o,v[u+5]=a;var l=2*e;g[l]=s,g[l+1]=c}function w(e,t,n,r,i,o,a,s,c,u,l){var f=2*e,d=c*f,p=u[d+t];e:for(var h=i,m=i*f;h<o;++h,m+=f){var y=a[m+t],v=a[m+t+e];if(!(p<y||v<p)&&(!r||p!==y)){for(var g,b=s[h],w=t+1;w<e;++w){y=a[m+w],v=a[m+w+e];var _=u[d+w],k=u[d+w+e];if(v<_||k<y)continue e}if(void 0!==(g=r?n(l,b):n(b,l)))return g}}}function _(e,t,n,r,i,o,a,s,c,u){var l=2*e,f=s*l,d=c[f+t];e:for(var p=r,h=r*l;p<i;++p,h+=l){var m=a[p];if(m!==u){var y=o[h+t],v=o[h+t+e];if(!(d<y||v<d)){for(var g=t+1;g<e;++g){y=o[h+g],v=o[h+g+e];var b=c[f+g],w=c[f+g+e];if(v<b||w<y)continue e}var _=n(m,u);if(void 0!==_)return _}}}}},function(e,t,n){"use strict";var r=["d","ax","vv","rs","re","rb","ri","bs","be","bb","bi"];function i(e){var t="bruteForce"+(e?"Full":"Partial"),n=[],i=r.slice();e||i.splice(3,0,"fp");var o=["function "+t+"("+i.join()+"){"];function a(t,i){var a=function(e,t,n){var i="bruteForce"+(e?"Red":"Blue")+(t?"Flip":"")+(n?"Full":""),o=["function ",i,"(",r.join(),"){","var ","es","=2*","d",";"],a="for(var i=rs,rp=es*rs;i<re;++i,rp+=es){var x0=rb[ax+rp],x1=rb[ax+rp+d],xi=ri[i];",s="for(var j=bs,bp=es*bs;j<be;++j,bp+=es){var y0=bb[ax+bp],"+(n?"y1=bb[ax+bp+d],":"")+"yi=bi[j];";return e?o.push(a,"Q",":",s):o.push(s,"Q",":",a),n?o.push("if(y1<x0||x1<y0)continue;"):t?o.push("if(y0<=x0||x1<y0)continue;"):o.push("if(y0<x0||x1<y0)continue;"),o.push("for(var k=ax+1;k<d;++k){var r0=rb[k+rp],r1=rb[k+d+rp],b0=bb[k+bp],b1=bb[k+d+bp];if(r1<b0||b1<r0)continue Q;}var rv=vv("),t?o.push("yi,xi"):o.push("xi,yi"),o.push(");if(rv!==void 0)return rv;}}}"),{name:i,code:o.join("")}}(t,i,e);n.push(a.code),o.push("return "+a.name+"("+r.join()+");")}o.push("if(re-rs>be-bs){"),e?(a(!0,!1),o.push("}else{"),a(!1,!1)):(o.push("if(fp){"),a(!0,!0),o.push("}else{"),a(!0,!1),o.push("}}else{if(fp){"),a(!1,!0),o.push("}else{"),a(!1,!1),o.push("}")),o.push("}}return "+t);var s=n.join("")+o.join("");return new Function(s)()}t.partial=i(!1),t.full=i(!0)},function(e,t,n){"use strict";e.exports=function(e,t,n,o,a,s){if(o<=n+1)return n;var c=n,u=o,l=o+n>>>1,f=2*e,d=l,p=a[f*l+t];for(;c<u;){if(u-c<8){i(e,t,c,u,a,s),p=a[f*l+t];break}var h=u-c,m=Math.random()*h+c|0,y=a[f*m+t],v=Math.random()*h+c|0,g=a[f*v+t],b=Math.random()*h+c|0,w=a[f*b+t];y<=g?w>=g?(d=v,p=g):y>=w?(d=m,p=y):(d=b,p=w):g>=w?(d=v,p=g):w>=y?(d=m,p=y):(d=b,p=w);for(var _=f*(u-1),k=f*d,x=0;x<f;++x,++_,++k){var O=a[_];a[_]=a[k],a[k]=O}var P=s[u-1];s[u-1]=s[d],s[d]=P,d=r(e,t,c,u-1,a,s,p);for(_=f*(u-1),k=f*d,x=0;x<f;++x,++_,++k){O=a[_];a[_]=a[k],a[k]=O}P=s[u-1];if(s[u-1]=s[d],s[d]=P,l<d){for(u=d-1;c<u&&a[f*(u-1)+t]===p;)u-=1;u+=1}else{if(!(d<l))break;for(c=d+1;c<u&&a[f*c+t]===p;)c+=1}}return r(e,t,n,l,a,s,a[f*l+t])};var r=n(244)("lo<p0",["p0"]);function i(e,t,n,r,i,o){for(var a=2*e,s=a*(n+1)+t,c=n+1;c<r;++c,s+=a)for(var u=i[s],l=c,f=a*(c-1);l>n&&i[f+t]>u;--l,f-=a){for(var d=f,p=f+a,h=0;h<a;++h,++d,++p){var m=i[d];i[d]=i[p],i[p]=m}var y=o[l];o[l]=o[l-1],o[l-1]=y}}},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"collideTerrain",order:0,state:{callback:null},onAdd:function(t,n){var r=e.entities;r.hasPhysics(t)&&(r.getPhysicsBody(t).onCollide=function(n){var r=e.ents.getCollideTerrain(t).callback;r&&r(n,t)})},onRemove:function(t,n){var r=e.entities;r.hasPhysics(t)&&(r.getPhysicsBody(t).onCollide=null)}}}},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"fadeOnZoom",order:99,state:{cutoff:1.5,_showing:!0},onAdd:null,onRemove:null,system:function(t,n){var r=e.camera.currentZoom,i=e.entities;n.forEach(e=>{!function(e,t,n,r){if(!r.hasMesh(t))return;if(e._showing&&n<e.cutoff||!e._showing&&n>e.cutoff){r.getMeshData(t).mesh.visibility=e._showing=n>e.cutoff}}(e,e.__id,r,i)})}}}},function(e,t,n){"use strict";n.r(t);var r=n(77);t.default=function(e){return{name:"followsEntity",order:50,state:{entity:0,offset:null,onTargetMissing:null},onAdd:function(e,i){var o=r.create();i.offset=i.offset?r.copy(o,i.offset):o,t(i),n(i)},onRemove:null,system:function(e,n){n.forEach(e=>t(e))},renderSystem:function(e,t){t.forEach(e=>n(e))}};function t(t){var n=t.__id,i=e.ents.getPositionData(n),o=e.ents.getPositionData(t.entity);o?r.add(i._localPosition,o._localPosition,t.offset):(t.onTargetMissing&&t.onTargetMissing(n),e.ents.removeComponent(n,e.ents.names.followsEntity))}function n(t){var n=t.__id,i=e.ents.getPositionData(n),o=e.ents.getPositionData(t.entity);o&&r.add(i._renderPosition,o._renderPosition,t.offset)}}},function(e,t,n){"use strict";n.r(t);var r=n(77);t.default=function(e){return{name:"mesh",order:100,state:{mesh:null,offset:null},onAdd:function(t,n){var i=e.ents.getPositionData(t);if(!n.mesh)throw new Error("Mesh component added without a mesh - probably a bug!");e.rendering.addMeshToScene(n.mesh,!1,i.position),n.offset||(n.offset=new r.create);var o=i._renderPosition;n.mesh.position.copyFromFloats(o[0]+n.offset[0],o[1]+n.offset[1],o[2]+n.offset[2])},onRemove:function(e,t){t.mesh.dispose()},renderSystem:function(t,n){n.forEach(t=>{var n=t.__id,r=e.ents.getPositionData(n)._renderPosition;t.mesh.position.copyFromFloats(r[0]+t.offset[0],r[1]+t.offset[1],r[2]+t.offset[2])})}}}},function(e,t,n){"use strict";n.r(t);var r=n(77);t.default=function(e){return{name:"movement",order:30,state:{heading:0,running:!1,jumping:!1,sprint:!1,crouch:!1,xMult:1,yMult:1,maxSpeed:10,moveForce:30,responsiveness:15,runningFriction:0,standingFriction:2,sprintMoveMult:1.2,crouchMoveMult:.8,airMoveMult:.5,jumpImpulse:10,jumpForce:12,jumpTime:500,airJumps:1,_jumpCount:0,_isJumping:0,_currjumptime:0},onAdd:null,onRemove:null,system:function(t,n){var s=e.entities;n.forEach(e=>{var n=s.getPhysicsBody(e.__id);!function(e,t,n){var s=n.atRestY()<0,c=s||t._jumpCount<t.airJumps;s&&(t._isJumping=!1,t._jumpCount=0);if(t.jumping)if(t._isJumping){if(t._currjumptime>0){var u=t.jumpForce;t._currjumptime<e&&(u*=t._currjumptime/e),n.applyForce([0,u,0]),t._currjumptime-=e}}else c&&(t._isJumping=!0,s||t._jumpCount++,t._currjumptime=t.jumpTime,n.applyImpulse([0,t.jumpImpulse,0]),!s&&n.velocity[1]<0&&(n.velocity[1]=0));else t._isJumping=!1;var l=i,f=o;if(t.running){var d=t.maxSpeed;t.sprint&&(d*=t.sprintMoveMult),t.crouch&&(d*=t.crouchMoveMult),r.set(l,0,0,d),r.rotateY(l,l,a,t.heading),r.subtract(f,l,n.velocity),f[1]=0;var p=r.length(f);if(r.normalize(f,f),p>0){var h=t.moveForce;s||(h*=t.airMoveMult);var m=t.responsiveness*p;h>m&&(h=m),r.scale(f,f,h),n.applyForce(f)}n.friction=t.runningFriction}else n.friction=t.standingFriction}(t,e,n)})}}};var i=r.create(),o=r.create(),a=r.create()},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"receivesInputs",order:20,state:{ignore:!1,x:1,y:1},onAdd:null,onRemove:null,system:function(t,n){var r=e.entities,i=e.inputs.state,o=e.camera.heading;n.forEach(e=>{!function(e,t,n,r,i,o){e.jumping=!r&&!!t.jump;e.xMulp=i,e.yMulp=o;var a=t.forward?t.backward?0:1:t.backward?-1:0,s=t.right?t.left?0:1:t.left?-1:0;0==(a|s)||r?e.running=!1:(e.running=!0,a?(-1==a&&(n+=Math.PI),s&&(n+=Math.PI/4*a*s)):n+=s*Math.PI/2,e.heading=n)}(r.getMovement(e.__id),i,o,e.ignore,e.x,e.y)})}}}},function(e,t,n){"use strict";n.r(t);var r=n(6),i=n(22),o=n(77);t.default=function(e,t){var n=t,c=e.rendering.getScene(),u=r.a.CreateDisc("shadow",.75,30,c);return u.rotation.x=Math.PI/2,u.material=e.rendering.makeStandardMaterial("shadowMat"),u.material.diffuseColor=i.e.Black(),u.material.ambientColor=i.e.Black(),u.material.alpha=.5,u.setEnabled(!1),c.removeMesh(u),{name:"shadow",order:80,state:{size:.5,_mesh:null},onAdd:function(t,n){var r=u.createInstance("shadow_instance");e.rendering.addMeshToScene(r),r.setEnabled(!1),n._mesh=r},onRemove:function(e,t){t._mesh.dispose()},system:function(t,r){var i=e.camera._localGetPosition(),c=n;r.forEach(t=>{var n=e.ents.getPositionData(t.__id),r=e.ents.getPhysics(t.__id);!function(e,t,n,r,i,c,u){var l;if(n&&n.body.resting[1]<0)l=t._localPosition[1];else{var f=e._localPick(t._localPosition,s,c);if(!f)return void r.setEnabled(!1);l=f.position[1]-e.worldOriginOffset[1]}l=Math.round(l),o.copy(a,t._localPosition),a[1]=l;var d=.01+o.squaredDistance(u,a)/1600*.1;d>.1&&(d=.1);r.position.y=l+d;var p=t._localPosition[1]-l,h=.7*i*(1-p/c);r.scaling.copyFromFloats(h,h,h),r.setEnabled(!0)}(e,n,r,t._mesh,t.size,c,i)})},renderSystem:function(t,n){n.forEach(t=>{var n=e.ents.getPositionData(t.__id)._renderPosition,r=t._mesh.position;r.x=n[0],r.z=n[2]})}}};var a=o.fromValues(0,0,0),s=o.fromValues(0,-1,0)},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"smooth-camera",order:99,state:{time:100.1},onAdd:null,onRemove:null,system:function(t,n){n.forEach(n=>{n.time-=t,n.time<0&&e.ents.removeComponent(n.__id,"smooth-camera")})}}}},function(e){e.exports=JSON.parse('{"_from":"github:VoxelSrv/noa-engine","_id":"noa-engine@0.29.0","_inBundle":false,"_integrity":"","_location":"/noa-engine","_phantomChildren":{},"_requested":{"type":"git","raw":"github:VoxelSrv/noa-engine","rawSpec":"github:VoxelSrv/noa-engine","saveSpec":"github:VoxelSrv/noa-engine","fetchSpec":null,"gitCommittish":null},"_requiredBy":["#USER","/"],"_resolved":"github:VoxelSrv/noa-engine#2f4ce00412288cd5eb080955be38da11f04d41c5","_spec":"github:VoxelSrv/noa-engine","_where":"/home/patbox/Pulpit/voxelsrv/client","author":{"name":"Andy Hall"},"bugs":{"url":"https://github.com/andyhall/noa/issues"},"bundleDependencies":false,"dependencies":{"@babylonjs/core":"^4.2.0-beta.3","aabb-3d":"github:andyhall/aabb-3d","box-intersect":"^1.0.2","ent-comp":"^0.9.1","fast-voxel-raycast":"^0.1.1","game-inputs":"^0.4.0","game-shell":"github:andyhall/game-shell","gl-vec3":"^1.1.3","ndarray":"^1.0.19","voxel-aabb-sweep":"^0.5.0","voxel-physics-engine":"^0.10.0"},"deprecated":false,"description":"Experimental voxel game engine","devDependencies":{"jsdoc-to-markdown":"^5.0.3","typescript":"^3.9.7"},"files":["/src","/types"],"homepage":"https://github.com/andyhall/noa#readme","keywords":["voxel","game","engine"],"license":"MIT","main":"src/index.js","name":"noa-engine","repository":{"type":"git","url":"git+https://github.com/andyhall/noa.git"},"scripts":{"doc":"jsdoc2md -f src/* src/**/* -g table -p list --partial doc-templates/* > doc/API.md"},"typings":"types/index.d.ts","version":"0.29.0"}')},function(e,t,n){"use strict";n.r(t);var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function i(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var o=Object.keys,a=Array.isArray,s="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function c(e,t){return"object"!=typeof t||o(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||s.Promise||(s.Promise=Promise);var u=Object.getPrototypeOf,l={}.hasOwnProperty;function f(e,t){return l.call(e,t)}function d(e,t){"function"==typeof t&&(t=t(u(e))),o(t).forEach((function(n){h(e,n,t[n])}))}var p=Object.defineProperty;function h(e,t,n,r){p(e,t,c(n&&f(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function m(e){return{from:function(t){return e.prototype=Object.create(t.prototype),h(e.prototype,"constructor",e),{extend:d.bind(null,e.prototype)}}}}var y=Object.getOwnPropertyDescriptor;var v=[].slice;function g(e,t,n){return v.call(e,t,n)}function b(e,t){return t(e)}function w(e){if(!e)throw new Error("Assertion Failed")}function _(e){s.setImmediate?setImmediate(e):setTimeout(e,0)}function k(e,t){return e.reduce((function(e,n,r){var i=t(n,r);return i&&(e[i[0]]=i[1]),e}),{})}function x(e,t){if(f(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=x(e,t[r]);n.push(o)}return n}var a=t.indexOf(".");if(-1!==a){var s=e[t.substr(0,a)];return void 0===s?void 0:x(s,t.substr(a+1))}}function O(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){w("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)O(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var s=t.substr(0,o),c=t.substr(o+1);if(""===c)void 0===n?a(e)&&!isNaN(parseInt(s))?e.splice(s,1):delete e[s]:e[s]=n;else{var u=e[s];u||(u=e[s]={}),O(u,c,n)}}else void 0===n?a(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function P(e){var t={};for(var n in e)f(e,n)&&(t[n]=e[n]);return t}var S=[].concat;function C(e){return S.apply([],e)}var T="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(C([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return s[e]})),E=T.map((function(e){return s[e]})),j=k(T,(function(e){return[e,!0]}));function M(e){if(!e||"object"!=typeof e)return e;var t;if(a(e)){t=[];for(var n=0,r=e.length;n<r;++n)t.push(M(e[n]))}else if(E.indexOf(e.constructor)>=0)t=e;else for(var i in t=e.constructor?Object.create(e.constructor.prototype):{},e)f(e,i)&&(t[i]=M(e[i]));return t}var D={}.toString;function I(e){return D.call(e).slice(8,-1)}var R=function(e,t){return"Array"===t?""+e.map((function(e){return R(e,I(e))})):"ArrayBuffer"===t?""+new Uint8Array(e):"Date"===t?e.getTime():ArrayBuffer.isView(e)?""+new Uint8Array(e.buffer):e};function A(e,t,n,r){return n=n||{},r=r||"",o(e).forEach((function(i){if(f(t,i)){var o=e[i],a=t[i];if("object"==typeof o&&"object"==typeof a&&o&&a){var s=I(o),c=I(a);s===c?j[s]?R(o,s)!==R(a,c)&&(n[r+i]=t[i]):A(o,a,n,r+i+"."):n[r+i]=t[i]}else o!==a&&(n[r+i]=t[i])}else n[r+i]=void 0})),o(t).forEach((function(i){f(e,i)||(n[r+i]=t[i])})),n}var B="undefined"!=typeof Symbol&&Symbol.iterator,L=B?function(e){var t;return null!=e&&(t=e[B])&&t.apply(e)}:function(){return null},z={};function N(e){var t,n,r,i;if(1===arguments.length){if(a(e))return e.slice();if(this===z&&"string"==typeof e)return[e];if(i=L(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var F="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},U="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function V(e,t){U=e,G=t}var G=function(){return!0},W=!new Error("").stack;function q(){if(W)try{throw new Error}catch(e){return e}return new Error}function K(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(G).map((function(e){return"\n"+e})).join("")):""}var Y=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],J=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Y),H={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function X(e,t){this._e=q(),this.name=e,this.message=t}function $(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function Z(e,t,n,r){this._e=q(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=$(e,t)}function Q(e,t){this._e=q(),this.name="BulkError",this.failures=t,this.message=$(e,t)}m(X).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+K(this._e,2))}},toString:function(){return this.name+": "+this.message}}),m(Z).from(X),m(Q).from(X);var ee=J.reduce((function(e,t){return e[t]=t+"Error",e}),{}),te=X,ne=J.reduce((function(e,t){var n=t+"Error";function r(e,r){this._e=q(),this.name=n,e?"string"==typeof e?(this.message=e+(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=H[t]||n,this.inner=null)}return m(r).from(te),e[t]=r,e}),{});ne.Syntax=SyntaxError,ne.Type=TypeError,ne.Range=RangeError;var re=Y.reduce((function(e,t){return e[t+"Error"]=ne[t],e}),{});var ie=J.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=ne[t]),e}),{});function oe(){}function ae(e){return e}function se(e,t){return null==e||e===ae?t:function(n){return t(e(n))}}function ce(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ue(e,t){return e===oe?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ce(r,this.onsuccess):r),i&&(this.onerror=this.onerror?ce(i,this.onerror):i),void 0!==o?o:n}}function le(e,t){return e===oe?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ce(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ce(r,this.onerror):r)}}function fe(e,t){return e===oe?t:function(n){var r=e.apply(this,arguments);c(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ce(i,this.onsuccess):i),o&&(this.onerror=this.onerror?ce(o,this.onerror):o),void 0===r?void 0===a?void 0:a:c(r,a)}}function de(e,t){return e===oe?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function pe(e,t){return e===oe?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}ie.ModifyError=Z,ie.DexieError=X,ie.BulkError=Q;var he={},me="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,e.__proto__,e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,t.__proto__,e]}(),ye=me[0],ve=me[1],ge=me[2],be=ve&&ve.then,we=ye&&ye.constructor,_e=!!ge,ke=!1,xe=ge?function(){ge.then(qe)}:s.setImmediate?setImmediate.bind(null,qe):s.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){qe(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(qe,0)},Oe=function(e,t){Ie.push([e,t]),Se&&(xe(),Se=!1)},Pe=!0,Se=!0,Ce=[],Te=[],Ee=null,je=ae,Me={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ht,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(e){try{ht(e[0],e[1])}catch(e){}}))}},De=Me,Ie=[],Re=0,Ae=[];function Be(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=oe,this._lib=!1;var t=this._PSD=De;if(U&&(this._stackHolder=q(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==he)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Fe(this,this._value))}this._state=null,this._value=null,++t.ref,Ne(this,e)}var Le={get:function(){var e=De,t=tt;function n(n,r){var i=this,o=!e.global&&(e!==De||t!==tt);o&&ot();var a=new Be((function(t,a){Ve(i,new ze(dt(n,e,o),dt(r,e,o),t,a,e))}));return U&&We(a,this),a}return n.prototype=he,n},set:function(e){h(this,"then",e&&e.prototype===he?Le:{get:function(){return e},set:Le.set})}};function ze(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function Ne(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Ke();t&&"function"==typeof t.then?Ne(e,(function(e,n){t instanceof Be?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,Ue(e)),n&&Ye()}}),Fe.bind(null,e))}catch(t){Fe(e,t)}}function Fe(e,t){if(Te.push(t),null===e._state){var n=e._lib&&Ke();t=je(t),e._state=!1,e._value=t,U&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}((function(){var n=function e(t,n){var r;return y(t,n)||(r=u(t))&&e(r,n)}(t,"stack");t._promise=e,h(t,"stack",{get:function(){return ke?n&&(n.get?n.get.apply(t):n.value):e.stack}})})),function(e){Ce.some((function(t){return t._value===e._value}))||Ce.push(e)}(e),Ue(e),n&&Ye()}}function Ue(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ve(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===Re&&(++Re,Oe((function(){0==--Re&&Je()}),[]))}function Ve(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Re,Oe(Ge,[n,e,t])}else e._listeners.push(t)}function Ge(e,t,n){try{Ee=t;var r,i=t._value;t._state?r=e(i):(Te.length&&(Te=[]),r=e(i),-1===Te.indexOf(i)&&function(e){var t=Ce.length;for(;t;)if(Ce[--t]._value===e._value)return void Ce.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{Ee=null,0==--Re&&Je(),--n.psd.ref||n.psd.finalize()}}function We(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function qe(){Ke()&&Ye()}function Ke(){var e=Pe;return Pe=!1,Se=!1,e}function Ye(){var e,t,n;do{for(;Ie.length>0;)for(e=Ie,Ie=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Ie.length>0);Pe=!0,Se=!0}function Je(){var e=Ce;Ce=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=Ae.slice(0),n=t.length;n;)t[--n]()}function He(e){return new Be(he,!1,e)}function Xe(e,t){var n=De;return function(){var r=Ke(),i=De;try{return ut(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{ut(i,!1),r&&Ye()}}}d(Be.prototype,{then:Le,_then:function(e,t){Ve(this,new ze(null,null,e,t,De))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return e instanceof t?n(e):He(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):He(e)}))},finally:function(e){return this.then((function(t){return e(),t}),(function(t){return e(),He(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{ke=!0;var e=function e(t,n,r){if(n.length===r)return n;var i="";if(!1===t._state){var o,a,s=t._value;null!=s?(o=s.name||"Error",a=s.message||s,i=K(s,0)):(o=s,a=""),n.push(o+(a?": "+a:"")+i)}U&&((i=K(t._stackHolder,2))&&-1===n.indexOf(i)&&n.push(i),t._prev&&e(t._prev,n,r));return n}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{ke=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Be((function(r,i){var o=setTimeout((function(){return i(new ne.Timeout(t))}),e);n.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&h(Be.prototype,Symbol.toStringTag,"Dexie.Promise"),Me.env=lt(),d(Be,{all:function(){var e=N.apply(null,arguments).map(at);return new Be((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(i,o){return Be.resolve(i).then((function(n){e[o]=n,--r||t(e)}),n)}))}))},resolve:function(e){if(e instanceof Be)return e;if(e&&"function"==typeof e.then)return new Be((function(t,n){e.then(t,n)}));var t=new Be(he,!0,e);return We(t,Ee),t},reject:He,race:function(){var e=N.apply(null,arguments).map(at);return new Be((function(t,n){e.map((function(e){return Be.resolve(e).then(t,n)}))}))},PSD:{get:function(){return De},set:function(e){return De=e}},newPSD:rt,usePSD:ft,scheduler:{get:function(){return Oe},set:function(e){Oe=e}},rejectionMapper:{get:function(){return je},set:function(e){je=e}},follow:function(e,t){return new Be((function(n,r){return rt((function(t,n){var r=De;r.unhandleds=[],r.onunhandled=n,r.finalize=ce((function(){var e=this;!function(e){Ae.push((function t(){e(),Ae.splice(Ae.indexOf(t),1)})),++Re,Oe((function(){0==--Re&&Je()}),[])}((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}}),we&&(we.allSettled&&h(Be,"allSettled",(function(){var e=N.apply(null,arguments).map(at);return new Be((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,i){return Be.resolve(e).then((function(e){return r[i]={status:"fulfilled",value:e}}),(function(e){return r[i]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),we.any&&"undefined"!=typeof AggregateError&&h(Be,"any",(function(){var e=N.apply(null,arguments).map(at);return new Be((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach((function(e,o){return Be.resolve(e).then((function(e){return t(e)}),(function(e){i[o]=e,--r||n(new AggregateError(i))}))}))}))})));var $e={awaits:0,echoes:0,id:0},Ze=0,Qe=[],et=0,tt=0,nt=0;function rt(e,t,n,r){var i=De,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++nt;var a=Me.env;o.env=_e?{Promise:Be,PromiseProp:{value:Be,configurable:!0,writable:!0},all:Be.all,race:Be.race,allSettled:Be.allSettled,any:Be.any,resolve:Be.resolve,reject:Be.reject,nthen:pt(a.nthen,o),gthen:pt(a.gthen,o)}:{},t&&c(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var s=ft(o,e,n,r);return 0===o.ref&&o.finalize(),s}function it(){return $e.id||($e.id=++Ze),++$e.awaits,$e.echoes+=100,$e.id}function ot(e){!$e.awaits||e&&e!==$e.id||(0==--$e.awaits&&($e.id=0),$e.echoes=100*$e.awaits)}function at(e){return $e.echoes&&e&&e.constructor===we?(it(),e.then((function(e){return ot(),e}),(function(e){return ot(),mt(e)}))):e}function st(e){++tt,$e.echoes&&0!=--$e.echoes||($e.echoes=$e.id=0),Qe.push(De),ut(e,!0)}function ct(){var e=Qe[Qe.length-1];Qe.pop(),ut(e,!1)}function ut(e,t){var n,r=De;if((t?!$e.echoes||et++&&e===De:!et||--et&&e===De)||(n=t?st.bind(null,e):ct,be.call(ye,n)),e!==De&&(De=e,r===Me&&(Me.env=lt()),_e)){var i=Me.env.Promise,o=e.env;ve.then=o.nthen,i.prototype.then=o.gthen,(r.global||e.global)&&(Object.defineProperty(s,"Promise",o.PromiseProp),i.all=o.all,i.race=o.race,i.resolve=o.resolve,i.reject=o.reject,o.allSettled&&(i.allSettled=o.allSettled),o.any&&(i.any=o.any))}}function lt(){var e=s.Promise;return _e?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(s,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:ve.then,gthen:e.prototype.then}:{}}function ft(e,t,n,r,i){var o=De;try{return ut(e,!0),t(n,r,i)}finally{ut(o,!1)}}function dt(e,t,n){return"function"!=typeof e?e:function(){var r=De;n&&it(),ut(t,!0);try{return e.apply(this,arguments)}finally{ut(r,!1)}}}function pt(e,t){return function(n,r){return e.call(this,dt(n,t,!1),dt(r,t,!1))}}-1===(""+be).indexOf("[native code]")&&(it=ot=oe);function ht(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var r,i={promise:t,reason:e};if(s.document&&document.createEvent?((r=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),c(r,i)):s.CustomEvent&&c(r=new CustomEvent("unhandledrejection",{detail:i}),i),r&&s.dispatchEvent&&(dispatchEvent(r),!s.PromiseRejectionEvent&&s.onunhandledrejection))try{s.onunhandledrejection(r)}catch(e){}U&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch(e){}}var mt=Be.reject;var yt=String.fromCharCode(65535),vt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",gt=[],bt="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),wt=bt,_t=bt,kt=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function xt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Ot={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1},Pt=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||De.trans,i=this.name;function o(e,n,r){if(!r.schema[i])throw new ne.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}var a=Ke();try{return r&&r.db===this.db?r===De.trans?r._promise(e,o,n):rt((function(){return r._promise(e,o,n)}),{trans:r,transless:De.transless||De}):function e(t,n,r,i){if(t._state.openComplete||De.letThrough){var o=t._createTransaction(n,r,t._dbSchema);try{o.create()}catch(e){return mt(e)}return o._promise(n,(function(e,t){return rt((function(){return De.trans=o,i(e,t,o)}))})).then((function(e){return o._completion.then((function(){return e}))}))}if(!t._state.isBeingOpened){if(!t._options.autoOpen)return mt(new ne.DatabaseClosed);t.open().catch(oe)}return t._state.dbReadyPromise.then((function(){return e(t,n,r,i)}))}(this.db,e,[this.name],o)}finally{a&&Ye()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var t=o(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))&&e.keyPath.every((function(e){return t.indexOf(e)>=0}))}))[0];if(n&&this.db._maxKey!==yt)return this.where(n.name).equals(n.keyPath.map((function(t){return e[t]})));!n&&U&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var r=this.schema.idxByName,i=this.db._deps.indexedDB;function s(e,t){try{return 0===i.cmp(e,t)}catch(e){return!1}}var c=t.reduce((function(t,n){var i=t[0],o=t[1],c=r[n],u=e[n];return[i||c,i||!c?xt(o,c&&c.multi?function(e){var t=x(e,n);return a(t)&&t.some((function(e){return s(u,e)}))}:function(e){return s(u,x(e,n))}):o]}),[null,null]),u=c[0],l=c[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(l):n?this.filter(l):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?"["+e.join("+")+"]":e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){this.schema.mappedClass=e;var t=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(f(t,r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e},e.prototype.defineClass=function(){return this.mapToClass((function(e){c(this,e)}))},e.prototype.add=function(e,t){var n=this;return this._trans("readwrite",(function(r){return n.core.mutate({trans:r,type:"add",keys:null!=t?[t]:null,values:[e]})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):e.lastResult})).then((function(t){if(!n.core.schema.primaryKey.outbound)try{O(e,n.core.schema.primaryKey.keyPath,t)}catch(e){}return t}))},e.prototype.update=function(e,t){if("object"!=typeof t||a(t))throw new ne.InvalidArgument("Modifications must be an object.");if("object"!=typeof e||a(e))return this.where(":id").equals(e).modify(t);o(t).forEach((function(n){O(e,n,t[n])}));var n=x(e,this.schema.primKey.keyPath);return void 0===n?mt(new ne.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)},e.prototype.put=function(e,t){var n=this;return this._trans("readwrite",(function(r){return n.core.mutate({trans:r,type:"put",values:[e],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):e.lastResult})).then((function(t){if(!n.core.schema.primaryKey.outbound)try{O(e,n.core.schema.primaryKey.keyPath,t)}catch(e){}return t}))},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Ot})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){if(!r.core.schema.primaryKey.outbound&&i)throw new ne.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var n=e.length;return r.core.mutate({trans:t,type:"add",keys:i,values:e,wantResults:o}).then((function(e){var t=e.numFailures,i=e.results,a=e.lastResult,s=e.failures;if(0===t)return o?i:a;throw new Q(r.name+".bulkAdd(): "+t+" of "+n+" operations failed",Object.keys(s).map((function(e){return s[e]})))}))}))},e.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){if(!r.core.schema.primaryKey.outbound&&i)throw new ne.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var n=e.length;return r.core.mutate({trans:t,type:"put",keys:i,values:e,wantResults:o}).then((function(e){var t=e.numFailures,i=e.results,a=e.lastResult,s=e.failures;if(0===t)return o?i:a;throw new Q(r.name+".bulkPut(): "+t+" of "+n+" operations failed",Object.keys(s).map((function(e){return s[e]})))}))}))},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,i=e.lastResult,o=e.failures;if(0===r)return i;throw new Q(t.name+".bulkDelete(): "+r+" of "+n+" operations failed",o)}))},e}();function St(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};n.addEventType=s;for(var r=1,i=arguments.length;r<i;++r)s(arguments[r]);return n;function s(e,r,i){if("object"==typeof e)return c(e);r||(r=de),i||(i=oe);var o={subscribers:[],fire:i,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter((function(t){return t!==e})),o.fire=o.subscribers.reduce(r,i)}};return t[e]=n[e]=o,o}function c(e){o(e).forEach((function(t){var n=e[t];if(a(n))s(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new ne.InvalidArgument("Invalid event config");var r=s(t,ae,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){_((function(){e.apply(null,t)}))}))}))}}))}}function Ct(e,t){return m(t).from({prototype:e}),t}function Tt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Et(e,t){e.filter=xt(e.filter,t)}function jt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return xt(r(),t())}:t,e.justLimit=n&&!r}function Mt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new ne.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Dt(e,t,n){var r=Mt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function It(e,t,n,r){var i=e.replayFilter?xt(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},a=function(e,n,r){if(!i||i(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))){var a=n.primaryKey,s=""+a;"[object ArrayBuffer]"===s&&(s=""+new Uint8Array(a)),f(o,s)||(o[s]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(a,n),Rt(Dt(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return Rt(Dt(e,r,n),xt(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Rt(e,t,n,r){var i=Xe(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=oe}),(function(t){e.fail(t),n=oe}))||i(e.value,e,(function(e){return n=e})),n()}))}))}var At=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,mt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,mt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=xt(t.algorithm,e)},e.prototype._iterate=function(e,t){return It(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&c(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return It(t,e,n,t.table.core)}))},e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(Tt(n,!0))return r.count({trans:e,query:{index:Mt(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var i=0;return It(n,(function(){return++i,!1}),e,r).then((function(){return i}))})).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function s(e,t){var n=o(e,i),r=o(t,i);return n<r?-a:n>r?a:0}return this.toArray((function(e){return e.sort(s)})).then(t)},e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&Tt(n,!0)&&n.limit>0){var r=n.valueMapper,i=Mt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then((function(e){var t=e.result;return r?t.map(r):t}))}var o=[];return It(n,(function(e){return o.push(e)}),e,n.table.core).then((function(){return o}))}),e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Tt(t)?jt(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):jt(t,(function(){var t=e;return function(){return--t<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),jt(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},e.prototype.until=function(e,t){return Et(this._ctx,(function(n,r,i){return!e(n.value)||(r(i),t)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){var t,n;return Et(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=xt(t.isMatch,n),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&Tt(t,!0)&&t.limit>0)return this._read((function(e){var n=Mt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Et(this._ctx,(function(e){var t=e.primaryKey.toString(),r=f(n,t);return n[t]=!0,!r})),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(r){var i;if("function"==typeof e)i=e;else{var a=o(e),s=a.length;i=function(t){for(var n=!1,r=0;r<s;++r){var i=a[r],o=e[i];x(t,i)!==o&&(O(t,i,o),n=!0)}return n}}var c=n.table.core,u=c.schema.primaryKey,l=u.outbound,f=u.extractKey,d="testmode"in Sn?1:2e3,p=t.db.core.cmp,h=[],m=0,y=[],v=function(e,t){var n=t.failures,r=t.numFailures;m+=e-r;for(var i=0,a=o(n);i<a.length;i++){var s=a[i];h.push(n[s])}};return t.clone().primaryKeys().then((function(e){var t=function(n){var o=Math.min(d,e.length-n);return c.getMany({trans:r,keys:e.slice(n,n+o)}).then((function(a){for(var s=[],u=[],h=l?[]:null,m=[],y=0;y<o;++y){var g=a[y],b={value:M(g),primKey:e[n+y]};!1!==i.call(b,b.value,b)&&(null==b.value?m.push(e[n+y]):l||0===p(f(g),f(b.value))?(u.push(b.value),l&&h.push(e[n+y])):(m.push(e[n+y]),s.push(b.value)))}return Promise.resolve(s.length>0&&c.mutate({trans:r,type:"add",values:s}).then((function(e){for(var t in e.failures)m.splice(parseInt(t),1);v(s.length,e)}))).then((function(e){return u.length>0&&c.mutate({trans:r,type:"put",keys:h,values:u}).then((function(e){return v(u.length,e)}))})).then((function(){return m.length>0&&c.mutate({trans:r,type:"delete",keys:m}).then((function(e){return v(m.length,e)}))})).then((function(){return e.length>n+o&&t(n+d)}))}))};return t(0).then((function(){if(h.length>0)throw new Z("Error modifying one or more objects",h,m,y);return e.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,t=e.range;return Tt(e)&&(e.isPrimKey&&!_t||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then((function(e){var n=e.failures,r=(e.lastResult,e.results,e.numFailures);if(r)throw new Z("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-r);return t-r}))}))})):this.modify((function(e,t){return t.value=null}))},e}();function Bt(e,t){return e<t?-1:e===t?0:1}function Lt(e,t){return e>t?-1:e===t?0:1}function zt(e,t,n){var r=e instanceof Wt?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Nt(e){return new e.Collection(e,(function(){return Gt("")})).limit(0)}function Ft(e,t,n,r,i,o){for(var a=Math.min(e.length,r.length),s=-1,c=0;c<a;++c){var u=t[c];if(u!==r[c])return i(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):i(e[c],r[c])<0?e.substr(0,c)+r[c]+n.substr(c+1):s>=0?e.substr(0,s)+t[s]+n.substr(s+1):null;i(e[c],u)<0&&(s=c)}return a<r.length&&"next"===o?e+n.substr(e.length):a<e.length&&"prev"===o?e.substr(0,n.length):s<0?null:e.substr(0,s)+r[s]+n.substr(s+1)}function Ut(e,t,n,r){var i,o,a,s,c,u,l,f=n.length;if(!n.every((function(e){return"string"==typeof e})))return zt(e,"String expected.");function d(e){i=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),o=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),a="next"===e?Bt:Lt;var t=n.map((function(e){return{lower:o(e),upper:i(e)}})).sort((function(e,t){return a(e.lower,t.lower)}));s=t.map((function(e){return e.upper})),c=t.map((function(e){return e.lower})),u=e,l="next"===e?"":r}d("next");var p=new e.Collection(e,(function(){return Vt(s[0],c[f-1]+r)}));p._ondirectionchange=function(e){d(e)};var h=0;return p._addAlgorithm((function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var d=o(i);if(t(d,c,h))return!0;for(var p=null,m=h;m<f;++m){var y=Ft(i,d,s[m],c[m],a,u);null===y&&null===p?h=m+1:(null===p||a(p,y)>0)&&(p=y)}return n(null!==p?function(){e.continue(p+l)}:r),!1})),p}function Vt(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Gt(e){return{type:1,lower:e,upper:e}}var Wt=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Nt(this):new this.Collection(this,(function(){return Vt(e,t,!n,!r)}))}catch(e){return zt(this,vt)}},e.prototype.equals=function(e){return new this.Collection(this,(function(){return Gt(e)}))},e.prototype.above=function(e){return null==e?zt(this,vt):new this.Collection(this,(function(){return Vt(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?zt(this,vt):new this.Collection(this,(function(){return Vt(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?zt(this,vt):new this.Collection(this,(function(){return Vt(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?zt(this,vt):new this.Collection(this,(function(){return Vt(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!=typeof e?zt(this,"String expected."):this.between(e,e+yt,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Ut(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],yt)},e.prototype.equalsIgnoreCase=function(e){return Ut(this,(function(e,t){return e===t[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=N.apply(z,arguments);return 0===e.length?Nt(this):Ut(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=N.apply(z,arguments);return 0===e.length?Nt(this):Ut(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,yt)},e.prototype.anyOf=function(){var e=this,t=N.apply(z,arguments),n=this._cmp;try{t.sort(n)}catch(e){return zt(this,vt)}if(0===t.length)return Nt(this);var r=new this.Collection(this,(function(){return Vt(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm((function(e,r,o){for(var a=e.key;n(a,t[i])>0;)if(++i===t.length)return r(o),!1;return 0===n(a,t[i])||(r((function(){e.continue(t[i])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=N.apply(z,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return zt(this,vt)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,i=this._ascending,o=this._descending,a=this._min,s=this._max;if(0===e.length)return Nt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0})))return zt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ne.InvalidArgument);var c=!t||!1!==t.includeLowers,u=t&&!0===t.includeUppers;var l,f=i;function d(e,t){return f(e[0],t[0])}try{(l=e.reduce((function(e,t){for(var n=0,i=e.length;n<i;++n){var o=e[n];if(r(t[0],o[1])<0&&r(t[1],o[0])>0){o[0]=a(o[0],t[0]),o[1]=s(o[1],t[1]);break}}return n===i&&e.push(t),e}),[])).sort(d)}catch(e){return zt(this,vt)}var p=0,h=u?function(e){return i(e,l[p][1])>0}:function(e){return i(e,l[p][1])>=0},m=c?function(e){return o(e,l[p][0])>0}:function(e){return o(e,l[p][0])>=0};var y=h,v=new this.Collection(this,(function(){return Vt(l[0][0],l[l.length-1][1],!c,!u)}));return v._ondirectionchange=function(e){"next"===e?(y=h,f=i):(y=m,f=o),l.sort(d)},v._addAlgorithm((function(e,t,r){for(var o=e.key;y(o);)if(++p===l.length)return t(r),!1;return!!function(e){return!h(e)&&!m(e)}(o)||(0===n._cmp(o,l[p][1])||0===n._cmp(o,l[p][0])||t((function(){f===i?e.continue(l[p][0]):e.continue(l[p][1])})),!1)})),v},e.prototype.startsWithAnyOf=function(){var e=N.apply(z,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?Nt(this):this.inAnyRange(e.map((function(e){return[e,e+yt]}))):zt(this,"startsWithAnyOf() only works with strings")},e}();function qt(e){return 1===e.length?e[0]:e}function Kt(e){try{return e.only([[]]),[[]]}catch(e){return yt}}function Yt(e){return Xe((function(t){return Jt(t),e(t.target.error),!1}))}function Jt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Ht=function(){function e(){}return e.prototype._lock=function(){return w(!De.global),++this._reculock,1!==this._reculock||De.global||(De.lockOwnerFor=this),this},e.prototype._unlock=function(){if(w(!De.global),0==--this._reculock)for(De.global||(De.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{ft(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&De.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(w(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new ne.DatabaseClosed(r);case"MissingAPIError":throw new ne.MissingAPI(r.message,r);default:throw new ne.OpenFailed(r)}if(!this.active)throw new ne.TransactionInactive;return w(null===this._completion._state),(e=this.idbtrans=e||n.transaction(qt(this.storeNames),this.mode)).onerror=Xe((function(n){Jt(n),t._reject(e.error)})),e.onabort=Xe((function(n){Jt(n),t.active&&t._reject(new ne.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=Xe((function(){t.active=!1,t._resolve()})),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return mt(new ne.ReadOnly("Transaction is readonly"));if(!this.active)return mt(new ne.TransactionInactive);if(this._locked())return new Be((function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},De])}));if(n)return rt((function(){var e=new Be((function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new Be((function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Be.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return n}));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Be((function(e,r){n.then((function(n){return t._waitingQueue.push(Xe(e.bind(null,n)))}),(function(e){return t._waitingQueue.push(Xe(r.bind(null,e)))})).finally((function(){t._waitingFor===i&&(t._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&this._reject(new ne.Abort),this.active=!1},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(f(t,e))return t[e];var n=this.schema[e];if(!n)throw new ne.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function Xt(e,t,n,r,i,o,a){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!a?"&":"")+(r?"*":"")+(i?"++":"")+$t(t)}}function $t(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Zt(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:k(n,(function(e){return[e.name,e]}))}}function Qt(e){return null==e?function(){}:"string"==typeof e?function(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return x(t,e)}}(e):function(t){return x(t,e)}}function en(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}function tn(e){return[].slice.call(e)}var nn=0;function rn(e){return null==e?":id":"string"==typeof e?e:"["+e.join("+")+"]"}function on(e,t,n,r){var o=t.cmp.bind(t);function s(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var t=e.lower,r=e.upper,i=e.lowerOpen,o=e.upperOpen;return void 0===t?void 0===r?null:n.upperBound(r,!!o):void 0===r?n.lowerBound(t,!!i):n.bound(t,r,!!i,!!o)}var c=function(e,t){var n=tn(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((function(e){return t.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=a(t),i=null==t,o={},s={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:Qt(t)},indexes:tn(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry,i=e.keyPath,s={name:t,compound:a(i),keyPath:i,unique:n,multiEntry:r,extractKey:Qt(i)};return o[rn(i)]=s,s})),getIndexByKeyPath:function(e){return o[rn(e)]}};return o[":id"]=s.primaryKey,null!=t&&(o[rn(t)]=s.primaryKey),s}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),u=c.schema,l=c.hasGetAll,f=u.tables.map((function(e){return function(e){var t=e.name;return{name:t,schema:e,mutate:function(n){var r=n.trans,o=n.type,a=n.keys,c=n.values,u=n.range,l=n.wantResults;return new Promise((function(n,f){n=Xe(n);var d=r.objectStore(t),p=null==d.keyPath,h="put"===o||"add"===o;if(!h&&"delete"!==o&&"deleteRange"!==o)throw new Error("Invalid operation type: "+o);var m=(a||c||{length:1}).length;if(a&&c&&a.length!==c.length)throw new Error("Given keys array must have same length as given values array.");if(0===m)return n({numFailures:0,failures:{},results:[],lastResult:void 0});var y,v=l&&i(a||en(e.primaryKey,{type:o,keys:a,values:c})),g=[],b=0,w=function(e){++b,Jt(e),v&&(v[e.target._reqno]=void 0),g[e.target._reqno]=e.target.error},_=function(e){var t=e.target;v[t._reqno]=t.result};if("deleteRange"===o){if(4===u.type)return n({numFailures:b,failures:g,results:v,lastResult:void 0});y=3===u.type?d.clear():d.delete(s(u))}else{var k=h?p?[c,a]:[c,null]:[a,null],x=k[0],O=k[1];if(h)for(var P=0;P<m;++P)(y=O&&void 0!==O[P]?d[o](x[P],O[P]):d[o](x[P]))._reqno=P,v&&void 0===v[P]&&(y.onsuccess=_),y.onerror=w;else for(P=0;P<m;++P)(y=d[o](x[P]))._reqno=P,y.onerror=w}var S=function(e){var t=e.target.result;v&&(v[m-1]=t),n({numFailures:b,failures:g,results:v,lastResult:t})};y.onerror=function(e){w(e),S(e)},y.onsuccess=S}))},getMany:function(e){var n=e.trans,r=e.keys;return new Promise((function(e,i){e=Xe(e);for(var o,a=n.objectStore(t),s=r.length,c=new Array(s),u=0,l=0,f=function(t){var n=t.target;null!=(c[n._pos]=n.result)&&0,++l===u&&e(c)},d=Yt(i),p=0;p<s;++p){null!=r[p]&&((o=a.get(r[p]))._pos=p,o.onsuccess=f,o.onerror=d,++u)}0===u&&e(c)}))},get:function(e){var n=e.trans,r=e.key;return new Promise((function(e,i){e=Xe(e);var o=n.objectStore(t).get(r);o.onsuccess=function(t){return e(t.target.result)},o.onerror=Yt(i)}))},query:function(e){return function(n){return new Promise((function(r,i){r=Xe(r);var o=n.trans,a=n.values,c=n.limit,u=n.query,l=c===1/0?void 0:c,f=u.index,d=u.range,p=o.objectStore(t),h=f.isPrimaryKey?p:p.index(f.name),m=s(d);if(0===c)return r({result:[]});if(e){var y=a?h.getAll(m,l):h.getAllKeys(m,l);y.onsuccess=function(e){return r({result:e.target.result})},y.onerror=Yt(i)}else{var v=0,g=a||!("openKeyCursor"in h)?h.openCursor(m):h.openKeyCursor(m),b=[];g.onsuccess=function(e){var t=g.result;return t?(b.push(a?t.value:t.primaryKey),++v===c?r({result:b}):void t.continue()):r({result:b})},g.onerror=Yt(i)}}))}}(l),openCursor:function(e){var n=e.trans,r=e.values,i=e.query,o=e.reverse,a=e.unique;return new Promise((function(e,c){e=Xe(e);var u=i.index,l=i.range,f=n.objectStore(t),d=u.isPrimaryKey?f:f.index(u.name),p=o?a?"prevunique":"prev":a?"nextunique":"next",h=r||!("openKeyCursor"in d)?d.openCursor(s(l),p):d.openKeyCursor(s(l),p);h.onerror=Yt(c),h.onsuccess=Xe((function(t){var r=h.result;if(r){r.___id=++nn,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var a=r.advance.bind(r),s=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=Xe(c),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var t=new Promise((function(e,t){e=Xe(e),h.onerror=Yt(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=s,e(t)}})),n=function(){if(h.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return h.onsuccess=Xe((function(e){h.onsuccess=n,n()})),r.continue=i,r.continuePrimaryKey=o,r.advance=a,n(),t},e(r)}else e(null)}),c)}))},count:function(e){var n=e.query,r=e.trans,i=n.index,o=n.range;return new Promise((function(e,n){var a=r.objectStore(t),c=i.isPrimaryKey?a:a.index(i.name),u=s(o),l=u?c.count(u):c.count();l.onsuccess=Xe((function(t){return e(t.target.result)})),l.onerror=Yt(n)}))}}}(e)})),d={};return f.forEach((function(e){return d[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!d[e])throw new Error("Table '"+e+"' not found");return d[e]},cmp:o,MIN_KEY:-1/0,MAX_KEY:Kt(n),schema:u}}function an(e,t,n,i){var o=n.IDBKeyRange;return{dbcore:function(e,t){return t.reduce((function(e,t){var n=t.create;return r(r({},e),n(e))}),e)}(on(t,n.indexedDB,o,i),e.dbcore)}}function sn(e,t){var n=t.db,r=an(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((function(t){var n=t.name;e.core.schema.tables.some((function(e){return e.name===n}))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function cn(e,t,n,r){n.forEach((function(n){var i=r[n];t.forEach((function(t){n in t||(t===e.Transaction.prototype||t instanceof e.Transaction?h(t,n,{get:function(){return this.table(n)},set:function(e){p(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))}))}))}function un(e,t){t.forEach((function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]}))}function ln(e,t){return e._cfg.version-t._cfg.version}function fn(e,t,n,r){var i=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var s=a._reject.bind(a),c=De.transless||De;rt((function(){De.trans=a,De.transless=c,0===t?(o(i).forEach((function(e){dn(n,e,i[e].primKey,i[e].indexes)})),sn(e,n),Be.follow((function(){return e.on.populate.fire(a)})).catch(s)):function(e,t,n,r){var i=[],a=e._versions,s=e._dbSchema=hn(e,e.idbdb,r),c=!1;function u(){return i.length?Be.resolve(i.shift()(n.idbtrans)).then(u):Be.resolve()}return a.filter((function(e){return e._cfg.version>=t})).forEach((function(a){i.push((function(){var i=s,u=a._cfg.dbschema;mn(e,i,r),mn(e,u,r),s=e._dbSchema=u;var l=function(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(i){var a={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src===o.primKey.src||bt){var s=i.idxByName,c=o.idxByName,u=void 0;for(u in s)c[u]||a.del.push(u);for(u in c){var l=s[u],f=c[u];l?l.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}else a.recreate=!0,r.change.push(a)}else r.add.push([n,o])}return r}(i,u);l.add.forEach((function(e){dn(r,e[0],e[1].primKey,e[1].indexes)})),l.change.forEach((function(e){if(e.recreate)throw new ne.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach((function(e){return pn(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),pn(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var f=a._cfg.contentUpgrade;if(f&&a._cfg.version>t){sn(e,r),c=!0;var d=P(u);l.del.forEach((function(e){d[e]=i[e]})),un(e,[e.Transaction.prototype]),cn(e,[e.Transaction.prototype],o(d),d),n.schema=d;var p,h=F(f);h&&it();var m=Be.follow((function(){if((p=f(n))&&h){var e=ot.bind(null,null);p.then(e,e)}}));return p&&"function"==typeof p.then?Be.resolve(p):m.then((function(){return p}))}})),i.push((function(t){c&&wt||function(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var r=t.db.objectStoreNames[n];null==e[r]&&t.db.deleteObjectStore(r)}}(a._cfg.dbschema,t);un(e,[e.Transaction.prototype]),cn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}))})),u().then((function(){var e,t;t=r,o(e=s).forEach((function(n){t.db.objectStoreNames.contains(n)||dn(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,a,n).catch(s)}))}function dn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return pn(i,e)})),i}function pn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function hn(e,t,n){var r={};return g(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),i=t.keyPath,o=Xt($t(i),i||"",!1,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),a=[],s=0;s<t.indexNames.length;++s){var c=t.index(t.indexNames[s]);i=c.keyPath;var u=Xt(c.name,i,!!c.unique,!!c.multiEntry,!1,i&&"string"!=typeof i,!1);a.push(u)}r[e]=Zt(e,o,a)})),r}function mn(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var o=r[i],a=n.objectStore(o);e._hasGetAll="getAll"in a;for(var c=0;c<a.indexNames.length;++c){var u=a.indexNames[c],l=a.index(u).keyPath,f="string"==typeof l?l:"["+g(l).join("+")+"]";if(t[o]){var d=t[o].idxByName[f];d&&(d.name=u,delete t[o].idxByName[f],t[o].idxByName[u]=d)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&s.WorkerGlobalScope&&s instanceof s.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}var yn,vn=function(){function e(){}return e.prototype._parseStoresSpec=function(e,t){o(e).forEach((function(n){if(null!==e[n]){var r=e[n].split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Xt(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(r),0===t)})),i=r.shift();if(i.multi)throw new ne.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new ne.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new ne.Schema("Index must have a name and cannot be an empty string")})),t[n]=Zt(n,i,r)}}))},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,e):e;var n=t._versions,r={},i={};return n.forEach((function(e){c(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)})),t._dbSchema=i,un(t,[t._allTables,t,t.Transaction.prototype]),cn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],o(i),i),t._storeNames=o(i),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=e,this},e}();function gn(e){return rt((function(){return De.letThrough=!0,e()}))}function bn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?mt(t.dbOpenError):e}));U&&(t.openCanceller._stackHolder=q()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.dbReadyResolve,i=null;return Be.race([t.openCanceller,new Be((function(r,a){if(!n)throw new ne.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var s=e.name,c=t.autoSchema?n.open(s):n.open(s,Math.round(10*e.verno));if(!c)throw new ne.MissingAPI("IndexedDB API not available");c.onerror=Yt(a),c.onblocked=Xe(e._fireOnBlocked),c.onupgradeneeded=Xe((function(r){if(i=c.transaction,t.autoSchema&&!e._options.allowEmptyDB){c.onerror=Jt,i.abort(),c.result.close();var o=n.deleteDatabase(s);o.onsuccess=o.onerror=Xe((function(){a(new ne.NoSuchDatabase("Database "+s+" doesnt exist"))}))}else{i.onerror=Yt(a);var u=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;e.idbdb=c.result,fn(e,u/10,i,a)}}),a),c.onsuccess=Xe((function(){i=null;var n=e.idbdb=c.result,a=g(n.objectStoreNames);if(a.length>0)try{var u=n.transaction(qt(a),"readonly");t.autoSchema?function(e,t,n){e.verno=t.version/10;var r=e._dbSchema=hn(0,t,n);e._storeNames=g(t.objectStoreNames,0),cn(e,[e._allTables],o(r),r)}(e,n,u):mn(e,e._dbSchema,u),sn(e,u)}catch(e){}gt.push(e),n.onversionchange=Xe((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),yn.add(s),r()}),a)}))]).then((function(){return t.onReadyBeingFired=[],Be.resolve(gn(e.on.ready.fire)).then((function e(){if(t.onReadyBeingFired.length>0){var n=t.onReadyBeingFired.reduce(pe,oe);return t.onReadyBeingFired=[],Be.resolve(gn(n)).then(e)}}))})).finally((function(){t.onReadyBeingFired=null})).then((function(){return t.isBeingOpened=!1,e})).catch((function(n){try{i&&i.abort()}catch(e){}return t.isBeingOpened=!1,e.close(),t.dbOpenError=n,mt(t.dbOpenError)})).finally((function(){t.openComplete=!0,r()}))}function wn(e){var t=function(t){return e.next(t)},n=i(t),r=i((function(t){return e.throw(t)}));function i(e){return function(t){var i=e(t),o=i.value;return i.done?o:o&&"function"==typeof o.then?o.then(n,r):a(o)?Promise.all(o).then(n,r):n(o)}}return i(t)()}function _n(e,t,n){var r=arguments.length;if(r<2)throw new ne.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var o=C(i);return[e,o,n]}function kn(e,t,n,r,i){return Be.resolve().then((function(){var o=De.transless||De,a=e._createTransaction(t,n,e._dbSchema,r),s={trans:a,transless:o};r?a.idbtrans=r.idbtrans:a.create();var c,u=F(i);u&&it();var l=Be.follow((function(){if(c=i.call(a,a))if(u){var e=ot.bind(null,null);c.then(e,e)}else"function"==typeof c.next&&"function"==typeof c.throw&&(c=wn(c))}),s);return(c&&"function"==typeof c.then?Be.resolve(c).then((function(e){return a.active?e:mt(new ne.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return c}))).then((function(e){return r&&a._resolve(),a._completion.then((function(){return e}))})).catch((function(e){return a._reject(e),mt(e)}))}))}function xn(e,t,n){for(var r=a(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}var On={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),i=n.schema,o={},a=[];function s(e,t,n){var i=rn(e),c=o[i]=o[i]||[],u=null==e?0:"string"==typeof e?1:e.length,l=t>0,f=r(r({},n),{isVirtual:l,isPrimaryKey:!l&&n.isPrimaryKey,keyTail:t,keyLength:u,extractKey:Qt(e),unique:!l&&n.unique});(c.push(f),f.isPrimaryKey||a.push(f),u>1)&&s(2===u?e[0]:e.slice(0,u-1),t+1,n);return c.sort((function(e,t){return e.keyTail-t.keyTail})),f}var c=s(i.primaryKey.keyPath,0,i.primaryKey);o[":id"]=[c];for(var u=0,l=i.indexes;u<l.length;u++){var f=l[u];s(f.keyPath,0,f)}function d(t){var n,i,o=t.query.index;return o.isVirtual?r(r({},t),{query:{index:o,range:(n=t.query.range,i=o.keyTail,{type:1===n.type?2:n.type,lower:xn(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,i),lowerOpen:!0,upper:xn(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,i),upperOpen:!0})}}):t}return r(r({},n),{schema:r(r({},i),{primaryKey:c,indexes:a,getIndexByKeyPath:function(e){var t=o[rn(e)];return t&&t[0]}}),count:function(e){return n.count(d(e))},query:function(e){return n.query(d(e))},openCursor:function(t){var r=t.query.index,i=r.keyTail,o=r.isVirtual,a=r.keyLength;if(!o)return n.openCursor(t);return n.openCursor(d(t)).then((function(n){return n&&function(n){return Object.create(n,{continue:{value:function(r){null!=r?n.continue(xn(r,t.reverse?e.MAX_KEY:e.MIN_KEY,i)):t.unique?n.continue(xn(n.key,t.reverse?e.MIN_KEY:e.MAX_KEY,i)):n.continue()}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(xn(t,e.MAX_KEY,i),r)}},key:{get:function(){var e=n.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return n.value}}})}(n)}))}})}})}},Pn={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),o=n.schema.primaryKey;return r(r({},n),{mutate:function(e){var a=De.trans,s=a.table(t).hook,c=s.deleting,u=s.creating,l=s.updating;switch(e.type){case"add":if(u.fire===oe)break;return a._promise("readwrite",(function(){return f(e)}),!0);case"put":if(u.fire===oe&&l.fire===oe)break;return a._promise("readwrite",(function(){return f(e)}),!0);case"delete":if(c.fire===oe)break;return a._promise("readwrite",(function(){return f(e)}),!0);case"deleteRange":if(c.fire===oe)break;return a._promise("readwrite",(function(){return function(e){return function e(t,i,a){return n.query({trans:t,values:!1,query:{index:o,range:i},limit:a}).then((function(n){var o=n.result;return f({type:"delete",keys:o,trans:t}).then((function(n){return n.numFailures>0?Promise.reject(n.failures[0]):o.length<a?{failures:[],numFailures:0,lastResult:void 0}:e(t,r(r({},i),{lower:o[o.length-1],lowerOpen:!0}),a)}))}))}(e.trans,e.range,1e4)}(e)}),!0)}return n.mutate(e);function f(e){var t=De.trans,a=e.keys||en(o,e);if(!a)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?r(r({},e),{keys:a,wantResults:!0}):r({},e)).type&&(e.values=i(e.values)),e.keys&&(e.keys=i(e.keys)),function(e,t,n){return"add"===t.type?Promise.resolve(new Array(t.values.length)):e.getMany({trans:t.trans,keys:n})}(n,e,a).then((function(r){var i=a.map((function(n,i){var a=r[i],s={onerror:null,onsuccess:null};if("delete"===e.type)c.fire.call(s,n,a,t);else if("add"===e.type||void 0===a){var f=u.fire.call(s,n,e.values[i],t);null==n&&null!=f&&(n=f,e.keys[i]=n,o.outbound||O(e.values[i],o.keyPath,n))}else{var d=A(a,e.values[i]),p=l.fire.call(s,d,n,a,t);if(p){var h=e.values[i];Object.keys(p).forEach((function(e){O(h,e,p[e])}))}}return s}));return n.mutate(e).then((function(t){for(var n=t.failures,o=t.results,s=t.numFailures,c=t.lastResult,u=0;u<a.length;++u){var l=o?o[u]:a[u],f=i[u];null==l?f.onerror&&f.onerror(n[u]):f.onsuccess&&f.onsuccess("put"===e.type&&r[u]?e.values[u]:l)}return{failures:n,results:o,numFailures:s,lastResult:c}})).catch((function(e){return i.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}}})}})}},Sn=function(){function e(t,n){var i=this;this._middlewares={},this.verno=0;var o=e.dependencies;this._options=n=r({addons:e.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var s,c={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:oe,dbReadyPromise:null,cancelOpen:oe,openCanceller:null,autoSchema:!0};c.dbReadyPromise=new Be((function(e){c.dbReadyResolve=e})),c.openCanceller=new Be((function(e,t){c.cancelOpen=t})),this._state=c,this.name=t,this.on=St(this,"populate","blocked","versionchange",{ready:[pe,oe]}),this.on.ready.subscribe=b(this.on.ready.subscribe,(function(t){return function(n,r){e.vip((function(){var e=i._state;if(e.openComplete)e.dbOpenError||Be.resolve().then(n),r&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&t(n);else{t(n);var o=i;r||t((function e(){o.on.ready.unsubscribe(n),o.on.ready.unsubscribe(e)}))}}))}})),this.Collection=(s=this,Ct(At.prototype,(function(e,t){this.db=s;var n=Ot,r=null;if(t)try{n=t()}catch(e){r=e}var i=e._ctx,o=i.table,a=o.hook.reading.fire;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:a!==ae?a:null}}))),this.Table=function(e){return Ct(Pt.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:St(null,{creating:[ue,oe],reading:[se,ae],updating:[fe,oe],deleting:[le,oe]})}))}(this),this.Transaction=function(e){return Ct(Ht.prototype,(function(t,n,r,i){var o=this;this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.idbtrans=null,this.on=St(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Be((function(e,t){o._resolve=e,o._reject=t})),this._completion.then((function(){o.active=!1,o.on.complete.fire()}),(function(e){var t=o.active;return o.active=!1,o.on.error.fire(e),o.parent?o.parent._reject(e):t&&o.idbtrans&&o.idbtrans.abort(),mt(e)}))}))}(this),this.Version=function(e){return Ct(vn.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return Ct(Wt.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};var i=e._deps.indexedDB;if(!i)throw new ne.MissingAPI("indexedDB API missing");this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(e,t){return i.cmp(t,e)},this._max=function(e,t){return i.cmp(e,t)>0?e:t},this._min=function(e,t){return i.cmp(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+i.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+i.name+"'. Closing db now to resume the delete request."),i.close()})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+i.name+"') was blocked"):console.warn("Upgrade '"+i.name+"' blocked by other connection holding version "+e.oldVersion/10)})),this._maxKey=Kt(n.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new i.Transaction(e,t,n,r)},this._fireOnBlocked=function(e){i.on("blocked").fire(e),gt.filter((function(e){return e.name===i.name&&e!==i&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(On),this.use(Pn),a.forEach((function(e){return e(i)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ne.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ne.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(ln),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this._state.openComplete||De.letThrough?e():new Be((function(e,n){if(!t._state.isBeingOpened){if(!t._options.autoOpen)return void n(new ne.DatabaseClosed);t.open().catch(oe)}t._state.dbReadyPromise.then(e,n)})).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;i&&this.unuse({stack:t,name:i});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:n,level:null==r?10:r,name:i}),o.sort((function(e,t){return e.level-t.level})),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},e.prototype.open=function(){return bn(this)},e.prototype.close=function(){var e=gt.indexOf(this),t=this._state;if(e>=0&&gt.splice(e,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}this._options.autoOpen=!1,t.dbOpenError=new ne.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError),t.dbReadyPromise=new Be((function(e){t.dbReadyResolve=e})),t.openCanceller=new Be((function(e,n){t.cancelOpen=n}))},e.prototype.delete=function(){var e=this,t=arguments.length>0,n=this._state;return new Be((function(r,i){var o=function(){e.close();var t=e._deps.indexedDB.deleteDatabase(e.name);t.onsuccess=Xe((function(){yn.remove(e.name),r()})),t.onerror=Yt(i),t.onblocked=e._fireOnBlocked};if(t)throw new ne.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(o):o()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return o(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!0,configurable:!0}),e.prototype.transaction=function(){var e=_n.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,i=De.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,a,s=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map((function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||"readonly"===e)o="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new ne.InvalidArgument("Invalid transaction mode: "+e);o="readwrite"}if(i){if("readonly"===i.mode&&"readwrite"===o){if(!s)throw new ne.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach((function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!s)throw new ne.SubTransaction("Table "+e+" not included in parent transaction.");i=null}})),s&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,(function(t,n){n(e)})):mt(e)}var c=kn.bind(null,this,o,a,i,n);return i?i._promise(o,c,"lock"):De.trans?ft(De.transless,(function(){return r._whenReady(c)})):this._whenReady(c)},e.prototype.table=function(e){if(!f(this._allTables,e))throw new ne.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},e}(),Cn=Sn;d(Cn,r(r({},ie),{delete:function(e){return new Cn(e).delete()},exists:function(e){return new Cn(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){return yn?yn.getDatabaseNames().then(e):Be.resolve([])},defineClass:function(){return function(e){c(this,e)}},ignoreTransaction:function(e){return De.trans?ft(De.transless,e):e()},vip:gn,async:function(e){return function(){try{var t=wn(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Be.resolve(t)}catch(e){return mt(e)}}},spawn:function(e,t,n){try{var r=wn(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Be.resolve(r)}catch(e){return mt(e)}},currentTransaction:{get:function(){return De.trans||null}},waitFor:function(e,t){var n=Be.resolve("function"==typeof e?Cn.ignoreTransaction(e):e).timeout(t||6e4);return De.trans?De.trans.waitFor(n):n},Promise:Be,debug:{get:function(){return U},set:function(e){V(e,"dexie"===e?function(){return!0}:kt)}},derive:m,extend:c,props:d,override:b,Events:St,getByKeyPath:x,setByKeyPath:O,delByKeyPath:function(e,t){"string"==typeof t?O(e,t,void 0):"length"in t&&[].map.call(t,(function(t){O(e,t,void 0)}))},shallowClone:P,deepClone:M,getObjectDiff:A,asap:_,minKey:-1/0,addons:[],connections:gt,errnames:ee,dependencies:function(){try{return{indexedDB:s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB,IDBKeyRange:s.IDBKeyRange||s.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"3.0.2",version:"3.0.2".split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)})),default:Cn,Dexie:Cn})),Cn.maxKey=Kt(Cn.dependencies.IDBKeyRange),function(e){try{yn=function(e){var t,n=e&&"function"==typeof e.databases;if(!n){var r=new Sn("__dbnames",{addons:[]});r.version(1).stores({dbnames:"name"}),t=r.table("dbnames")}return{getDatabaseNames:function(){return n?Be.resolve(e.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return"__dbnames"!==e}))})):t.toCollection().primaryKeys()},add:function(e){return!n&&"__dbnames"!==e&&t.put({name:e}).catch(oe)},remove:function(e){return!n&&"__dbnames"!==e&&t.delete(e).catch(oe)}}}(e)}catch(e){}}(Sn.dependencies.indexedDB),Be.rejectionMapper=function(e,t){if(!e||e instanceof X||e instanceof TypeError||e instanceof SyntaxError||!e.name||!re[e.name])return e;var n=new re[e.name](t||e.message,e);return"stack"in e&&h(n,"stack",{get:function(){return this.inner.stack}}),n},V(U,kt),t.default=Sn},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=n(70),s=o(n(78)),c=n(130),u=n(95);function l(){const e=new s.Rectangle;e.height=13*a.scale+"px",e.thickness=0;const t=()=>{e.height=13*a.scale+"px"};a.event.on("scale-change",t),e.onDisposeObservable.add(()=>{a.event.off("scale-change",t)});const n=new s.Rectangle;n.width="50%",n.horizontalAlignment=0,n.thickness=0,e.addControl(n);const r=new s.Rectangle;r.width="20%",r.horizontalAlignment=0,r.left="50%",r.thickness=0,e.addControl(r);const i=new s.Rectangle;return i.width="20%",i.horizontalAlignment=0,i.left="80%",i.thickness=0,e.addControl(i),{main:e,name:n,date:r,type:i}}t.default=function(e,t){const n=new s.Rectangle;n.thickness=0,n.horizontalAlignment=2,n.zIndex=10,window.innerHeight>230*a.scale?n.height=230*a.scale+"px":n.height="100%",n.width=310*a.scale+"px",n.background="#11111166";const r=new s.TextBlock;r.fontFamily="Lato",r.fontSize=11*a.scale,r.textVerticalAlignment=0,r.color="white",r.text="Singleplayer",r.top=a.scale,n.addControl(r);const i=c.createButton();i.button.top=18*a.scale+"px",i.button.left=5*a.scale+"px",i.buttonText.text=[{text:"Create World",color:"white",font:"Lato"}],i.button.onPointerClickObservable.add(()=>{!function(){const e=a.getScreen(1),t=new s.Rectangle;t.background="#11111188",window.innerHeight>230*a.scale?t.height=230*a.scale+"px":t.height="100%";t.width=220*a.scale+"px",t.thickness=0,t.zIndex=200;const n=new s.StackPanel;n.verticalAlignment=0,n.top=18*a.scale+"px",n.width=210*a.scale+"px",n.height="80%",n.verticalAlignment=0,n.top=18*a.scale+"px",n.width=210*a.scale+"px",n.height="80%";const r=c.createInput();r.name.text="Worldname",r.input.placeholderText="World",r.input.text="World",n.addControl(r.main);const i=c.createItem();i.item.verticalAlignment=1,i.text.text=[{text:"Create",color:"white",font:"Lato"}],i.item.top=`-${16*a.scale}px`,i.item.onPointerClickObservable.add(()=>{t.dispose(),window.electron.send("world-create",{data:{name:r.input.text,date:Date.now(),type:"Infinite",voxelsrv:u.gameVersion},config:{},world:r.input.text})}),t.addControl(i.item);const o=c.createItem();o.item.verticalAlignment=1,o.text.text=[{text:"Back",color:"white",font:"Lato"}],o.item.onPointerClickObservable.add(()=>{t.dispose()}),t.addControl(o.item),t.addControl(n),e.addControl(t)}()}),n.addControl(i.button);const o=c.createButton();o.button.top=18*a.scale+"px",o.button.left=74*a.scale+"px",o.buttonText.text=[{text:"Remove",color:"white",font:"Lato"}],o.button.onPointerClickObservable.add(()=>{});const f=new s.Rectangle;f.width=290*a.scale+"px",f.height="70%",f.verticalAlignment=0,f.top=40*a.scale+"px",f.background="#ffffffbb",f.thickness=0;const d=l();d.main.verticalAlignment=0,d.main.fontFamily="Lato",d.main.background="#88888855",d.main.fontSize=7*a.scale;const p=new s.TextBlock;p.text="Name",p.color="#222222",d.name.addControl(p);const h=new s.TextBlock;h.text="Last played",h.color="#222222",d.date.addControl(h);const m=new s.TextBlock;m.text="Type",m.color="#222222",d.type.addControl(m),f.addControl(d.main),n.addControl(f);const y=new s.ScrollViewer;y.height=150*a.scale+"px",y.top=13*a.scale+"px",y.thickness=0,y.verticalAlignment=0,y.barSize=0,f.addControl(y);const v=new s.StackPanel;v.fontFamily="Lato",v.width="100%",v.fontSize=6*a.scale,v.verticalAlignment=0,y.addControl(v);let g=[];window.electron.once("world-list",(e,t)=>{t.forEach(e=>{const t=l(),n=new s.TextBlock;n.text=e.name,n.color="#222222",t.name.addControl(n);const r=new s.TextBlock;r.text=e.date.toString(),r.color="#222222",t.date.addControl(r);const i=new s.TextBlock;i.text=e.type,i.color="#222222",t.type.addControl(i);let o=0;t.main.onPointerClickObservable.add(n=>{g.forEach(e=>{e.row.main.background="#ffffff00"}),t.main.background="#ffffffaa",o+=1,o>1&&window.electron.send("world-start",{world:e.rawName}),setTimeout(()=>{o=0},500)}),t.main.onPointerEnterObservable.add(e=>{"#ffffffaa"!=t.main.background&&(t.main.background="#ffffff67")}),t.main.onPointerOutObservable.add(e=>{"#ffffffaa"!=t.main.background&&(t.main.background="#ffffff00")}),v.addControl(t.main),g.push({data:e,row:t})})}),window.electron.send("world-list-request",!0);const b=c.createItem();b.item.verticalAlignment=1,b.text.text=[{text:"Go back to menu",color:"white",font:"Lato"}],b.item.onPointerClickObservable.add(()=>{n.dispose(),t("main")}),n.addControl(b.item);const w=e=>{window.innerHeight>230*a.scale?n.height=230*a.scale+"px":n.height="100%",n.width=310*a.scale+"px",r.fontSize=11*a.scale,f.width=290*a.scale+"px",f.top=40*a.scale+"px",y.top=13*a.scale+"px",d.main.fontSize=7*a.scale,v.fontSize=6*a.scale,y.height=150*a.scale+"px",i.button.top=18*a.scale+"px",i.button.left=5*a.scale+"px",o.button.top=18*a.scale+"px",o.button.left=74*a.scale+"px",b.item.width=100*a.scale+"px",b.item.height=18*a.scale+"px",b.text.fontSize=10*a.scale};return a.event.on("scale-change",w),n.onDisposeObservable.add(()=>{a.event.off("scale-change",w)}),n}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=n(70),s=o(n(78)),c=n(156),u=n(217),l=n(172),f=n(147),d=n(130);function p(){const e=new s.Rectangle;e.height=13*a.scale+"px",e.thickness=0;const t=()=>{e.height=13*a.scale+"px"};a.event.on("scale-change",t),e.onDisposeObservable.add(()=>{a.event.off("scale-change",t)});const n=new s.Rectangle;n.width="20%",n.horizontalAlignment=0,n.thickness=0,e.addControl(n);const r=new s.Rectangle;r.width="50%",r.horizontalAlignment=0,r.left="20%",r.thickness=0,e.addControl(r);const i=new s.Rectangle;i.width="10%",i.horizontalAlignment=0,i.left="70%",i.thickness=0,e.addControl(i);const o=new s.Rectangle;return o.width="20%",o.horizontalAlignment=0,o.left="80%",o.thickness=0,e.addControl(o),{main:e,name:n,motd:r,players:i,software:o}}t.default=function(e,t){const n=new s.Rectangle;n.thickness=0,n.horizontalAlignment=2,n.zIndex=10,window.innerHeight>230*a.scale?n.height=230*a.scale+"px":n.height="100%",n.width=310*a.scale+"px",n.background="#11111166";const r=new s.TextBlock;r.fontFamily="Lato",r.fontSize=11*a.scale,r.textVerticalAlignment=0,r.color="white",r.text="Multiplayer",r.top=a.scale,n.addControl(r);const i=new s.InputText;i.height=17*a.scale+"px",i.width=266*a.scale+"px",i.top=18*a.scale+"px",i.left=5*a.scale+"px",i.fontSize=6*a.scale,i.verticalAlignment=0,i.horizontalAlignment=0,i.thickness=0,i.background="#ffffffaa",i.focusedBackground="#ffffffff",i.color="#666666",i.placeholderText="Server address",n.addControl(i);const o=new s.Rectangle;o.height=17*a.scale+"px",o.width=34*a.scale+"px",o.top=18*a.scale+"px",o.left=-5*a.scale+"px",o.verticalAlignment=0,o.horizontalAlignment=1,o.thickness=0,o.background="#4d4d4daa",o.color="#666666",o.onPointerClickObservable.add(()=>{let t=i.text;t.startsWith("wss://")||t.startsWith("ws://")||(t="ws://"+t),l.connect(e,new u.MPSocket(t))});const h=new c.FormTextBlock;h.text=[{text:"Connect",color:"white",font:"Lato"}],h.textHorizontalAlignment=2,h.fontSize=6*a.scale,h.onPointerEnterObservable.add(e=>{h.text.forEach(e=>e.underline=!0),h._markAsDirty()}),h.onPointerOutObservable.add(e=>{h.text.forEach(e=>e.underline=!1),h._markAsDirty()}),o.addControl(h),n.addControl(o);const m=new s.Rectangle;m.width=290*a.scale+"px",m.height="70%",m.verticalAlignment=0,m.top=40*a.scale+"px",m.background="#ffffffbb",m.thickness=0;const y=p();y.main.verticalAlignment=0,y.main.fontFamily="Lato",y.main.background="#88888855",y.main.fontSize=7*a.scale;const v=new s.TextBlock;v.text="Name",v.color="#222222",y.name.addControl(v);const g=new s.TextBlock;g.text="Motd",g.color="#222222",y.motd.addControl(g);const b=new s.TextBlock;b.text="Players",b.color="#222222",y.players.addControl(b);const w=new s.TextBlock;w.text="Software",w.color="#222222",y.software.addControl(w),m.addControl(y.main),n.addControl(m);const _=new s.ScrollViewer;_.height=150*a.scale+"px",_.top=13*a.scale+"px",_.thickness=0,_.verticalAlignment=0,_.barSize=0,m.addControl(_);const k=new s.StackPanel;k.fontFamily="Lato",k.width="100%",k.fontSize=6*a.scale,k.verticalAlignment=0,_.addControl(k),fetch("http://pb4.eu:9001").then(e=>e.json()).then(e=>{Object.values(e).forEach(e=>{const t=p(),n=new s.TextBlock;n.text=e.name,n.color="#222222",t.name.addControl(n);const r=new s.TextBlock;r.text=e.motd,r.color="#222222",t.motd.addControl(r);const a=new s.TextBlock;a.text=`${e.numberplayers}/${e.maxplayers}`,a.color="#222222",t.players.addControl(a);const c=new s.TextBlock;c.text=e.software,c.color="#222222",t.software.addControl(c),t.main.onPointerEnterObservable.add(e=>{t.main.background="#ffffff67"}),t.main.onPointerOutObservable.add(e=>{t.main.background="#ffffff00"});let u=0;t.main.onPointerClickObservable.add(t=>{i.text=e.ip,u+=1,u>1&&o.onPointerClickObservable.notifyObservers(new s.Vector2WithInfo(new f.Vector2(0,0),0)),setTimeout(()=>{u=0},1e3)}),k.addControl(t.main)})});const x=d.createItem();x.item.verticalAlignment=1,x.text.text=[{text:"Go back to menu",color:"white",font:"Lato"}],x.item.onPointerClickObservable.add(()=>{n.dispose(),t("main")}),n.addControl(x.item);const O=e=>{window.innerHeight>230*a.scale?n.height=230*a.scale+"px":n.height="100%",n.width=310*a.scale+"px",r.fontSize=11*a.scale,i.height=17*a.scale+"px",i.width=266*a.scale+"px",i.top=18*a.scale+"px",i.left=5*a.scale+"px",i.fontSize=6*a.scale,o.height=17*a.scale+"px",o.width=34*a.scale+"px",o.top=18*a.scale+"px",o.left=-5*a.scale+"px",h.fontSize=6*a.scale,m.width=290*a.scale+"px",m.top=40*a.scale+"px",_.top=13*a.scale+"px",y.main.fontSize=7*a.scale,k.fontSize=6*a.scale,_.height=150*a.scale+"px",x.item.width=100*a.scale+"px",x.item.height=18*a.scale+"px",x.text.fontSize=10*a.scale};return a.event.on("scale-change",O),n.onDisposeObservable.add(()=>{a.event.off("scale-change",O)}),n}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.parseToMessage=t.parseToObject=void 0;const s=o(n(338)),c=o(n(353)),u=a(n(354)),l=a(n(355));let f={},d={};u.default.forEach((e,t)=>d[e]=t),l.default.forEach((e,t)=>f[e]=t),t.parseToObject=function(e,t){let n,r="";if("server"==e){if(r=l.default[t[0]],null==r)return null;n=c[r]}else{if(r=u.default[t[0]],null==r)return null;n=s[r],e="client"}const i=t.slice(1),o=n.decode(i);let a=null;return a=null!=n?n.verify(o):"Invalid packet",a?(console.error("Invalid "+e+" packet! Type: "+r,a),null):{data:n.toObject(o),type:r}},t.parseToMessage=function(e,t,n){let r,i=0;if("server"==e){if(i=f[t],null==i)return null;r=c[t]}else{if(i=d[t],null==i)return null;r=s[t],e="client"}let o=null;if(o=null!=r?r.verify(n):"Invalid packet",o)return console.error("Invalid "+e+" packet! Type: "+t,n,o),null;const a=r.create(n),u=r.encode(a).finish(),l=new Uint8Array(1+u.length);return l.set([i]),l.set(u,1),l.buffer}},function(e,t,n){var r,i,o;i=[n(249)],void 0===(o="function"==typeof(r=function(e){"use strict";var t=e.Reader,n=e.Writer,r=e.util,i=e.roots.default||(e.roots.default={});return i.LoginResponse=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.username="",o.prototype.protocol=0,o.prototype.mobile=!1,o.prototype.client="",o.prototype.uuid="",o.prototype.secret="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.username&&Object.hasOwnProperty.call(e,"username")&&t.uint32(10).string(e.username),null!=e.protocol&&Object.hasOwnProperty.call(e,"protocol")&&t.uint32(16).uint32(e.protocol),null!=e.mobile&&Object.hasOwnProperty.call(e,"mobile")&&t.uint32(24).bool(e.mobile),null!=e.client&&Object.hasOwnProperty.call(e,"client")&&t.uint32(34).string(e.client),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(42).string(e.uuid),null!=e.secret&&Object.hasOwnProperty.call(e,"secret")&&t.uint32(50).string(e.secret),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.LoginResponse;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.username=e.string();break;case 2:o.protocol=e.uint32();break;case 3:o.mobile=e.bool();break;case 4:o.client=e.string();break;case 5:o.uuid=e.string();break;case 6:o.secret=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.username&&e.hasOwnProperty("username")&&!r.isString(e.username)?"username: string expected":null!=e.protocol&&e.hasOwnProperty("protocol")&&!r.isInteger(e.protocol)?"protocol: integer expected":null!=e.mobile&&e.hasOwnProperty("mobile")&&"boolean"!=typeof e.mobile?"mobile: boolean expected":null!=e.client&&e.hasOwnProperty("client")&&!r.isString(e.client)?"client: string expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.secret&&e.hasOwnProperty("secret")&&!r.isString(e.secret)?"secret: string expected":null},o.fromObject=function(e){if(e instanceof i.LoginResponse)return e;var t=new i.LoginResponse;return null!=e.username&&(t.username=String(e.username)),null!=e.protocol&&(t.protocol=e.protocol>>>0),null!=e.mobile&&(t.mobile=Boolean(e.mobile)),null!=e.client&&(t.client=String(e.client)),null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.secret&&(t.secret=String(e.secret)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.username="",n.protocol=0,n.mobile=!1,n.client="",n.uuid="",n.secret=""),null!=e.username&&e.hasOwnProperty("username")&&(n.username=e.username),null!=e.protocol&&e.hasOwnProperty("protocol")&&(n.protocol=e.protocol),null!=e.mobile&&e.hasOwnProperty("mobile")&&(n.mobile=e.mobile),null!=e.client&&e.hasOwnProperty("client")&&(n.client=e.client),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.secret&&e.hasOwnProperty("secret")&&(n.secret=e.secret),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionMove=function(){function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.x=0,r.prototype.y=0,r.prototype.z=0,r.prototype.rotation=0,r.prototype.pitch=0,r.create=function(e){return new r(e)},r.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(9).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(17).double(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(25).double(e.z),null!=e.rotation&&Object.hasOwnProperty.call(e,"rotation")&&t.uint32(37).float(e.rotation),null!=e.pitch&&Object.hasOwnProperty.call(e,"pitch")&&t.uint32(45).float(e.pitch),t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionMove;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.x=e.double();break;case 2:o.y=e.double();break;case 3:o.z=e.double();break;case 4:o.rotation=e.float();break;case 5:o.pitch=e.float();break;default:e.skipType(7&a)}}return o},r.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null!=e.rotation&&e.hasOwnProperty("rotation")&&"number"!=typeof e.rotation?"rotation: number expected":null!=e.pitch&&e.hasOwnProperty("pitch")&&"number"!=typeof e.pitch?"pitch: number expected":null},r.fromObject=function(e){if(e instanceof i.ActionMove)return e;var t=new i.ActionMove;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),null!=e.rotation&&(t.rotation=Number(e.rotation)),null!=e.pitch&&(t.pitch=Number(e.pitch)),t},r.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.rotation=0,n.pitch=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),null!=e.rotation&&e.hasOwnProperty("rotation")&&(n.rotation=t.json&&!isFinite(e.rotation)?String(e.rotation):e.rotation),null!=e.pitch&&e.hasOwnProperty("pitch")&&(n.pitch=t.json&&!isFinite(e.pitch)?String(e.pitch):e.pitch),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),i.ActionMessage=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.message="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(10).string(e.message),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionMessage;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.message=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.message&&e.hasOwnProperty("message")&&!r.isString(e.message)?"message: string expected":null},o.fromObject=function(e){if(e instanceof i.ActionMessage)return e;var t=new i.ActionMessage;return null!=e.message&&(t.message=String(e.message)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.message=""),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionBlockPlace=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.prototype.x2=0,o.prototype.y2=0,o.prototype.z2=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).sint32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).sint32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).sint32(e.z),null!=e.x2&&Object.hasOwnProperty.call(e,"x2")&&t.uint32(32).sint32(e.x2),null!=e.y2&&Object.hasOwnProperty.call(e,"y2")&&t.uint32(40).sint32(e.y2),null!=e.z2&&Object.hasOwnProperty.call(e,"z2")&&t.uint32(48).sint32(e.z2),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionBlockPlace;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.x=e.sint32();break;case 2:o.y=e.sint32();break;case 3:o.z=e.sint32();break;case 4:o.x2=e.sint32();break;case 5:o.y2=e.sint32();break;case 6:o.z2=e.sint32();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.x2&&e.hasOwnProperty("x2")&&!r.isInteger(e.x2)?"x2: integer expected":null!=e.y2&&e.hasOwnProperty("y2")&&!r.isInteger(e.y2)?"y2: integer expected":null!=e.z2&&e.hasOwnProperty("z2")&&!r.isInteger(e.z2)?"z2: integer expected":null},o.fromObject=function(e){if(e instanceof i.ActionBlockPlace)return e;var t=new i.ActionBlockPlace;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.x2&&(t.x2=0|e.x2),null!=e.y2&&(t.y2=0|e.y2),null!=e.z2&&(t.z2=0|e.z2),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.x2=0,n.y2=0,n.z2=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.x2&&e.hasOwnProperty("x2")&&(n.x2=e.x2),null!=e.y2&&e.hasOwnProperty("y2")&&(n.y2=e.y2),null!=e.z2&&e.hasOwnProperty("z2")&&(n.z2=e.z2),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionBlockBreak=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).sint32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).sint32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).sint32(e.z),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionBlockBreak;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.x=e.sint32();break;case 2:o.y=e.sint32();break;case 3:o.z=e.sint32();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null},o.fromObject=function(e){if(e instanceof i.ActionBlockBreak)return e;var t=new i.ActionBlockBreak;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionInventoryClick=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.slot=0,o.prototype.type="",o.prototype.inventory="",o.prototype.slot2=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.slot&&Object.hasOwnProperty.call(e,"slot")&&t.uint32(8).sint32(e.slot),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(26).string(e.inventory),null!=e.slot2&&Object.hasOwnProperty.call(e,"slot2")&&t.uint32(32).sint32(e.slot2),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionInventoryClick;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.slot=e.sint32();break;case 2:o.type=e.string();break;case 3:o.inventory=e.string();break;case 4:o.slot2=e.sint32();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.slot&&e.hasOwnProperty("slot")&&!r.isInteger(e.slot)?"slot: integer expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null!=e.slot2&&e.hasOwnProperty("slot2")&&!r.isInteger(e.slot2)?"slot2: integer expected":null},o.fromObject=function(e){if(e instanceof i.ActionInventoryClick)return e;var t=new i.ActionInventoryClick;return null!=e.slot&&(t.slot=0|e.slot),null!=e.type&&(t.type=String(e.type)),null!=e.inventory&&(t.inventory=String(e.inventory)),null!=e.slot2&&(t.slot2=0|e.slot2),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.slot=0,n.type="",n.inventory="",n.slot2=0),null!=e.slot&&e.hasOwnProperty("slot")&&(n.slot=e.slot),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),null!=e.slot2&&e.hasOwnProperty("slot2")&&(n.slot2=e.slot2),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionInventoryOpen=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.inventory="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(10).string(e.inventory),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionInventoryOpen;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.inventory=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null},o.fromObject=function(e){if(e instanceof i.ActionInventoryOpen)return e;var t=new i.ActionInventoryOpen;return null!=e.inventory&&(t.inventory=String(e.inventory)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.inventory=""),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionInventoryClose=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.inventory="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(10).string(e.inventory),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionInventoryClose;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.inventory=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null},o.fromObject=function(e){if(e instanceof i.ActionInventoryClose)return e;var t=new i.ActionInventoryClose;return null!=e.inventory&&(t.inventory=String(e.inventory)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.inventory=""),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionClick=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.prototype.type="",o.prototype.onBlock=!1,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).sint32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).sint32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).sint32(e.z),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(34).string(e.type),null!=e.onBlock&&Object.hasOwnProperty.call(e,"onBlock")&&t.uint32(40).bool(e.onBlock),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionClick;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.x=e.sint32();break;case 2:o.y=e.sint32();break;case 3:o.z=e.sint32();break;case 4:o.type=e.string();break;case 5:o.onBlock=e.bool();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.onBlock&&e.hasOwnProperty("onBlock")&&"boolean"!=typeof e.onBlock?"onBlock: boolean expected":null},o.fromObject=function(e){if(e instanceof i.ActionClick)return e;var t=new i.ActionClick;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.type&&(t.type=String(e.type)),null!=e.onBlock&&(t.onBlock=Boolean(e.onBlock)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.type="",n.onBlock=!1),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.onBlock&&e.hasOwnProperty("onBlock")&&(n.onBlock=e.onBlock),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionClickEntity=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.prototype.type="",o.prototype.distance=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),null!=e.distance&&Object.hasOwnProperty.call(e,"distance")&&t.uint32(29).float(e.distance),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionClickEntity;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.uuid=e.string();break;case 2:o.type=e.string();break;case 3:o.distance=e.float();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.distance&&e.hasOwnProperty("distance")&&"number"!=typeof e.distance?"distance: number expected":null},o.fromObject=function(e){if(e instanceof i.ActionClickEntity)return e;var t=new i.ActionClickEntity;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.type&&(t.type=String(e.type)),null!=e.distance&&(t.distance=Number(e.distance)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.type="",n.distance=0),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.distance&&e.hasOwnProperty("distance")&&(n.distance=t.json&&!isFinite(e.distance)?String(e.distance):e.distance),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PluginMessage=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.key="",o.prototype.version=0,o.prototype.value="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(16).uint32(e.version),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(26).string(e.value),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PluginMessage;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.key=e.string();break;case 2:o.version=e.uint32();break;case 3:o.value=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.version&&e.hasOwnProperty("version")&&!r.isInteger(e.version)?"version: integer expected":null!=e.value&&e.hasOwnProperty("value")&&!r.isString(e.value)?"value: string expected":null},o.fromObject=function(e){if(e instanceof i.PluginMessage)return e;var t=new i.PluginMessage;return null!=e.key&&(t.key=String(e.key)),null!=e.version&&(t.version=e.version>>>0),null!=e.value&&(t.value=String(e.value)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.version=0,n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.version&&e.hasOwnProperty("version")&&(n.version=e.version),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i})?r.apply(t,i):r)||(e.exports=o)},function(e,t,n){"use strict";var r=t;function i(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(250),r.BufferWriter=n(348),r.Reader=n(251),r.BufferReader=n(349),r.util=n(131),r.rpc=n(350),r.roots=n(352),r.configure=i,i()},function(e,t,n){"use strict";e.exports=function(e,t){var n=new Array(arguments.length-1),r=0,i=2,o=!0;for(;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))}},function(e,t,n){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var i=new Array(64),o=new Array(123),a=0;a<64;)o[i[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;r.encode=function(e,t,n){for(var r,o=null,a=[],s=0,c=0;t<n;){var u=e[t++];switch(c){case 0:a[s++]=i[u>>2],r=(3&u)<<4,c=1;break;case 1:a[s++]=i[r|u>>4],r=(15&u)<<2,c=2;break;case 2:a[s++]=i[r|u>>6],a[s++]=i[63&u],c=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=i[r],a[s++]=61,1===c&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))};r.decode=function(e,t,n){for(var r,i=n,a=0,s=0;s<e.length;){var c=e.charCodeAt(s++);if(61===c&&a>1)break;if(void 0===(c=o[c]))throw Error("invalid encoding");switch(a){case 0:r=c,a=1;break;case 1:t[n++]=r<<2|(48&c)>>4,r=c,a=2;break;case 2:t[n++]=(15&r)<<4|(60&c)>>2,r=c,a=3;break;case 3:t[n++]=(3&r)<<6|c,a=0}}if(1===a)throw Error("invalid encoding");return n-i},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,n){"use strict";function r(){this._listeners={}}e.exports=r,r.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},function(e,t,n){"use strict";function r(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:o,e.writeFloatBE=r?o:i,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),i=2*(r>>31)+1,o=r>>>23&255,a=8388607&r;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,o),e.readFloatLE=n.bind(null,a),e.readFloatBE=n.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:o,e.writeDoubleBE=r?o:i,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,n,r,i,o){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,i,o+t),e(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(r>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=r*Math.pow(2,-c))>>>0,i,o+t),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,i,o+n)}}}function n(e,t,n,r,i){var o=e(r,i+t),a=e(r,i+n),s=2*(a>>31)+1,c=a>>>20&2047,u=4294967296*(1048575&a)+o;return 2047===c?u?NaN:s*(1/0):0===c?5e-324*s*u:s*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,o,4,0),e.readDoubleLE=n.bind(null,a,0,4),e.readDoubleBE=n.bind(null,s,4,0)}(),e}function i(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function o(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function a(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=r(r)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,n){"use strict";var r=t;r.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},r.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,o=[],a=0;t<n;)(r=e[t++])<128?o[a++]=r:r>191&&r<224?o[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},r.write=function(e,t,n){for(var r,i,o=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-o}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r=n||8192,i=r>>>1,o=null,a=r;return function(n){if(n<1||n>i)return e(n);a+n>r&&(o=e(r),a=0);var s=t.call(o,a,a+=n);return 7&a&&(a=1+(7|a)),s}}},function(e,t,n){"use strict";e.exports=i;var r=n(131);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var a=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(r.isString(e)){if(!r.Long)return i.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;i.fromHash=function(e){return e===a?o:new i((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},function(e,t,n){"use strict";e.exports=o;var r=n(250);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(131);function o(){r.call(this)}function a(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},o._configure()},function(e,t,n){"use strict";e.exports=o;var r=n(251);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(131);function o(e){r.call(this,e)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},function(e,t,n){"use strict";t.Service=n(351)},function(e,t,n){"use strict";e.exports=i;var r=n(131);function i(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,n,i,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return r.asPromise(e,s,t,n,i,o);if(s.rpcImpl)try{return s.rpcImpl(t,n[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return s.emit("error",e,t),a(e);if(null!==n){if(!(n instanceof i))try{n=i[s.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",n,t),a(null,n)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){var r,i,o;i=[n(249)],void 0===(o="function"==typeof(r=function(e){"use strict";var t=e.Reader,n=e.Writer,r=e.util,i=e.roots.default||(e.roots.default={});return i.LoginRequest=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.name="",o.prototype.protocol=0,o.prototype.maxplayers=0,o.prototype.numberplayers=0,o.prototype.motd="",o.prototype.software="",o.prototype.auth=!1,o.prototype.secret="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.protocol&&Object.hasOwnProperty.call(e,"protocol")&&t.uint32(16).uint32(e.protocol),null!=e.maxplayers&&Object.hasOwnProperty.call(e,"maxplayers")&&t.uint32(24).uint32(e.maxplayers),null!=e.numberplayers&&Object.hasOwnProperty.call(e,"numberplayers")&&t.uint32(32).uint32(e.numberplayers),null!=e.motd&&Object.hasOwnProperty.call(e,"motd")&&t.uint32(42).string(e.motd),null!=e.software&&Object.hasOwnProperty.call(e,"software")&&t.uint32(50).string(e.software),null!=e.auth&&Object.hasOwnProperty.call(e,"auth")&&t.uint32(56).bool(e.auth),null!=e.secret&&Object.hasOwnProperty.call(e,"secret")&&t.uint32(66).string(e.secret),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.LoginRequest;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.name=e.string();break;case 2:o.protocol=e.uint32();break;case 3:o.maxplayers=e.uint32();break;case 4:o.numberplayers=e.uint32();break;case 5:o.motd=e.string();break;case 6:o.software=e.string();break;case 7:o.auth=e.bool();break;case 8:o.secret=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.name&&e.hasOwnProperty("name")&&!r.isString(e.name)?"name: string expected":null!=e.protocol&&e.hasOwnProperty("protocol")&&!r.isInteger(e.protocol)?"protocol: integer expected":null!=e.maxplayers&&e.hasOwnProperty("maxplayers")&&!r.isInteger(e.maxplayers)?"maxplayers: integer expected":null!=e.numberplayers&&e.hasOwnProperty("numberplayers")&&!r.isInteger(e.numberplayers)?"numberplayers: integer expected":null!=e.motd&&e.hasOwnProperty("motd")&&!r.isString(e.motd)?"motd: string expected":null!=e.software&&e.hasOwnProperty("software")&&!r.isString(e.software)?"software: string expected":null!=e.auth&&e.hasOwnProperty("auth")&&"boolean"!=typeof e.auth?"auth: boolean expected":null!=e.secret&&e.hasOwnProperty("secret")&&!r.isString(e.secret)?"secret: string expected":null},o.fromObject=function(e){if(e instanceof i.LoginRequest)return e;var t=new i.LoginRequest;return null!=e.name&&(t.name=String(e.name)),null!=e.protocol&&(t.protocol=e.protocol>>>0),null!=e.maxplayers&&(t.maxplayers=e.maxplayers>>>0),null!=e.numberplayers&&(t.numberplayers=e.numberplayers>>>0),null!=e.motd&&(t.motd=String(e.motd)),null!=e.software&&(t.software=String(e.software)),null!=e.auth&&(t.auth=Boolean(e.auth)),null!=e.secret&&(t.secret=String(e.secret)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.name="",n.protocol=0,n.maxplayers=0,n.numberplayers=0,n.motd="",n.software="",n.auth=!1,n.secret=""),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.protocol&&e.hasOwnProperty("protocol")&&(n.protocol=e.protocol),null!=e.maxplayers&&e.hasOwnProperty("maxplayers")&&(n.maxplayers=e.maxplayers),null!=e.numberplayers&&e.hasOwnProperty("numberplayers")&&(n.numberplayers=e.numberplayers),null!=e.motd&&e.hasOwnProperty("motd")&&(n.motd=e.motd),null!=e.software&&e.hasOwnProperty("software")&&(n.software=e.software),null!=e.auth&&e.hasOwnProperty("auth")&&(n.auth=e.auth),null!=e.secret&&e.hasOwnProperty("secret")&&(n.secret=e.secret),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.LoginSuccess=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.xPos=0,o.prototype.yPos=0,o.prototype.zPos=0,o.prototype.itemsDef="",o.prototype.blocksDef="",o.prototype.inventory="",o.prototype.armor="",o.prototype.movement="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.xPos&&Object.hasOwnProperty.call(e,"xPos")&&t.uint32(9).double(e.xPos),null!=e.yPos&&Object.hasOwnProperty.call(e,"yPos")&&t.uint32(17).double(e.yPos),null!=e.zPos&&Object.hasOwnProperty.call(e,"zPos")&&t.uint32(25).double(e.zPos),null!=e.itemsDef&&Object.hasOwnProperty.call(e,"itemsDef")&&t.uint32(34).string(e.itemsDef),null!=e.blocksDef&&Object.hasOwnProperty.call(e,"blocksDef")&&t.uint32(42).string(e.blocksDef),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(50).string(e.inventory),null!=e.armor&&Object.hasOwnProperty.call(e,"armor")&&t.uint32(58).string(e.armor),null!=e.movement&&Object.hasOwnProperty.call(e,"movement")&&t.uint32(66).string(e.movement),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.LoginSuccess;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.xPos=e.double();break;case 2:o.yPos=e.double();break;case 3:o.zPos=e.double();break;case 4:o.itemsDef=e.string();break;case 5:o.blocksDef=e.string();break;case 6:o.inventory=e.string();break;case 7:o.armor=e.string();break;case 8:o.movement=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.xPos&&e.hasOwnProperty("xPos")&&"number"!=typeof e.xPos?"xPos: number expected":null!=e.yPos&&e.hasOwnProperty("yPos")&&"number"!=typeof e.yPos?"yPos: number expected":null!=e.zPos&&e.hasOwnProperty("zPos")&&"number"!=typeof e.zPos?"zPos: number expected":null!=e.itemsDef&&e.hasOwnProperty("itemsDef")&&!r.isString(e.itemsDef)?"itemsDef: string expected":null!=e.blocksDef&&e.hasOwnProperty("blocksDef")&&!r.isString(e.blocksDef)?"blocksDef: string expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null!=e.armor&&e.hasOwnProperty("armor")&&!r.isString(e.armor)?"armor: string expected":null!=e.movement&&e.hasOwnProperty("movement")&&!r.isString(e.movement)?"movement: string expected":null},o.fromObject=function(e){if(e instanceof i.LoginSuccess)return e;var t=new i.LoginSuccess;return null!=e.xPos&&(t.xPos=Number(e.xPos)),null!=e.yPos&&(t.yPos=Number(e.yPos)),null!=e.zPos&&(t.zPos=Number(e.zPos)),null!=e.itemsDef&&(t.itemsDef=String(e.itemsDef)),null!=e.blocksDef&&(t.blocksDef=String(e.blocksDef)),null!=e.inventory&&(t.inventory=String(e.inventory)),null!=e.armor&&(t.armor=String(e.armor)),null!=e.movement&&(t.movement=String(e.movement)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.xPos=0,n.yPos=0,n.zPos=0,n.itemsDef="",n.blocksDef="",n.inventory="",n.armor="",n.movement=""),null!=e.xPos&&e.hasOwnProperty("xPos")&&(n.xPos=t.json&&!isFinite(e.xPos)?String(e.xPos):e.xPos),null!=e.yPos&&e.hasOwnProperty("yPos")&&(n.yPos=t.json&&!isFinite(e.yPos)?String(e.yPos):e.yPos),null!=e.zPos&&e.hasOwnProperty("zPos")&&(n.zPos=t.json&&!isFinite(e.zPos)?String(e.zPos):e.zPos),null!=e.itemsDef&&e.hasOwnProperty("itemsDef")&&(n.itemsDef=e.itemsDef),null!=e.blocksDef&&e.hasOwnProperty("blocksDef")&&(n.blocksDef=e.blocksDef),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),null!=e.armor&&e.hasOwnProperty("armor")&&(n.armor=e.armor),null!=e.movement&&e.hasOwnProperty("movement")&&(n.movement=e.movement),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerKick=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.reason="",o.prototype.time=r.Long?r.Long.fromBits(0,0,!0):0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(10).string(e.reason),null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(16).uint64(e.time),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerKick;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.reason=e.string();break;case 2:o.time=e.uint64();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.reason&&e.hasOwnProperty("reason")&&!r.isString(e.reason)?"reason: string expected":null!=e.time&&e.hasOwnProperty("time")&&!(r.isInteger(e.time)||e.time&&r.isInteger(e.time.low)&&r.isInteger(e.time.high))?"time: integer|Long expected":null},o.fromObject=function(e){if(e instanceof i.PlayerKick)return e;var t=new i.PlayerKick;return null!=e.reason&&(t.reason=String(e.reason)),null!=e.time&&(r.Long?(t.time=r.Long.fromValue(e.time)).unsigned=!0:"string"==typeof e.time?t.time=parseInt(e.time,10):"number"==typeof e.time?t.time=e.time:"object"==typeof e.time&&(t.time=new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0))),t},o.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.reason="",r.Long){var i=new r.Long(0,0,!0);n.time=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.time=t.longs===String?"0":0;return null!=e.reason&&e.hasOwnProperty("reason")&&(n.reason=e.reason),null!=e.time&&e.hasOwnProperty("time")&&("number"==typeof e.time?n.time=t.longs===String?String(e.time):e.time:n.time=t.longs===String?r.Long.prototype.toString.call(e.time):t.longs===Number?new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0):e.time),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerEntity=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.prototype.model="",o.prototype.texture="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.model&&Object.hasOwnProperty.call(e,"model")&&t.uint32(18).string(e.model),null!=e.texture&&Object.hasOwnProperty.call(e,"texture")&&t.uint32(26).string(e.texture),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerEntity;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.uuid=e.string();break;case 2:o.model=e.string();break;case 3:o.texture=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.model&&e.hasOwnProperty("model")&&!r.isString(e.model)?"model: string expected":null!=e.texture&&e.hasOwnProperty("texture")&&!r.isString(e.texture)?"texture: string expected":null},o.fromObject=function(e){if(e instanceof i.PlayerEntity)return e;var t=new i.PlayerEntity;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.model&&(t.model=String(e.model)),null!=e.texture&&(t.texture=String(e.texture)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.model="",n.texture=""),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.model&&e.hasOwnProperty("model")&&(n.model=e.model),null!=e.texture&&e.hasOwnProperty("texture")&&(n.texture=e.texture),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerTeleport=function(){function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.x=0,r.prototype.y=0,r.prototype.z=0,r.create=function(e){return new r(e)},r.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(9).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(17).double(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(25).double(e.z),t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerTeleport;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.x=e.double();break;case 2:o.y=e.double();break;case 3:o.z=e.double();break;default:e.skipType(7&a)}}return o},r.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null},r.fromObject=function(e){if(e instanceof i.PlayerTeleport)return e;var t=new i.PlayerTeleport;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),t},r.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),i.PlayerInventory=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.type="",o.prototype.inventory="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(10).string(e.type),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(18).string(e.inventory),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerInventory;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.type=e.string();break;case 2:o.inventory=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null},o.fromObject=function(e){if(e instanceof i.PlayerInventory)return e;var t=new i.PlayerInventory;return null!=e.type&&(t.type=String(e.type)),null!=e.inventory&&(t.inventory=String(e.inventory)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.type="",n.inventory=""),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerSlotUpdate=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.slot=0,o.prototype.type="",o.prototype.data="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.slot&&Object.hasOwnProperty.call(e,"slot")&&t.uint32(8).uint32(e.slot),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(26).string(e.data),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerSlotUpdate;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.slot=e.uint32();break;case 2:o.type=e.string();break;case 3:o.data=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.slot&&e.hasOwnProperty("slot")&&!r.isInteger(e.slot)?"slot: integer expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.data&&e.hasOwnProperty("data")&&!r.isString(e.data)?"data: string expected":null},o.fromObject=function(e){if(e instanceof i.PlayerSlotUpdate)return e;var t=new i.PlayerSlotUpdate;return null!=e.slot&&(t.slot=e.slot>>>0),null!=e.type&&(t.type=String(e.type)),null!=e.data&&(t.data=String(e.data)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.slot=0,n.type="",n.data=""),null!=e.slot&&e.hasOwnProperty("slot")&&(n.slot=e.slot),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.data&&e.hasOwnProperty("data")&&(n.data=e.data),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerApplyImpulse=function(){function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.x=0,r.prototype.y=0,r.prototype.z=0,r.create=function(e){return new r(e)},r.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(13).float(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(21).float(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(29).float(e.z),t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerApplyImpulse;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.x=e.float();break;case 2:o.y=e.float();break;case 3:o.z=e.float();break;default:e.skipType(7&a)}}return o},r.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null},r.fromObject=function(e){if(e instanceof i.PlayerApplyImpulse)return e;var t=new i.PlayerApplyImpulse;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),t},r.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),i.PlayerUpdateMovement=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.key="",o.prototype.value=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(17).double(e.value),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerUpdateMovement;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.key=e.string();break;case 2:o.value=e.double();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&"number"!=typeof e.value?"value: number expected":null},o.fromObject=function(e){if(e instanceof i.PlayerUpdateMovement)return e;var t=new i.PlayerUpdateMovement;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=Number(e.value)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=0),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=t.json&&!isFinite(e.value)?String(e.value):e.value),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerUpdatePhysics=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.key="",o.prototype.value=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(17).double(e.value),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerUpdatePhysics;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.key=e.string();break;case 2:o.value=e.double();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&"number"!=typeof e.value?"value: number expected":null},o.fromObject=function(e){if(e instanceof i.PlayerUpdatePhysics)return e;var t=new i.PlayerUpdatePhysics;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=Number(e.value)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=0),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=t.json&&!isFinite(e.value)?String(e.value):e.value),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerHealth=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.value=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(8).sint32(e.value),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerHealth;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.value=e.sint32();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.value&&e.hasOwnProperty("value")&&!r.isInteger(e.value)?"value: integer expected":null},o.fromObject=function(e){if(e instanceof i.PlayerHealth)return e;var t=new i.PlayerHealth;return null!=e.value&&(t.value=0|e.value),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.value=0),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerOpenInventory=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.name="",o.prototype.type="",o.prototype.data="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(26).string(e.data),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerOpenInventory;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.name=e.string();break;case 2:o.type=e.string();break;case 3:o.data=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.name&&e.hasOwnProperty("name")&&!r.isString(e.name)?"name: string expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.data&&e.hasOwnProperty("data")&&!r.isString(e.data)?"data: string expected":null},o.fromObject=function(e){if(e instanceof i.PlayerOpenInventory)return e;var t=new i.PlayerOpenInventory;return null!=e.name&&(t.name=String(e.name)),null!=e.type&&(t.type=String(e.type)),null!=e.data&&(t.data=String(e.data)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.name="",n.type="",n.data=""),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.data&&e.hasOwnProperty("data")&&(n.data=e.data),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.SoundPlay=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.sound="",o.prototype.volume=0,o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.sound&&Object.hasOwnProperty.call(e,"sound")&&t.uint32(10).string(e.sound),null!=e.volume&&Object.hasOwnProperty.call(e,"volume")&&t.uint32(16).uint32(e.volume),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(25).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(33).double(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(41).double(e.z),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.SoundPlay;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.sound=e.string();break;case 2:o.volume=e.uint32();break;case 3:o.x=e.double();break;case 4:o.y=e.double();break;case 5:o.z=e.double();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.sound&&e.hasOwnProperty("sound")&&!r.isString(e.sound)?"sound: string expected":null!=e.volume&&e.hasOwnProperty("volume")&&!r.isInteger(e.volume)?"volume: integer expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null},o.fromObject=function(e){if(e instanceof i.SoundPlay)return e;var t=new i.SoundPlay;return null!=e.sound&&(t.sound=String(e.sound)),null!=e.volume&&(t.volume=e.volume>>>0),null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.sound="",n.volume=0,n.x=0,n.y=0,n.z=0),null!=e.sound&&e.hasOwnProperty("sound")&&(n.sound=e.sound),null!=e.volume&&e.hasOwnProperty("volume")&&(n.volume=e.volume),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ChatMessage=function(){function o(e){if(this.message={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.message=r.emptyObject,o.prototype.time=r.Long?r.Long.fromBits(0,0,!0):0,o.create=function(e){return new o(e)},o.encode=function(e,t){if(t||(t=n.create()),null!=e.message&&Object.hasOwnProperty.call(e,"message"))for(var r=Object.keys(e.message),o=0;o<r.length;++o)t.uint32(10).fork().uint32(8).uint32(r[o]),i.ChatMessage.ChatComponent.encode(e.message[r[o]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(16).uint64(e.time),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var o,a,s=void 0===n?e.len:e.pos+n,c=new i.ChatMessage;e.pos<s;){var u=e.uint32();switch(u>>>3){case 1:c.message===r.emptyObject&&(c.message={});var l=e.uint32()+e.pos;for(o=0,a=null;e.pos<l;){var f=e.uint32();switch(f>>>3){case 1:o=e.uint32();break;case 2:a=i.ChatMessage.ChatComponent.decode(e,e.uint32());break;default:e.skipType(7&f)}}c.message[o]=a;break;case 2:c.time=e.uint64();break;default:e.skipType(7&u)}}return c},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.message&&e.hasOwnProperty("message")){if(!r.isObject(e.message))return"message: object expected";for(var t=Object.keys(e.message),n=0;n<t.length;++n){if(!r.key32Re.test(t[n]))return"message: integer key{k:uint32} expected";var o=i.ChatMessage.ChatComponent.verify(e.message[t[n]]);if(o)return"message."+o}}return null!=e.time&&e.hasOwnProperty("time")&&!(r.isInteger(e.time)||e.time&&r.isInteger(e.time.low)&&r.isInteger(e.time.high))?"time: integer|Long expected":null},o.fromObject=function(e){if(e instanceof i.ChatMessage)return e;var t=new i.ChatMessage;if(e.message){if("object"!=typeof e.message)throw TypeError(".ChatMessage.message: object expected");t.message={};for(var n=Object.keys(e.message),o=0;o<n.length;++o){if("object"!=typeof e.message[n[o]])throw TypeError(".ChatMessage.message: object expected");t.message[n[o]]=i.ChatMessage.ChatComponent.fromObject(e.message[n[o]])}}return null!=e.time&&(r.Long?(t.time=r.Long.fromValue(e.time)).unsigned=!0:"string"==typeof e.time?t.time=parseInt(e.time,10):"number"==typeof e.time?t.time=e.time:"object"==typeof e.time&&(t.time=new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0))),t},o.toObject=function(e,t){t||(t={});var n,o={};if((t.objects||t.defaults)&&(o.message={}),t.defaults)if(r.Long){var a=new r.Long(0,0,!0);o.time=t.longs===String?a.toString():t.longs===Number?a.toNumber():a}else o.time=t.longs===String?"0":0;if(e.message&&(n=Object.keys(e.message)).length){o.message={};for(var s=0;s<n.length;++s)o.message[n[s]]=i.ChatMessage.ChatComponent.toObject(e.message[n[s]],t)}return null!=e.time&&e.hasOwnProperty("time")&&("number"==typeof e.time?o.time=t.longs===String?String(e.time):e.time:o.time=t.longs===String?r.Long.prototype.toString.call(e.time):t.longs===Number?new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0):e.time),o},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o.ChatComponent=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.text="",o.prototype.font="",o.prototype.color="",o.prototype.linethrough=!1,o.prototype.underline=!1,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.text&&Object.hasOwnProperty.call(e,"text")&&t.uint32(10).string(e.text),null!=e.font&&Object.hasOwnProperty.call(e,"font")&&t.uint32(18).string(e.font),null!=e.color&&Object.hasOwnProperty.call(e,"color")&&t.uint32(26).string(e.color),null!=e.linethrough&&Object.hasOwnProperty.call(e,"linethrough")&&t.uint32(32).bool(e.linethrough),null!=e.underline&&Object.hasOwnProperty.call(e,"underline")&&t.uint32(40).bool(e.underline),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ChatMessage.ChatComponent;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.text=e.string();break;case 2:o.font=e.string();break;case 3:o.color=e.string();break;case 4:o.linethrough=e.bool();break;case 5:o.underline=e.bool();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.text&&e.hasOwnProperty("text")&&!r.isString(e.text)?"text: string expected":null!=e.font&&e.hasOwnProperty("font")&&!r.isString(e.font)?"font: string expected":null!=e.color&&e.hasOwnProperty("color")&&!r.isString(e.color)?"color: string expected":null!=e.linethrough&&e.hasOwnProperty("linethrough")&&"boolean"!=typeof e.linethrough?"linethrough: boolean expected":null!=e.underline&&e.hasOwnProperty("underline")&&"boolean"!=typeof e.underline?"underline: boolean expected":null},o.fromObject=function(e){if(e instanceof i.ChatMessage.ChatComponent)return e;var t=new i.ChatMessage.ChatComponent;return null!=e.text&&(t.text=String(e.text)),null!=e.font&&(t.font=String(e.font)),null!=e.color&&(t.color=String(e.color)),null!=e.linethrough&&(t.linethrough=Boolean(e.linethrough)),null!=e.underline&&(t.underline=Boolean(e.underline)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.text="",n.font="",n.color="",n.linethrough=!1,n.underline=!1),null!=e.text&&e.hasOwnProperty("text")&&(n.text=e.text),null!=e.font&&e.hasOwnProperty("font")&&(n.font=e.font),null!=e.color&&e.hasOwnProperty("color")&&(n.color=e.color),null!=e.linethrough&&e.hasOwnProperty("linethrough")&&(n.linethrough=e.linethrough),null!=e.underline&&e.hasOwnProperty("underline")&&(n.underline=e.underline),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),o}(),i.TabUpdate=function(){function o(e){if(this.message={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.message=r.emptyObject,o.prototype.time=r.Long?r.Long.fromBits(0,0,!0):0,o.create=function(e){return new o(e)},o.encode=function(e,t){if(t||(t=n.create()),null!=e.message&&Object.hasOwnProperty.call(e,"message"))for(var r=Object.keys(e.message),o=0;o<r.length;++o)t.uint32(10).fork().uint32(8).uint32(r[o]),i.TabUpdate.ChatComponent.encode(e.message[r[o]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(16).uint64(e.time),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var o,a,s=void 0===n?e.len:e.pos+n,c=new i.TabUpdate;e.pos<s;){var u=e.uint32();switch(u>>>3){case 1:c.message===r.emptyObject&&(c.message={});var l=e.uint32()+e.pos;for(o=0,a=null;e.pos<l;){var f=e.uint32();switch(f>>>3){case 1:o=e.uint32();break;case 2:a=i.TabUpdate.ChatComponent.decode(e,e.uint32());break;default:e.skipType(7&f)}}c.message[o]=a;break;case 2:c.time=e.uint64();break;default:e.skipType(7&u)}}return c},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.message&&e.hasOwnProperty("message")){if(!r.isObject(e.message))return"message: object expected";for(var t=Object.keys(e.message),n=0;n<t.length;++n){if(!r.key32Re.test(t[n]))return"message: integer key{k:uint32} expected";var o=i.TabUpdate.ChatComponent.verify(e.message[t[n]]);if(o)return"message."+o}}return null!=e.time&&e.hasOwnProperty("time")&&!(r.isInteger(e.time)||e.time&&r.isInteger(e.time.low)&&r.isInteger(e.time.high))?"time: integer|Long expected":null},o.fromObject=function(e){if(e instanceof i.TabUpdate)return e;var t=new i.TabUpdate;if(e.message){if("object"!=typeof e.message)throw TypeError(".TabUpdate.message: object expected");t.message={};for(var n=Object.keys(e.message),o=0;o<n.length;++o){if("object"!=typeof e.message[n[o]])throw TypeError(".TabUpdate.message: object expected");t.message[n[o]]=i.TabUpdate.ChatComponent.fromObject(e.message[n[o]])}}return null!=e.time&&(r.Long?(t.time=r.Long.fromValue(e.time)).unsigned=!0:"string"==typeof e.time?t.time=parseInt(e.time,10):"number"==typeof e.time?t.time=e.time:"object"==typeof e.time&&(t.time=new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0))),t},o.toObject=function(e,t){t||(t={});var n,o={};if((t.objects||t.defaults)&&(o.message={}),t.defaults)if(r.Long){var a=new r.Long(0,0,!0);o.time=t.longs===String?a.toString():t.longs===Number?a.toNumber():a}else o.time=t.longs===String?"0":0;if(e.message&&(n=Object.keys(e.message)).length){o.message={};for(var s=0;s<n.length;++s)o.message[n[s]]=i.TabUpdate.ChatComponent.toObject(e.message[n[s]],t)}return null!=e.time&&e.hasOwnProperty("time")&&("number"==typeof e.time?o.time=t.longs===String?String(e.time):e.time:o.time=t.longs===String?r.Long.prototype.toString.call(e.time):t.longs===Number?new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0):e.time),o},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o.ChatComponent=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.text="",o.prototype.font="",o.prototype.color="",o.prototype.linethrough=!1,o.prototype.underline=!1,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.text&&Object.hasOwnProperty.call(e,"text")&&t.uint32(10).string(e.text),null!=e.font&&Object.hasOwnProperty.call(e,"font")&&t.uint32(18).string(e.font),null!=e.color&&Object.hasOwnProperty.call(e,"color")&&t.uint32(26).string(e.color),null!=e.linethrough&&Object.hasOwnProperty.call(e,"linethrough")&&t.uint32(32).bool(e.linethrough),null!=e.underline&&Object.hasOwnProperty.call(e,"underline")&&t.uint32(40).bool(e.underline),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.TabUpdate.ChatComponent;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.text=e.string();break;case 2:o.font=e.string();break;case 3:o.color=e.string();break;case 4:o.linethrough=e.bool();break;case 5:o.underline=e.bool();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.text&&e.hasOwnProperty("text")&&!r.isString(e.text)?"text: string expected":null!=e.font&&e.hasOwnProperty("font")&&!r.isString(e.font)?"font: string expected":null!=e.color&&e.hasOwnProperty("color")&&!r.isString(e.color)?"color: string expected":null!=e.linethrough&&e.hasOwnProperty("linethrough")&&"boolean"!=typeof e.linethrough?"linethrough: boolean expected":null!=e.underline&&e.hasOwnProperty("underline")&&"boolean"!=typeof e.underline?"underline: boolean expected":null},o.fromObject=function(e){if(e instanceof i.TabUpdate.ChatComponent)return e;var t=new i.TabUpdate.ChatComponent;return null!=e.text&&(t.text=String(e.text)),null!=e.font&&(t.font=String(e.font)),null!=e.color&&(t.color=String(e.color)),null!=e.linethrough&&(t.linethrough=Boolean(e.linethrough)),null!=e.underline&&(t.underline=Boolean(e.underline)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.text="",n.font="",n.color="",n.linethrough=!1,n.underline=!1),null!=e.text&&e.hasOwnProperty("text")&&(n.text=e.text),null!=e.font&&e.hasOwnProperty("font")&&(n.font=e.font),null!=e.color&&e.hasOwnProperty("color")&&(n.color=e.color),null!=e.linethrough&&e.hasOwnProperty("linethrough")&&(n.linethrough=e.linethrough),null!=e.underline&&e.hasOwnProperty("underline")&&(n.underline=e.underline),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),o}(),i.EntityCreate=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.prototype.data="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).string(e.data),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.EntityCreate;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.uuid=e.string();break;case 2:o.data=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.data&&e.hasOwnProperty("data")&&!r.isString(e.data)?"data: string expected":null},o.fromObject=function(e){if(e instanceof i.EntityCreate)return e;var t=new i.EntityCreate;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.data&&(t.data=String(e.data)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.data=""),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.data&&e.hasOwnProperty("data")&&(n.data=e.data),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.EntityRemove=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.EntityRemove;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.uuid=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null},o.fromObject=function(e){if(e instanceof i.EntityRemove)return e;var t=new i.EntityRemove;return null!=e.uuid&&(t.uuid=String(e.uuid)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid=""),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.EntityMove=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.prototype.rotation=0,o.prototype.pitch=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(17).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(25).double(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(33).double(e.z),null!=e.rotation&&Object.hasOwnProperty.call(e,"rotation")&&t.uint32(45).float(e.rotation),null!=e.pitch&&Object.hasOwnProperty.call(e,"pitch")&&t.uint32(53).float(e.pitch),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.EntityMove;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.uuid=e.string();break;case 2:o.x=e.double();break;case 3:o.y=e.double();break;case 4:o.z=e.double();break;case 5:o.rotation=e.float();break;case 6:o.pitch=e.float();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null!=e.rotation&&e.hasOwnProperty("rotation")&&"number"!=typeof e.rotation?"rotation: number expected":null!=e.pitch&&e.hasOwnProperty("pitch")&&"number"!=typeof e.pitch?"pitch: number expected":null},o.fromObject=function(e){if(e instanceof i.EntityMove)return e;var t=new i.EntityMove;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),null!=e.rotation&&(t.rotation=Number(e.rotation)),null!=e.pitch&&(t.pitch=Number(e.pitch)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.x=0,n.y=0,n.z=0,n.rotation=0,n.pitch=0),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),null!=e.rotation&&e.hasOwnProperty("rotation")&&(n.rotation=t.json&&!isFinite(e.rotation)?String(e.rotation):e.rotation),null!=e.pitch&&e.hasOwnProperty("pitch")&&(n.pitch=t.json&&!isFinite(e.pitch)?String(e.pitch):e.pitch),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.EntityUpdate=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.prototype.key="",o.prototype.value="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(18).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(26).string(e.value),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.EntityUpdate;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.uuid=e.string();break;case 2:o.key=e.string();break;case 3:o.value=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!r.isString(e.value)?"value: string expected":null},o.fromObject=function(e){if(e instanceof i.EntityUpdate)return e;var t=new i.EntityUpdate;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.key="",n.value=""),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.EntityAnimate=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.prototype.animation="",o.prototype.time=0,o.prototype.replace=!1,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.animation&&Object.hasOwnProperty.call(e,"animation")&&t.uint32(18).string(e.animation),null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(24).uint32(e.time),null!=e.replace&&Object.hasOwnProperty.call(e,"replace")&&t.uint32(32).bool(e.replace),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.EntityAnimate;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.uuid=e.string();break;case 2:o.animation=e.string();break;case 3:o.time=e.uint32();break;case 4:o.replace=e.bool();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.animation&&e.hasOwnProperty("animation")&&!r.isString(e.animation)?"animation: string expected":null!=e.time&&e.hasOwnProperty("time")&&!r.isInteger(e.time)?"time: integer expected":null!=e.replace&&e.hasOwnProperty("replace")&&"boolean"!=typeof e.replace?"replace: boolean expected":null},o.fromObject=function(e){if(e instanceof i.EntityAnimate)return e;var t=new i.EntityAnimate;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.animation&&(t.animation=String(e.animation)),null!=e.time&&(t.time=e.time>>>0),null!=e.replace&&(t.replace=Boolean(e.replace)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.animation="",n.time=0,n.replace=!1),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.animation&&e.hasOwnProperty("animation")&&(n.animation=e.animation),null!=e.time&&e.hasOwnProperty("time")&&(n.time=e.time),null!=e.replace&&e.hasOwnProperty("replace")&&(n.replace=e.replace),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.WorldBlockUpdate=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.prototype.id=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).sint32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).sint32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).sint32(e.z),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(32).uint32(e.id),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.WorldBlockUpdate;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.x=e.sint32();break;case 2:o.y=e.sint32();break;case 3:o.z=e.sint32();break;case 4:o.id=e.uint32();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.id&&e.hasOwnProperty("id")&&!r.isInteger(e.id)?"id: integer expected":null},o.fromObject=function(e){if(e instanceof i.WorldBlockUpdate)return e;var t=new i.WorldBlockUpdate;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.id&&(t.id=e.id>>>0),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.id=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.id&&e.hasOwnProperty("id")&&(n.id=e.id),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.WorldChunkLoad=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.prototype.data=r.newBuffer([]),o.prototype.type=!1,o.prototype.compressed=!1,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).sint32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).sint32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).sint32(e.z),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(34).bytes(e.data),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(40).bool(e.type),null!=e.compressed&&Object.hasOwnProperty.call(e,"compressed")&&t.uint32(48).bool(e.compressed),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.WorldChunkLoad;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.x=e.sint32();break;case 2:o.y=e.sint32();break;case 3:o.z=e.sint32();break;case 4:o.data=e.bytes();break;case 5:o.type=e.bool();break;case 6:o.compressed=e.bool();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.data&&e.hasOwnProperty("data")&&!(e.data&&"number"==typeof e.data.length||r.isString(e.data))?"data: buffer expected":null!=e.type&&e.hasOwnProperty("type")&&"boolean"!=typeof e.type?"type: boolean expected":null!=e.compressed&&e.hasOwnProperty("compressed")&&"boolean"!=typeof e.compressed?"compressed: boolean expected":null},o.fromObject=function(e){if(e instanceof i.WorldChunkLoad)return e;var t=new i.WorldChunkLoad;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.data&&("string"==typeof e.data?r.base64.decode(e.data,t.data=r.newBuffer(r.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.type&&(t.type=Boolean(e.type)),null!=e.compressed&&(t.compressed=Boolean(e.compressed)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,t.bytes===String?n.data="":(n.data=[],t.bytes!==Array&&(n.data=r.newBuffer(n.data))),n.type=!1,n.compressed=!1),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.data&&e.hasOwnProperty("data")&&(n.data=t.bytes===String?r.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.compressed&&e.hasOwnProperty("compressed")&&(n.compressed=e.compressed),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.WorldChunkUnload=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.prototype.type=!1,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).sint32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).sint32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).sint32(e.z),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(32).bool(e.type),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.WorldChunkUnload;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.x=e.sint32();break;case 2:o.y=e.sint32();break;case 3:o.z=e.sint32();break;case 4:o.type=e.bool();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.type&&e.hasOwnProperty("type")&&"boolean"!=typeof e.type?"type: boolean expected":null},o.fromObject=function(e){if(e instanceof i.WorldChunkUnload)return e;var t=new i.WorldChunkUnload;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.type&&(t.type=Boolean(e.type)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.type=!1),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.RegistryUpdate=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.itemsDef="",o.prototype.blocksDef="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.itemsDef&&Object.hasOwnProperty.call(e,"itemsDef")&&t.uint32(10).string(e.itemsDef),null!=e.blocksDef&&Object.hasOwnProperty.call(e,"blocksDef")&&t.uint32(18).string(e.blocksDef),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.RegistryUpdate;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.itemsDef=e.string();break;case 2:o.blocksDef=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.itemsDef&&e.hasOwnProperty("itemsDef")&&!r.isString(e.itemsDef)?"itemsDef: string expected":null!=e.blocksDef&&e.hasOwnProperty("blocksDef")&&!r.isString(e.blocksDef)?"blocksDef: string expected":null},o.fromObject=function(e){if(e instanceof i.RegistryUpdate)return e;var t=new i.RegistryUpdate;return null!=e.itemsDef&&(t.itemsDef=String(e.itemsDef)),null!=e.blocksDef&&(t.blocksDef=String(e.blocksDef)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.itemsDef="",n.blocksDef=""),null!=e.itemsDef&&e.hasOwnProperty("itemsDef")&&(n.itemsDef=e.itemsDef),null!=e.blocksDef&&e.hasOwnProperty("blocksDef")&&(n.blocksDef=e.blocksDef),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.UpdateGameplaySetting=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.key="",o.prototype.value="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.UpdateGameplaySetting;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.key=e.string();break;case 2:o.value=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!r.isString(e.value)?"value: string expected":null},o.fromObject=function(e){if(e instanceof i.UpdateGameplaySetting)return e;var t=new i.UpdateGameplaySetting;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PluginMessage=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.key="",o.prototype.version=0,o.prototype.value="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(16).uint32(e.version),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(26).string(e.value),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PluginMessage;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:o.key=e.string();break;case 2:o.version=e.uint32();break;case 3:o.value=e.string();break;default:e.skipType(7&a)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.version&&e.hasOwnProperty("version")&&!r.isInteger(e.version)?"version: integer expected":null!=e.value&&e.hasOwnProperty("value")&&!r.isString(e.value)?"value: string expected":null},o.fromObject=function(e){if(e instanceof i.PluginMessage)return e;var t=new i.PluginMessage;return null!=e.key&&(t.key=String(e.key)),null!=e.version&&(t.version=e.version>>>0),null!=e.value&&(t.value=String(e.value)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.version=0,n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.version&&e.hasOwnProperty("version")&&(n.version=e.version),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i})?r.apply(t,i):r)||(e.exports=o)},function(e){e.exports=JSON.parse('["LoginResponse","ActionMove","ActionMessage","ActionBlockPlace","ActionBlockBreak","ActionInventoryClick","ActionInventoryOpen","ActionInventoryClose","ActionClick","ActionClickEntity","PluginMessage"]')},function(e){e.exports=JSON.parse('["LoginRequest","LoginSuccess","PlayerKick","PlayerEntity","PlayerTeleport","PlayerInventory","PlayerSlotUpdate","PlayerApplyImpulse","PlayerUpdateMovement","PlayerUpdatePhysics","PlayerHealth","PlayerOpenInventory","SoundPlay","ChatMessage","TabUpdate","EntityCreate","EntityRemove","EntityMove","EntityUpdate","EntityAnimate","WorldBlockUpdate","WorldChunkLoad","WorldChunkUnload","RegistryUpdate","UpdateGameplaySetting","PluginMessage"]')},function(e,t,n){parcelRequire=function(t,r,i,o){var a,s="function"==typeof parcelRequire&&parcelRequire;function c(e,i){if(!r[e]){if(!t[e]){var o="function"==typeof parcelRequire&&parcelRequire;if(!i&&o)return o(e,!0);if(s)return s(e,!0);if("string"==typeof e)return n(357)(e);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}l.resolve=function(n){return t[e][1][n]||n},l.cache={};var u=r[e]=new c.Module(e);t[e][0].call(u.exports,l,u,u.exports,this)}return r[e].exports;function l(e){return c(l.resolve(e))}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=t,c.cache=r,c.parent=s,c.register=function(e,n){t[e]=[function(e,t){t.exports=n},{}]};for(var u=0;u<i.length;u++)try{c(i[u])}catch(t){a||(a=t)}if(i.length){var l=c(i[i.length-1]);e.exports=l}if(parcelRequire=c,a)throw a;return c}({EgBh:[function(e,t,n){var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=r;var i=t.exports.BlobBuilder;function o(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(i=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),o.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},o.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);r.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},o.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var e=new i,t=0,n=this._parts.length;t<n;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=o},{}],kdPp:[function(e,t,n){var r=e("./bufferbuilder").BufferBuilder,i=e("./bufferbuilder").binaryFeatures,o={unpack:function(e){return new a(e).unpack()},pack:function(e){var t=new s;return t.pack(e),t.getBuffer()}};function a(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function s(){this.bufferBuilder=new r}function c(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}t.exports=o,a.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},a.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},a.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},a.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},a.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},a.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},a.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},a.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},a.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},a.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},a.prototype.unpack_string=function(e){for(var t,n,r=this.read(e),i=0,o="";i<e;)(t=r[i])<128?(o+=String.fromCharCode(t),i++):(192^t)<32?(n=(192^t)<<6|63&r[i+1],o+=String.fromCharCode(n),i+=2):(n=(15&t)<<12|(63&r[i+1])<<6|63&r[i+2],o+=String.fromCharCode(n),i+=3);return this.index+=e,o},a.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},a.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var r=this.unpack(),i=this.unpack();t[r]=i}return t},a.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},a.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},a.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},s.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},s.prototype.pack=function(e){var t=typeof e;if("string"===t)this.pack_string(e);else if("number"===t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"===t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"===t)this.bufferBuilder.append(192);else{if("object"!==t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(n==ArrayBuffer)i.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)i.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(n==Object||n.toString().startsWith("class"))this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},s.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,c).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},s.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(255&e);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},s.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,n)-1,i=Math.floor(r*Math.pow(2,52)),o=Math.pow(2,32),a=t<<31|n+1023<<20|i/o&1048575,s=i%o;this.bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(s)},s.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},s.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},s.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},s.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},s.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},s.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.extractVersion=a,n.wrapPeerConnectionEvent=function(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=n(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=o,i.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return o.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},n.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(i=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},n.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(o=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},n.log=function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(i)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function(e,t){o&&console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var{navigator:t}=e,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n},n.compactObject=function e(t){return s(t)?Object.keys(t).reduce((function(n,r){var i=s(t[r]),o=i?e(t[r]):t[r],a=i&&!Object.keys(o).length;return void 0===o||a?n:Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},r,o))}),{}):t},n.walkStats=c,n.filterStats=function(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&c(e,n,i)}))})),i};var i=!0,o=!0;function a(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((function(r){r.endsWith("Id")?c(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((function(t){c(e,e.get(t),n)}))})))}},{}],s6SN:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var n=r.detectBrowser(e),i=function(e){if("object"!==o(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===o(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[i("min",n)]=r.ideal,t.optional.push(a),(a={})[i("max",n)]=r.ideal,t.optional.push(a)):(a[i("",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,r){if(n.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===o(e.audio)){var s=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};s((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),s(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"===o(e.video)){var c=e.video.facingMode;c=c&&("object"===o(c)?c:{ideal:c});var u,l=n.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||l)&&(delete e.video.facingMode,"environment"===c.exact||"environment"===c.ideal?u=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(u=["front"]),u))return t.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return u.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&u.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=c.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=i(e.video),a("chrome: "+JSON.stringify(e)),r(e)}));e.video=i(e.video)}return a("chrome: "+JSON.stringify(e)),r(e)},c=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,n,r){s(e,(function(e){t.webkitGetUserMedia(e,n,(function(e){r&&r(c(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var u=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,(function(e){return u(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils.js"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=r.log},{"../utils.js":"iSxC"}],VHa8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(e){if("object"!==c(e)||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)r.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}));else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})),t.stream.getTracks().forEach((function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},n.shimGetSendersWithDtmf=function(e){if("object"===c(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===c(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},n.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,[n,r,i]=arguments;if(arguments.length>0&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);var o=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},a=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};return arguments.length>=2?t.apply(this,[function(e){r(a(o(e)))},n]):new Promise((function(n,r){t.apply(e,[function(e){n(a(o(e)))},r])})).then(r,i)}}},n.shimSenderReceiverGetStats=function(e){if("object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,i=arguments[0];return this.getSenders().forEach((function(e){e.track===i&&(t?r=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===i&&(n?r=!0:n=e),e.track===i})),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}},n.shimAddTrackRemoveTrackWithNative=u,n.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=r.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return u(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}i.apply(this,[t])};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[n.id]=a,this._reverseStreams[a.id]=n,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=s({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var r=l(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return l(e,t)}))}));e.RTCPeerConnection.prototype[t]=r[t]}));var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,n=(t=arguments[0]).sdp,Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})),a.apply(this,arguments)):a.apply(this,arguments);var e,t,n};var c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=c.get.apply(this);return""===e.type?e:l(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function l(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}},n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=s({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}));var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},n.fixNegotiationNeeded=function(e){r.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils.js")),i=e("./getusermedia"),o=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();n.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),i.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof t;return i&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=i?t[0]:t,!!t.length}}))};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}},{"../utils":"iSxC"}],YHvh:[function(e,t,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);return{usernameFragment:(n=n.concat(r.splitLines(t))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:n.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=r.writeExtmap(e)})),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),n.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},n.push(r))}})),0===n.length&&c&&n.push({ssrc:c});var l=r.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=l}))),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),i=r.matchPrefix(e,"a=max-message-size:");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var o=r.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var a=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var i=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=r)},{}],NJ2u:[function(e,t,n){"use strict";var r=e("sdp");function i(e,t,n,i,o){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(i?i.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function s(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function u(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var l=function(n){var i=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},l.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},l.prototype._gather=function(t,n){var i=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),s.component=1,s.ufrag=o.getLocalParameters().usernameFragment;var u=r.writeCandidate(s);a.candidate=Object.assign(a.candidate,r.parseCandidate(u)),a.candidate.candidate=u,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var l=r.getMediaSections(i._localDescription.sdp);l[a.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+l.join("");var f=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",a),f&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,i){var a=o(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),i&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},l.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var s=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var a=i.transceivers[t],c=a.iceGatherer,u=a.iceTransport,l=a.dtlsTransport,f=a.localCapabilities,d=a.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length||a.rejected)){var p=r.getIceParameters(e,n),h=r.getDtlsParameters(e,n);s&&(h.role="server"),i.usingBundle&&0!==t||(i._gather(a.mid,t),"new"===u.state&&u.start(c,p,s?"controlling":"controlled"),"new"===l.state&&l.start(h));var m=o(f,d);i._transceive(a,m.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(i){var l=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!a("setRemoteDescription",i.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+l.signalingState));var f={};l.remoteStreams.forEach((function(e){f[e.id]=e}));var d=[],p=r.splitSections(i.sdp),h=p.shift(),m=r.matchPrefix(h,"a=ice-lite").length>0,y=r.matchPrefix(h,"a=group:BUNDLE ").length>0;l.usingBundle=y;var v=r.matchPrefix(h,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!v&&v.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(a,c){var u=r.splitLines(a),p=r.getKind(a),v=r.isRejected(a)&&0===r.matchPrefix(a,"a=bundle-only").length,g=u[0].substr(2).split(" ")[2],b=r.getDirection(a,h),w=r.parseMsid(a),_=r.getMid(a)||r.generateIdentifier();if(v||"application"===p&&("DTLS/SCTP"===g||"UDP/DTLS/SCTP"===g))l.transceivers[c]={mid:_,kind:p,protocol:g,rejected:!0};else{var k,x,O,P,S,C,T,E,j;!v&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(p,!0));var M,D,I=r.parseRtpParameters(a);v||(M=r.getIceParameters(a,h),(D=r.getDtlsParameters(a,h)).role="client"),T=r.parseRtpEncodingParameters(a);var R=r.parseRtcpParameters(a),A=r.matchPrefix(a,"a=end-of-candidates",h).length>0,B=r.matchPrefix(a,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!v&&y&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==i.type||v)"answer"!==i.type||v||(x=(k=l.transceivers[c]).iceGatherer,O=k.iceTransport,P=k.dtlsTransport,S=k.rtpReceiver,C=k.sendEncodingParameters,E=k.localCapabilities,l.transceivers[c].recvEncodingParameters=T,l.transceivers[c].remoteCapabilities=I,l.transceivers[c].rtcpParameters=R,B.length&&"new"===O.state&&(!m&&!A||y&&0!==c?B.forEach((function(e){s(k.iceTransport,e)})):O.setRemoteCandidates(B)),y&&0!==c||("new"===O.state&&O.start(x,M,"controlling"),"new"===P.state&&P.start(D)),!o(k.localCapabilities,k.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&k.sendEncodingParameters[0].rtx&&delete k.sendEncodingParameters[0].rtx,l._transceive(k,"sendrecv"===b||"recvonly"===b,"sendrecv"===b||"sendonly"===b),!S||"sendrecv"!==b&&"sendonly"!==b?delete k.rtpReceiver:(j=S.track,w?(f[w.stream]||(f[w.stream]=new e.MediaStream),n(j,f[w.stream]),d.push([j,S,f[w.stream]])):(f.default||(f.default=new e.MediaStream),n(j,f.default),d.push([j,S,f.default]))));else{(k=l.transceivers[c]||l._createTransceiver(p)).mid=_,k.iceGatherer||(k.iceGatherer=l._createIceGatherer(c,y)),B.length&&"new"===k.iceTransport.state&&(!A||y&&0!==c?B.forEach((function(e){s(k.iceTransport,e)})):k.iceTransport.setRemoteCandidates(B)),E=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(E.codecs=E.codecs.filter((function(e){return"rtx"!==e.name}))),C=k.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var L,z=!1;"sendrecv"===b||"sendonly"===b?(z=!k.rtpReceiver,S=k.rtpReceiver||new e.RTCRtpReceiver(k.dtlsTransport,p),z&&(j=S.track,w&&"-"===w.stream||(w?(f[w.stream]||(f[w.stream]=new e.MediaStream,Object.defineProperty(f[w.stream],"id",{get:function(){return w.stream}})),Object.defineProperty(j,"id",{get:function(){return w.track}}),L=f[w.stream]):(f.default||(f.default=new e.MediaStream),L=f.default)),L&&(n(j,L),k.associatedRemoteMediaStreams.push(L)),d.push([j,S,L]))):k.rtpReceiver&&k.rtpReceiver.track&&(k.associatedRemoteMediaStreams.forEach((function(t){var n,r,i=t.getTracks().find((function(e){return e.id===k.rtpReceiver.track.id}));i&&(n=i,(r=t).removeTrack(n),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:n})))})),k.associatedRemoteMediaStreams=[]),k.localCapabilities=E,k.remoteCapabilities=I,k.rtpReceiver=S,k.rtcpParameters=R,k.sendEncodingParameters=C,k.recvEncodingParameters=T,l._transceive(l.transceivers[c],!1,z)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===i.type?"active":"passive"),l._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(f).forEach((function(t){var n=f[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout((function(){l._dispatchEvent("addstream",r)}))}d.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&u(l,t,r,[n])}))}})),d.forEach((function(e){e[2]||u(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=n.transceivers.filter((function(e){return"audio"===e.kind})).length,a=n.transceivers.filter((function(e){return"video"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(o=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));o>0||a>0;)o>0&&(n._createTransceiver("audio"),o--),a>0&&(n._createTransceiver("video"),a--);var u=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(i,o){var a=i.track,s=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(o,n.usingBundle));var u=e.RTCRtpSender.getCapabilities(s);t<15019&&(u.codecs=u.codecs.filter((function(e){return"rtx"!==e.name}))),u.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),u.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=i.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];a&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=u,i.sendEncodingParameters=l})),"max-compat"!==n._config.bundlePolicy&&(u+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),u+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){u+=i(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),u+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,u+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(u+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:u});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var s=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,r){if(!(r+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var u=o(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=i(e,u,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}}));var u=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(u)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,o){if(!n._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var u=0;u<n.transceivers.length;u++)if(n.transceivers[u].mid===e.sdpMid){a=u;break}var l=n.transceivers[a];if(!l)return o(c("OperationError","Can not add ICE candidate"));if(l.rejected)return i();var f=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===f.protocol&&(0===f.port||9===f.port))return i();if(f.component&&1!==f.component)return i();if((0===a||a>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!s(l.iceTransport,f))return o(c("OperationError","Can not add ICE candidate"));var d=e.candidate.trim();0===d.indexOf("a=")&&(d=d.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(f.type?d:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var p=0;p<n.transceivers.length&&(n.transceivers[p].rejected||(n.transceivers[p].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));p++);i()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){e[n].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[n]),t.set(n,e[n])})),t}))}}}));var f=["createOffer","createAnswer"];return f.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(f=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},{sdp:"YHvh"}],YdKx:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],P3bV:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],XRic:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var a=(0,o.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,i.filterIceServers)(e.iceServers,t.version),r.log("ICE servers after filtering:",e.iceServers)),new a(e)},e.RTCPeerConnection.prototype=a.prototype},n.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils")),i=e("./filtericeservers"),o=function(e){return e&&e.__esModule?e:{default:e}}(e("rtcpeerconnection-shim")),a=e("./getusermedia"),s=e("./getdisplaymedia");function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===o(e)&&"object"===o(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},i&&i.prototype.getSettings){var c=i.prototype.getSettings;i.prototype.getSettings=function(){var e=c.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(i&&i.prototype.applyConstraints){var u=i.prototype.applyConstraints;i.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===o(e)&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[e])}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC"}],UuGU:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}},{}],Fzdr:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimOnTrack=function(e){"object"===s(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if("object"===s(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]})),t.version<68){var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var[e,n,r]=arguments;return o.apply(this,[e||null]).then((function(e){if(t.version<53&&!n)try{e.forEach((function(e){e.type=i[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(n,r)}}},n.shimSenderGetStats=function(e){if("object"===s(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},n.shimReceiverGetStats=function(e){if("object"===s(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(n){var{sender:i}=r,o=i.getParameters();"encodings"in o||(o.encodings=e.sendEncodings,this.setParametersPromises.push(i.setParameters(o).catch((function(){}))))}return r})}},n.shimCreateOffer=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}},n.shimCreateAnswer=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils")),i=e("./getusermedia"),o=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimLocalStreamsAPI=function(e){if("object"===o(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(r){return t.call(n,r,e)})),e.getVideoTracks().forEach((function(r){return t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){var n=arguments[1];return n&&(this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach((function(e){r.includes(e.track)&&t.removeTrack(e)}))}})}},n.shimRemoteStreamsAPI=function(e){if("object"===o(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},n.shimCallbacksAPI=function(e){if("object"===o(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var c=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=c,c=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=c,c=function(e,t,n){var r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=c}},n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return r(a(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))},n.shimConstraints=a,n.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},n.shimTrackEventTransceiver=function(e){"object"===o(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return e&&void 0!==e.video?Object.assign({},e,{video:r.compactObject(e.video)}):e}},{"../utils":"iSxC"}],GOQK:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&(!e.RTCIceCandidate||!("foundation"in e.RTCIceCandidate.prototype))){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===a(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),i=r.default.parseCandidate(e.candidate),o=Object.assign(n,i);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,i.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},n.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var t=i.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=r.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=r.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var i,o=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),a=(u=o,l=65536,"firefox"===t.browser&&(l=t.version<57?-1===u?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),l),s=function(e,n){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var o=r.default.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?i=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],o);i=0===a&&0===s?Number.POSITIVE_INFINITY:0===a||0===s?Math.max(a,s):Math.min(a,s);var c={};Object.defineProperty(c,"maxMessageSize",{get:function(){return i}}),this._sctp=c}var u,l;return n.apply(this,arguments)}}},n.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},i.wrapPeerConnectionEvent(e,"datachannel",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}},n.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}},n.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=i.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),n.apply(this,arguments)}}}};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("sdp")),i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("./utils"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=r.log,u=r.detectBrowser(e),l={browserDetails:u,commonShim:c,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(u.browser){case"chrome":if(!i||!i.shimPeerConnection||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),l;n("adapter.js shimming chrome."),l.browserShim=i,i.shimGetUserMedia(e),i.shimMediaStream(e),i.shimPeerConnection(e),i.shimOnTrack(e),i.shimAddTrackRemoveTrack(e),i.shimGetSendersWithDtmf(e),i.shimGetStats(e),i.shimSenderReceiverGetStats(e),i.fixNegotiationNeeded(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;case"firefox":if(!a||!a.shimPeerConnection||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),l;n("adapter.js shimming firefox."),l.browserShim=a,a.shimGetUserMedia(e),a.shimPeerConnection(e),a.shimOnTrack(e),a.shimRemoveStream(e),a.shimSenderGetStats(e),a.shimReceiverGetStats(e),a.shimRTCDataChannel(e),a.shimAddTransceiver(e),a.shimCreateOffer(e),a.shimCreateAnswer(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"edge":if(!o||!o.shimPeerConnection||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),l;n("adapter.js shimming edge."),l.browserShim=o,o.shimGetUserMedia(e),o.shimGetDisplayMedia(e),o.shimPeerConnection(e),o.shimReplaceTrack(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"safari":if(!s||!t.shimSafari)return n("Safari shim is not included in this adapter release."),l;n("adapter.js shimming safari."),l.browserShim=s,s.shimRTCIceServerUrls(e),s.shimCreateOfferLegacy(e),s.shimCallbacksAPI(e),s.shimLocalStreamsAPI(e),s.shimRemoteStreamsAPI(e),s.shimTrackEventTransceiver(e),s.shimGetUserMedia(e),c.shimRTCIceCandidate(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;default:n("Unsupported browser!")}return l};var r=l(e("./utils")),i=l(e("./chrome/chrome_shim")),o=l(e("./edge/edge_shim")),a=l(e("./firefox/firefox_shim")),s=l(e("./safari/safari_shim")),c=l(e("./common_shim"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=(0,e("./adapter_factory.js").adapterFactory)({window:window});n.default=r},{"./adapter_factory.js":"KtlG"}],sXtV:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("webrtc-adapter"));n.webRTCAdapter=i.default},{"webrtc-adapter":"tI1X"}],I31f:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./adapter");n.Supports=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},e.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},e.prototype.getBrowser=function(){return r.webRTCAdapter.browserDetails.browser},e.prototype.getVersion=function(){return r.webRTCAdapter.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var e,t=this.getBrowser(),n=r.webRTCAdapter.browserDetails.version||0;if("chrome"===t&&n<72)return!1;if("firefox"===t&&n>=59)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var i=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),i=!0}catch(e){}finally{e&&e.close()}return i},e.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},e}())},{"./adapter":"sXtV"}],BHXf:[function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("peerjs-js-binarypack")),o=e("./supports"),a={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};n.util=new(function(){function e(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=a,this.browser=o.Supports.getBrowser(),this.browserVersion=o.Supports.getVersion(),this.supports=function(){var e,t={browser:o.Supports.isBrowserSupported(),webRTC:o.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{e=new RTCPeerConnection(a),t.audioVideo=!0;var n=void 0;try{n=e.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!o.Supports.isIOS}catch(e){}}catch(e){}finally{n&&n.close()}}catch(e){}finally{e&&e.close()}return t}(),this.pack=i.pack,this.unpack=i.unpack,this._dataCount=1}return e.prototype.noop=function(){},e.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},e.prototype.chunk=function(e){for(var t=[],r=e.size,i=Math.ceil(r/n.util.chunkedMTU),o=0,a=0;a<r;){var s=Math.min(r,a+n.util.chunkedMTU),c=e.slice(a,s),u={__peerData:this._dataCount,n:o,data:c,total:i};t.push(u),a=s,o++}return this._dataCount++,t},e.prototype.blobToArrayBuffer=function(e,t){var n=new FileReader;return n.onload=function(e){e.target&&t(e.target.result)},n.readAsArrayBuffer(e),n},e.prototype.binaryStringToArrayBuffer=function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},e.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},e.prototype.isSecure=function(){return"https:"===location.protocol},e}())},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||e,o),c=i?i+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function u(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),u.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},u.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},u.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},u.prototype.emit=function(e,t,n,r,o,a){var s=i?i+e:e;if(!this._events[s])return!1;var c,u,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,a),!0}for(u=1,c=new Array(f-1);u<f;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var d,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),f){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,r);break;default:if(!c)for(d=1,c=new Array(f-1);d<f;d++)c[d-1]=arguments[d];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},u.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},u.prototype.removeListener=function(e,t,n,r){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return c(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||c(this,o);else{for(var s=0,u=[],l=a.length;s<l;s++)(a[s].fn!==t||r&&!a[s].once||n&&a[s].context!==n)&&u.push(a[s]);u.length?this._events[o]=1===u.length?u[0]:u:c(this,o)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&c(this,t)):(this._events=new o,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,void 0!==t&&(t.exports=u)},{}],WOs9:[function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(n,"__esModule",{value:!0});var o,a="PeerJS: ";!function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"}(o=n.LogLevel||(n.LogLevel={}));var s=function(){function e(){this._logLevel=o.Disabled}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!0,configurable:!0}),e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.All&&this._print.apply(this,i([o.All],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.Warnings&&this._print.apply(this,i([o.Warnings],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.Errors&&this._print.apply(this,i([o.Errors],e))},e.prototype.setLogFunction=function(e){this._print=e},e.prototype._print=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=i([a],t);for(var s in r)r[s]instanceof Error&&(r[s]="("+r[s].name+") "+r[s].message);e>=o.All?console.log.apply(console,i(r)):e>=o.Warnings?console.warn.apply(console,i(["WARNING"],r)):e>=o.Errors&&console.error.apply(console,i(["ERROR"],r))},e}();n.default=new s},{}],ZRYf:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.Open="open",e.Stream="stream",e.Data="data",e.Close="close",e.Error="error",e.IceStateChanged="iceStateChanged"}(n.ConnectionEventType||(n.ConnectionEventType={})),function(e){e.Data="data",e.Media="media"}(n.ConnectionType||(n.ConnectionType={})),function(e){e.Open="open",e.Close="close",e.Connection="connection",e.Call="call",e.Disconnected="disconnected",e.Error="error"}(n.PeerEventType||(n.PeerEventType={})),function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"}(n.PeerErrorType||(n.PeerErrorType={})),function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"}(n.SerializationType||(n.SerializationType={})),function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"}(n.SocketEventType||(n.SocketEventType={})),function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"}(n.ServerMessageType||(n.ServerMessageType={}))},{}],wJlv:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("eventemitter3"),u=s(e("./logger")),l=e("./enums"),f=function(e){function t(t,n,r,i,o,a){void 0===a&&(a=5e3);var s=e.call(this)||this;s.pingInterval=a,s._disconnected=!0,s._messagesQueue=[];var c=t?"wss://":"ws://";return s._baseUrl=c+n+":"+r+i+"peerjs?key="+o,s}return r(t,e),t.prototype.start=function(e,t){var n=this;this._id=e;var r=this._baseUrl+"&id="+e+"&token="+t;!this._socket&&this._disconnected&&(this._socket=new WebSocket(r),this._disconnected=!1,this._socket.onmessage=function(e){var t;try{t=JSON.parse(e.data),u.default.log("Server message received:",t)}catch(t){return void u.default.log("Invalid server message",e.data)}n.emit(l.SocketEventType.Message,t)},this._socket.onclose=function(e){n._disconnected||(u.default.log("Socket closed.",e),n._cleanup(),n._disconnected=!0,n.emit(l.SocketEventType.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),u.default.log("Socket open"),n._scheduleHeartbeat())})},t.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout((function(){e._sendHeartbeat()}),this.pingInterval)},t.prototype._sendHeartbeat=function(){if(this._wsOpen()){var e=JSON.stringify({type:l.ServerMessageType.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}else u.default.log("Cannot send heartbeat, because socket closed")},t.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},t.prototype._sendQueuedMessages=function(){var e,t,n=o(this._messagesQueue);this._messagesQueue=[];try{for(var r=a(n),i=r.next();!i.done;i=r.next()){var s=i.value;this.send(s)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.send=function(e){if(!this._disconnected)if(this._id)if(e.type){if(this._wsOpen()){var t=JSON.stringify(e);this._socket.send(t)}}else this.emit(l.SocketEventType.Error,"Invalid message");else this._messagesQueue.push(e)},t.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},t.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},t}(c.EventEmitter);n.Socket=f},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./util"),c=a(e("./logger")),u=e("./enums"),l=function(){function e(e){this.connection=e}return e.prototype.startConnection=function(e){var t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===u.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){if(this.connection.type===u.ConnectionType.Data){var n=this.connection,r={ordered:!!e.reliable},i=t.createDataChannel(n.label,r);n.initialize(i)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},e.prototype._startPeerConnection=function(){c.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},e.prototype._setupListeners=function(e){var t=this,n=this.connection.peer,r=this.connection.connectionId,i=this.connection.type,o=this.connection.provider;c.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(c.default.log("Received ICE candidates for "+n+":",e.candidate),o.socket.send({type:u.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:i,connectionId:r},dst:n}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":c.default.log("iceConnectionState is failed, closing connections to "+n),t.connection.emit(u.ConnectionEventType.Error,new Error("Negotiation of connection to "+n+" failed.")),t.connection.close();break;case"closed":c.default.log("iceConnectionState is closed, closing connections to "+n),t.connection.emit(u.ConnectionEventType.Error,new Error("Connection to "+n+" closed.")),t.connection.close();break;case"disconnected":c.default.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=s.util.noop}t.connection.emit(u.ConnectionEventType.IceStateChanged,e.iceConnectionState)},c.default.log("Listening for data channel"),e.ondatachannel=function(e){c.default.log("Received data channel");var t=e.channel;o.getConnection(n,r).initialize(t)},c.default.log("Listening for remote stream"),e.ontrack=function(e){c.default.log("Received remote stream");var i=e.streams[0],a=o.getConnection(n,r);if(a.type===u.ConnectionType.Media){var s=a;t._addStreamToMediaConnection(i,s)}}},e.prototype.cleanup=function(){c.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var t="closed"!==e.signalingState,n=!1;if(this.connection.type===u.ConnectionType.Data){var r=this.connection.dataChannel;r&&(n=!!r.readyState&&"closed"!==r.readyState)}(t||n)&&e.close()}},e.prototype._makeOffer=function(){return i(this,void 0,Promise,(function(){var e,t,n,i,a,l,f;return o(this,(function(o){switch(o.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,e.createOffer(this.connection.options.constraints)];case 2:n=o.sent(),c.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return o.sent(),c.default.log("Set localDescription:",n,"for:"+this.connection.peer),i={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:s.util.browser},this.connection.type===u.ConnectionType.Data&&(a=this.connection,i=r(r({},i),{label:a.label,reliable:a.reliable,serialization:a.serialization})),t.socket.send({type:u.ServerMessageType.Offer,payload:i,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(l=o.sent())&&(t.emitError(u.PeerErrorType.WebRTC,l),c.default.log("Failed to setLocalDescription, ",l)),[3,6];case 6:return[3,8];case 7:return f=o.sent(),t.emitError(u.PeerErrorType.WebRTC,f),c.default.log("Failed to createOffer, ",f),[3,8];case 8:return[2]}}))}))},e.prototype._makeAnswer=function(){return i(this,void 0,Promise,(function(){var e,t,n,r,i;return o(this,(function(o){switch(o.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:n=o.sent(),c.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return o.sent(),c.default.log("Set localDescription:",n,"for:"+this.connection.peer),t.socket.send({type:u.ServerMessageType.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,browser:s.util.browser},dst:this.connection.peer}),[3,6];case 5:return r=o.sent(),t.emitError(u.PeerErrorType.WebRTC,r),c.default.log("Failed to setLocalDescription, ",r),[3,6];case 6:return[3,8];case 7:return i=o.sent(),t.emitError(u.PeerErrorType.WebRTC,i),c.default.log("Failed to create answer, ",i),[3,8];case 8:return[2]}}))}))},e.prototype.handleSDP=function(e,t){return i(this,void 0,Promise,(function(){var n,r,i,a;return o(this,(function(o){switch(o.label){case 0:t=new RTCSessionDescription(t),n=this.connection.peerConnection,r=this.connection.provider,c.default.log("Setting remote description",t),i=this,o.label=1;case 1:return o.trys.push([1,5,,6]),[4,n.setRemoteDescription(t)];case 2:return o.sent(),c.default.log("Set remoteDescription:"+e+" for:"+this.connection.peer),"OFFER"!==e?[3,4]:[4,i._makeAnswer()];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:return a=o.sent(),r.emitError(u.PeerErrorType.WebRTC,a),c.default.log("Failed to setRemoteDescription, ",a),[3,6];case 6:return[2]}}))}))},e.prototype.handleCandidate=function(e){return i(this,void 0,Promise,(function(){var t,n,r,i,a,s;return o(this,(function(o){switch(o.label){case 0:c.default.log("handleCandidate:",e),t=e.candidate,n=e.sdpMLineIndex,r=e.sdpMid,i=this.connection.peerConnection,a=this.connection.provider,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.addIceCandidate(new RTCIceCandidate({sdpMid:r,sdpMLineIndex:n,candidate:t}))];case 2:return o.sent(),c.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return s=o.sent(),a.emitError(u.PeerErrorType.WebRTC,s),c.default.log("Failed to handleCandidate, ",s),[3,4];case 4:return[2]}}))}))},e.prototype._addTracksToConnection=function(e,t){if(c.default.log("add tracks from stream "+e.id+" to peer connection"),!t.addTrack)return c.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach((function(n){t.addTrack(n,e)}))},e.prototype._addStreamToMediaConnection=function(e,t){c.default.log("add stream "+e.id+" to media connection "+t.connectionId),t.addStream(e)},e}();n.Negotiator=l},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){function t(t,n,r){var i=e.call(this)||this;return i.peer=t,i.provider=n,i.options=r,i._open=!1,i.metadata=r.metadata,i}return r(t,e),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),t}(e("eventemitter3").EventEmitter);n.BaseConnection=i},{eventemitter3:"JJlS"}],dbHP:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./util"),c=a(e("./logger")),u=e("./negotiator"),l=e("./enums"),f=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o._localStream=o.options._stream,o.connectionId=o.options.connectionId||t.ID_PREFIX+s.util.randomToken(),o._negotiator=new u.Negotiator(o),o._localStream&&o._negotiator.startConnection({_stream:o._localStream,originator:!0}),o}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return l.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localStream",{get:function(){return this._localStream},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),t.prototype.addStream=function(t){c.default.log("Receiving stream",t),this._remoteStream=t,e.prototype.emit.call(this,l.ConnectionEventType.Stream,t)},t.prototype.handleMessage=function(e){var t=e.type,n=e.payload;switch(e.type){case l.ServerMessageType.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case l.ServerMessageType.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:c.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},t.prototype.answer=function(e,t){var n,r;if(void 0===t&&(t={}),this._localStream)c.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(i(i({},this.options._payload),{_stream:e}));var a=this.provider._getMessages(this.connectionId);try{for(var s=o(a),u=s.next();!u.done;u=s.next()){var l=u.value;this.handleMessage(l)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}this._open=!0}},t.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,e.prototype.emit.call(this,l.ConnectionEventType.Close))},t.ID_PREFIX="mc_",t}(e("./baseconnection").BaseConnection);n.MediaConnection=f},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=e("eventemitter3"),a=i(e("./logger")),s=function(e){function t(){var t=e.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(e){t._processing=!1,e.target&&t.emit("done",e.target.result),t.doNextTask()},t.fileReader.onerror=function(e){a.default.error("EncodingQueue error:",e),t._processing=!1,t.destroy(),t.emit("error",e)},t}return r(t,e),Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),t.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},t.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},t.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},t}(o.EventEmitter);n.EncodingQueue=s},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),s=o(e("./logger")),c=e("./negotiator"),u=e("./enums"),l=e("./baseconnection"),f=e("./encodingQueue"),d=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o.stringify=JSON.stringify,o.parse=JSON.parse,o._buffer=[],o._bufferSize=0,o._buffering=!1,o._chunkedData={},o._encodingQueue=new f.EncodingQueue,o.connectionId=o.options.connectionId||t.ID_PREFIX+a.util.randomToken(),o.label=o.options.label||o.connectionId,o.serialization=o.options.serialization||u.SerializationType.Binary,o.reliable=!!o.options.reliable,o._encodingQueue.on("done",(function(e){o._bufferedSend(e)})),o._encodingQueue.on("error",(function(){s.default.error("DC#"+o.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),o.close()})),o._negotiator=new c.Negotiator(o),o._negotiator.startConnection(o.options._payload||{originator:!0}),o}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return u.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),t.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},t.prototype._configureDataChannel=function(){var e=this;a.util.supports.binaryBlob&&!a.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){s.default.log("DC#"+e.connectionId+" dc connection success"),e._open=!0,e.emit(u.ConnectionEventType.Open)},this.dataChannel.onmessage=function(t){s.default.log("DC#"+e.connectionId+" dc onmessage:",t.data),e._handleDataMessage(t)},this.dataChannel.onclose=function(){s.default.log("DC#"+e.connectionId+" dc closed for:",e.peer),e.close()}},t.prototype._handleDataMessage=function(t){var n=this,r=t.data,i=r.constructor,o=r;if(this.serialization===u.SerializationType.Binary||this.serialization===u.SerializationType.BinaryUTF8){if(i===Blob)return void a.util.blobToArrayBuffer(r,(function(e){var t=a.util.unpack(e);n.emit(u.ConnectionEventType.Data,t)}));if(i===ArrayBuffer)o=a.util.unpack(r);else if(i===String){var s=a.util.binaryStringToArrayBuffer(r);o=a.util.unpack(s)}}else this.serialization===u.SerializationType.JSON&&(o=this.parse(r));o.__peerData?this._handleChunk(o):e.prototype.emit.call(this,u.ConnectionEventType.Data,o)},t.prototype._handleChunk=function(e){var t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=e.data,n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];var r=new Blob(n.data);this._handleDataMessage({data:r})}},t.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,e.prototype.emit.call(this,u.ConnectionEventType.Close))},t.prototype.send=function(t,n){if(this.open)if(this.serialization===u.SerializationType.JSON)this._bufferedSend(this.stringify(t));else if(this.serialization===u.SerializationType.Binary||this.serialization===u.SerializationType.BinaryUTF8){var r=a.util.pack(t);if(!n&&r.size>a.util.chunkedMTU)return void this._sendChunks(r);a.util.supports.binaryBlob?this._bufferedSend(r):this._encodingQueue.enque(r)}else this._bufferedSend(t);else e.prototype.emit.call(this,u.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},t.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},t.prototype._trySend=function(e){var n=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>t.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((function(){n._buffering=!1,n._tryBuffer()}),50),!1;try{this.dataChannel.send(e)}catch(e){return s.default.error("DC#:"+this.connectionId+" Error when sending:",e),this._buffering=!0,this.close(),!1}return!0},t.prototype._tryBuffer=function(){if(this.open&&0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},t.prototype._sendChunks=function(e){var t,n,r=a.util.chunk(e);s.default.log("DC#"+this.connectionId+" Try to send "+r.length+" chunks...");try{for(var o=i(r),c=o.next();!c.done;c=o.next()){var u=c.value;this.send(u,!0)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},t.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case u.ServerMessageType.Answer:this._negotiator.handleSDP(e.type,t.sdp);break;case u.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:s.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},t.ID_PREFIX="dc_",t.MAX_BUFFERED_AMOUNT=8388608,t}(l.BaseConnection);n.DataConnection=d},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),s=o(e("./logger")),c=function(){function e(e){this._options=e}return e.prototype._buildUrl=function(e){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+e+"?ts="+(new Date).getTime()+Math.random()},e.prototype.retrieveId=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return i(this,(function(i){switch(i.label){case 0:e=this._buildUrl("id"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=i.sent()).status)throw new Error("Error. Status:"+t.status);return[2,t.text()];case 3:throw n=i.sent(),s.default.error("Error retrieving ID",n),r="","/"===this._options.path&&this._options.host!==a.util.CLOUD_HOST&&(r=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+r);case 4:return[2]}}))}))},e.prototype.listAllPeers=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return i(this,(function(i){switch(i.label){case 0:e=this._buildUrl("peers"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=i.sent()).status){if(401===t.status)throw"",n=this._options.host===a.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n);throw new Error("Error. Status:"+t.status)}return[2,t.json()];case 3:throw r=i.sent(),s.default.error("Error retrieving list peers",r),new Error("Could not get list peers from the server."+r);case 4:return[2]}}))}))},e}();n.API=c},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("eventemitter3"),u=e("./util"),l=s(e("./logger")),f=e("./socket"),d=e("./mediaconnection"),p=e("./dataconnection"),h=e("./enums"),m=e("./api"),y=function(e){function t(n,r){var o,a=e.call(this)||this;return a._id=null,a._lastServerId=null,a._destroyed=!1,a._disconnected=!1,a._open=!1,a._connections=new Map,a._lostMessages=new Map,n&&n.constructor==Object?r=n:n&&(o=n.toString()),r=i({debug:0,host:u.util.CLOUD_HOST,port:u.util.CLOUD_PORT,path:"/",key:t.DEFAULT_KEY,token:u.util.randomToken(),config:u.util.defaultConfig},r),a._options=r,"/"===a._options.host&&(a._options.host=window.location.hostname),a._options.path&&("/"!==a._options.path[0]&&(a._options.path="/"+a._options.path),"/"!==a._options.path[a._options.path.length-1]&&(a._options.path+="/")),void 0===a._options.secure&&a._options.host!==u.util.CLOUD_HOST?a._options.secure=u.util.isSecure():a._options.host==u.util.CLOUD_HOST&&(a._options.secure=!0),a._options.logFunction&&l.default.setLogFunction(a._options.logFunction),l.default.logLevel=a._options.debug||0,a._api=new m.API(r),a._socket=a._createServerConnection(),u.util.supports.audioVideo||u.util.supports.data?o&&!u.util.validateId(o)?(a._delayedAbort(h.PeerErrorType.InvalidID,'ID "'+o+'" is invalid'),a):(o?a._initialize(o):a._api.retrieveId().then((function(e){return a._initialize(e)})).catch((function(e){return a._abort(h.PeerErrorType.ServerError,e)})),a):(a._delayedAbort(h.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),a)}return r(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connections",{get:function(){var e,t,n=Object.create(null);try{for(var r=o(this._connections),i=r.next();!i.done;i=r.next()){var s=a(i.value,2),c=s[0],u=s[1];n[c]=u}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),t.prototype._createServerConnection=function(){var e=this,t=new f.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t.on(h.SocketEventType.Message,(function(t){e._handleMessage(t)})),t.on(h.SocketEventType.Error,(function(t){e._abort(h.PeerErrorType.SocketError,t)})),t.on(h.SocketEventType.Disconnected,(function(){e.disconnected||(e.emitError(h.PeerErrorType.Network,"Lost connection to server."),e.disconnect())})),t.on(h.SocketEventType.Close,(function(){e.disconnected||e._abort(h.PeerErrorType.SocketClosed,"Underlying socket is already closed.")})),t},t.prototype._initialize=function(e){this._id=e,this.socket.start(e,this._options.token)},t.prototype._handleMessage=function(e){var t,n,r=e.type,i=e.payload,a=e.src;switch(r){case h.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(h.PeerEventType.Open,this.id);break;case h.ServerMessageType.Error:this._abort(h.PeerErrorType.ServerError,i.msg);break;case h.ServerMessageType.IdTaken:this._abort(h.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case h.ServerMessageType.InvalidKey:this._abort(h.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case h.ServerMessageType.Leave:l.default.log("Received leave message from "+a),this._cleanupPeer(a),this._connections.delete(a);break;case h.ServerMessageType.Expire:this.emitError(h.PeerErrorType.PeerUnavailable,"Could not connect to peer "+a);break;case h.ServerMessageType.Offer:var s=i.connectionId;if((y=this.getConnection(a,s))&&(y.close(),l.default.warn("Offer received for existing Connection ID:"+s)),i.type===h.ConnectionType.Media)y=new d.MediaConnection(a,this,{connectionId:s,_payload:i,metadata:i.metadata}),this._addConnection(a,y),this.emit(h.PeerEventType.Call,y);else{if(i.type!==h.ConnectionType.Data)return void l.default.warn("Received malformed connection type:"+i.type);y=new p.DataConnection(a,this,{connectionId:s,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable}),this._addConnection(a,y),this.emit(h.PeerEventType.Connection,y)}var c=this._getMessages(s);try{for(var u=o(c),f=u.next();!f.done;f=u.next()){var m=f.value;y.handleMessage(m)}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}break;default:if(!i)return void l.default.warn("You received a malformed message from "+a+" of type "+r);var y;s=i.connectionId,(y=this.getConnection(a,s))&&y.peerConnection?y.handleMessage(e):s?this._storeMessage(s,e):l.default.warn("You received an unrecognized message:",e)}},t.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},t.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},t.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return l.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(h.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var n=new p.DataConnection(e,this,t);return this._addConnection(e,n),n},t.prototype.call=function(e,t,n){if(void 0===n&&(n={}),this.disconnected)return l.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(h.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t){n._stream=t;var r=new d.MediaConnection(e,this,n);return this._addConnection(e,r),r}l.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},t.prototype._addConnection=function(e,t){l.default.log("add connection "+t.type+":"+t.connectionId+" to peerId:"+e),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},t.prototype._removeConnection=function(e){var t=this._connections.get(e.peer);if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)},t.prototype.getConnection=function(e,t){var n,r,i=this._connections.get(e);if(!i)return null;try{for(var a=o(i),s=a.next();!s.done;s=a.next()){var c=s.value;if(c.connectionId===t)return c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return null},t.prototype._delayedAbort=function(e,t){var n=this;setTimeout((function(){n._abort(e,t)}),0)},t.prototype._abort=function(e,t){l.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},t.prototype.emitError=function(e,t){var n;l.default.error("Error:",t),(n="string"==typeof t?new Error(t):t).type=e,this.emit(h.PeerEventType.Error,n)},t.prototype.destroy=function(){this.destroyed||(l.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(h.PeerEventType.Close))},t.prototype._cleanup=function(){var e,t;try{for(var n=o(this._connections.keys()),r=n.next();!r.done;r=n.next()){var i=r.value;this._cleanupPeer(i),this._connections.delete(i)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.socket.removeAllListeners()},t.prototype._cleanupPeer=function(e){var t,n,r=this._connections.get(e);if(r)try{for(var i=o(r),a=i.next();!a.done;a=i.next())a.value.close()}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t.prototype.disconnect=function(){if(!this.disconnected){var e=this.id;l.default.log("Disconnect peer with ID:"+e),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit(h.PeerEventType.Disconnected,e)}},t.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)l.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");l.default.error("In a hurry? We're still trying to make the initial connection!")}},t.prototype.listAllPeers=function(e){var t=this;void 0===e&&(e=function(e){}),this._api.listAllPeers().then((function(t){return e(t)})).catch((function(e){return t._abort(h.PeerErrorType.ServerError,e)}))},t.DEFAULT_KEY="peerjs",t}(c.EventEmitter);n.Peer=y},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./util"),i=e("./peer");n.peerjs={Peer:i.Peer,util:r.util},n.default=i.Peer,window.peerjs=n.peerjs,window.Peer=i.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"])},function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=357},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.destroyGuis=t.setupGuis=void 0;const i=n(359),o=n(248),a=n(215),s=r(n(253)),c=n(218);t.setupGuis=function(e,t,n,r){o.buildHotbar(e,t),i.setupDot(),i.setupDebug(e,t.server),o.buildInventory(e,t),a.setupChat(),s.default(e),c.setupTab()},t.destroyGuis=function(){null!=o.inventory&&o.inventory.dispose(),null!=o.hotbar&&o.hotbar.dispose(),null!=a.chatContainer&&a.chatContainer.dispose(),null!=a.input&&a.input.dispose(),null!=c.tabContainer&&c.tabContainer.dispose(),null!=i.debug&&i.debug.dispose(),null!=i.dot&&i.dot.dispose()}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.setupDot=t.dot=t.setupDebug=t.debug=void 0;const a=n(70),s=o(n(78)),c=n(95);t.setupDebug=function(e,n){const r=a.getUI(0),i=e.playerEntity,o=e.entities.getPositionData(i);let u;t.debug=new s.TextBlock,r.addControl(t.debug),t.debug.text="",t.debug.color="#f0f0f0",t.debug.fontSize=8*a.scale+"px",t.debug.left="5px",t.debug.top="5px",t.debug.shadowColor="#111111",t.debug.shadowOffsetX=1,t.debug.shadowOffsetY=1,t.debug.textHorizontalAlignment=s.Control.HORIZONTAL_ALIGNMENT_LEFT,t.debug.textVerticalAlignment=s.Control.VERTICAL_ALIGNMENT_TOP,u=null!=n?`Server: ${n}\n`:"Singleplayer world\n";let l=a.scale;const f=async()=>{const n=`${o.position[0].toFixed(1)}, ${o.position[1].toFixed(1)}, ${o.position[2].toFixed(1)}`,r=`VoxelSrv ${c.gameVersion}\nNoa: ${e.version}\nXYZ: ${n}\n${u}`;t.debug.text=r,l!=a.scale&&(l=a.scale,t.debug.fontSize=8*a.scale+"px")};e.on("tick",f),t.debug.onDisposeObservable.add(()=>{e.off("tick",f)})},t.setupDot=function(){a.getLayer(0);const e=a.getUI(0);t.dot=new s.Ellipse,t.dot.background="#eeeeee88",t.dot.height=2*a.scale+"px",t.dot.width=2*a.scale+"px",t.dot.thickness=0;const n=()=>{t.dot.height=2*a.scale+"px",t.dot.width=2*a.scale+"px"};a.event.on("scale-change",n),t.dot.onDisposeObservable.add(()=>{a.event.off("scale-change",n)}),e.addControl(t.dot)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=n(70),s=o(n(78)),c=n(216),u=n(217),l=n(130);t.default=function(e,t,n,r){document.title="VoxelSrv - Disconnected!";const i=new s.Rectangle;i.thickness=0,i.horizontalAlignment=2,i.zIndex=10,i.height=120*a.scale+"px",i.width=180*a.scale+"px",i.background="#11111166",a.getScreen(1).addControl(i);const o=new s.TextBlock;o.fontFamily="Lato",o.fontSize=11*a.scale,o.textVerticalAlignment=0,o.color="white",o.text="Disconnected!",o.top=a.scale,i.addControl(o);const f=new s.TextBlock;f.fontFamily="Lato",f.fontSize=9*a.scale,f.textVerticalAlignment=2,f.color="white",f.text=e,f.textWrapping=s.TextWrapping.WordWrap,i.addControl(f);const d=l.createItem();d.item.verticalAlignment=1,d.text.text=[{text:"Reconnect",color:"white",font:"Lato"}],d.item.top=`-${16*a.scale}px`,d.item.onPointerClickObservable.add(()=>{i.dispose(),n(r,new u.MPSocket(t))}),i.addControl(d.item);const p=l.createItem();p.item.verticalAlignment=1,p.text.text=[{text:"Main menu",color:"white",font:"Lato"}],p.item.onPointerClickObservable.add(()=>{i.dispose(),c.buildMainMenu(r)}),i.addControl(p.item);const h=e=>{i.height=120*a.scale+"px",i.width=180*a.scale+"px",o.fontSize=11*a.scale,p.item.width=100*a.scale+"px",p.item.height=18*a.scale+"px",p.text.fontSize=10*a.scale,d.item.width=100*a.scale+"px",d.item.height=18*a.scale+"px",d.text.fontSize=10*a.scale,d.item.top=`-${16*a.scale}px`};return a.event.on("scale-change",h),i.onDisposeObservable.add(()=>{a.event.off("scale-change",h)}),i}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.playSound=t.sounds=void 0;const a=o(n(141)),s=n(95);t.sounds={},t.playSound=function(e,n,r,i){const o=Object.keys(t.sounds)[Object.keys(t.sounds).length-1]+1;let c,u=n/10;function l(){t.sounds[o].play()}0>n?u=0:1<n&&(u=.1),console.log("Playing: "+e,"Volume: "+n,"Position: "+r),c=e.startsWith("http://")||e.startsWith("https://")&&1==s.gameSettings.allowcustom?e:"audio/"+e,null!=r?(t.sounds[o]=new a.Sound("Sound",c,i.rendering.getScene(),l,{volume:u,spatialSound:!0,maxDistance:100}),t.sounds[o].setPosition(new a.Vector3(r[0],r[1],r[2]))):t.sounds[o]=new a.Sound("Sound",c,i.rendering.getScene(),l,{volume:u}),t.sounds[o].onended=function(){delete t.sounds[o]}}},function(e,t,n){const r=n(363);let i=null;function o(e){const t=r(e);return["jpg","jpeg"].includes(t)?"image/jpeg":"image/png"}e.exports=function(e,t={}){const n=new Date,{filename:r=`Screen Shot ${n.toISOString().slice(0,10)} at ${n.toTimeString().slice(0,8).replace(/:/g,".")}.png`,quality:a=1,useBlob:s,download:c=!0}={...t};if(c&&(i=i||document.createElement("a"),i.download=r),s)return new Promise(t=>{e.toBlob(e=>{if(c){const t=URL.createObjectURL(e);i.href=t;const n=new MouseEvent("click");i.dispatchEvent(n),setTimeout(()=>{URL.revokeObjectURL(t)},1)}t(e)},o(r),a)});const u=e.toDataURL(o(r)+";base64",a);if(c){i.href=u;const e=new MouseEvent("click");i.dispatchEvent(e)}return u}},function(e,t,n){"use strict";
/*! file-extension v4.0.5 | (c) silverwind | BSD license */e.exports=function(e,t){if(t||(t={}),!e)return"";var n=(/[^./\\]*$/.exec(e)||[""])[0];return t.preserveCase?n:n.toLowerCase()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupMobile=void 0;const r=n(70);t.setupMobile=function(e){console.log("Using mobile controls"),r.getScreen(1),r.getUI(1);let t=0,n=0,i=!1,o=null,a=null,s=[0,0];e.container.canvas.ontouchstart=function(r){s=[r.clientX,r.clientY],r.target==e.container.canvas&&(r.preventDefault(),null!=o&&(clearInterval(o),clearInterval(a)),i=!0,n=(new Date).getTime()/1e3,o=setInterval((function(){t=(new Date).getTime()/1e3-n}),2),a=setInterval((function(){t>.7&&e.inputs.down.emit("fire")}),400))},e.container.canvas.ontouchmove=function(e){e.preventDefault();let t=Math.abs(s[0]-e.targetTouches[0].clientX),r=Math.abs(s[1]-e.targetTouches[0].clientY);(t>3||r>3)&&(n=(new Date).getTime()/1e3+.5),s=[e.targetTouches[0].clientX,e.targetTouches[0].clientY]},e.container.canvas.ontouchend=function(n){n.target==e.container.canvas&&(n.preventDefault(),0<=t&&t<.7&&e.inputs.down.emit("alt-fire"),null!=o&&(clearInterval(o),clearInterval(a)),i=!1,t=0)},e.container.canvas.ontouchcancel=function(n){n.target==e.container.canvas&&(n.preventDefault(),null!=o&&(clearInterval(o),clearInterval(a)),i=!1,t=0)};const c=document.createElement("div");c.id="game_mobile_controls",document.body.appendChild(c);let u=null,l={x:0,y:0};var f=document.createElement("div");function d(t,n){t=Math.round(t/50),0==(n=Math.round(n/50))?(e.inputs.state.forward=!1,e.inputs.state.backward=!1):n>0?(e.inputs.state.forward=!1,e.inputs.state.backward=!0):n<0&&(e.inputs.state.forward=!0,e.inputs.state.backward=!1),0==t?(e.inputs.state.left=!1,e.inputs.state.right=!1):t>0?(e.inputs.state.left=!1,e.inputs.state.right=!0):t<0&&(e.inputs.state.left=!0,e.inputs.state.right=!1)}f.id="game_mobile_joystick",f.ontouchstart=function(e){e.target==f&&(e.preventDefault(),f.style.transition="0s",u=(e.changedTouches,{x:e.targetTouches[0].clientX,y:e.targetTouches[0].clientY}))},f.ontouchmove=function(e){if(e.target!=f)return;if(null===u)return;e.preventDefault();const t=e.targetTouches[0].clientX-u.x,n=e.targetTouches[0].clientY-u.y,r=Math.atan2(n,t),i=Math.min(50,Math.hypot(t,n)),o=i*Math.cos(r),a=i*Math.sin(r);f.style.transform="translate("+(o+16)+"px, "+(a+16)+"px)",l={x:o,y:a},d(o,a)},f.ontouchend=function(e){e.target==f&&(e.preventDefault(),null!==u&&(f.style.transition=".1s",f.style.transform="translate(16px, 16px)",u=null,l={x:0,y:0},d(0,0)))},c.appendChild(f);var p=document.createElement("div");p.id="game_mobile_jump",p.ontouchstart=function(){e.inputs.state.jump=!0},p.ontouchend=function(){e.inputs.state.jump=!1},p.ontouchcancel=function(){e.inputs.state.jump=!1},document.body.appendChild(p);var h=document.createElement("div");h.id="game_mobile_topbuttons",document.body.appendChild(h);var m=document.createElement("div");m.id="game_mobile_chat",m.innerHTML="",m.ontouchstart=function(t){t.preventDefault(),e.inputs.down.emit("chat")},h.appendChild(m);var y=document.createElement("div");y.id="game_mobile_menu",y.ontouchstart=function(t){t.preventDefault(),e.inputs.down.emit("menu")},h.appendChild(y)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupGamepad=void 0;const r=n(95);t.setupGamepad=function(e){let t=null,n=!1,i=!1,o=!1;e.on("beforeRender",(function(){t=r.gameSettings.gamepad&&null!=navigator.getGamepads()[0]?navigator.getGamepads()[0]:null,null!=t&&(!function(t,n,r,i){t=Math.round(t),0==(n=Math.round(n))?(e.inputs.state.forward=!1,e.inputs.state.backward=!1):n>0?(e.inputs.state.forward=!1,e.inputs.state.backward=!0):n<0&&(e.inputs.state.forward=!0,e.inputs.state.backward=!1);0==t?(e.inputs.state.left=!1,e.inputs.state.right=!1):t>0?(e.inputs.state.left=!1,e.inputs.state.right=!0):t<0&&(e.inputs.state.left=!0,e.inputs.state.right=!1);e.camera.heading=e.camera.heading+Math.trunc(10*r)/500,e.camera.pitch=e.camera.pitch+Math.trunc(10*i)/500}(t.axes[0],t.axes[1],t.axes[2],t.axes[3]),e.inputs.state.jump=t.buttons[0].pressed,t.buttons[13].pressed&&e.inputs.down.emit("mid-fire"),t.buttons[2].pressed&&!n&&(e.inputs.down.emit("inventory"),n=!0,setTimeout((function(){n=!1}),200)),t.buttons[6].pressed&&!i&&(e.inputs.down.emit("alt-fire"),i=!0,setTimeout((function(){i=!1}),200)),t.buttons[7].pressed&&!o&&(e.inputs.down.emit("fire"),o=!0,setTimeout((function(){o=!1}),200)))})),setInterval((function(){null!=t&&(t.buttons[4].pressed?e.inputs.state.scrolly=-1:t.buttons[5].pressed?e.inputs.state.scrolly=1:e.inputs.state.scrolly=0)}),140)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.warningFirefox=void 0;const a=o(n(78)),s=n(130),c=n(367),u=n(70);t.warningFirefox=function(){const e=c.createWindow(200,100,"Warning!",!1),t=new a.TextBlock;t.text="Warning. Firefox might have performance issues. For the best performance, you should use Chromium(-based) browser.\n\t\t\t\tI know you aren't too happy about it, but I can't do much about it.",t.textWrapping=1,t.fontSize=20,t.color="#111111",t.textVerticalAlignment=0,e.main.paddingTop=10,e.main.paddingRight=10,e.main.paddingLeft=10,e.main.paddingBottom=10,e.main.addControl(t);const n=s.createItem();n.item.verticalAlignment=1,n.text.text=[{text:"Okay, let me play",color:"#222222"}],n.item.onPointerClickObservable.add(()=>e.window.dispose()),e.main.addControl(n.item),console.log("Firefox detected! Displaying warning!"),e.window.isVisible=!0,e.window.verticalAlignment=2,e.window.horizontalAlignment=2,u.getScreen(1).addControl(e.window)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createWindow=void 0;const a=o(n(78)),s=n(156),c=n(70);t.createWindow=function(e,t,n,r){const i=c.getScreen(1),o=new a.Rectangle;o.width=e*c.scale+"px",o.height=t*c.scale+"px",o.zIndex=1e3,o.thickness=0,o.verticalAlignment=0,o.horizontalAlignment=0,o.background="#EEEEEEDB";let u=!1,l=[],f=[o.leftInPixels,o.topInPixels];const d=new a.Rectangle;if(d.width=e*c.scale+"px",d.height=12*c.scale+"px",d.thickness=0,d.background="#2b2b2bed",d.verticalAlignment=0,r){d.onPointerDownObservable.add(e=>{u=!0,l=[e.x,e.y],f=[o.leftInPixels,o.topInPixels]}),d.onPointerUpObservable.add(()=>{u=!1});const e=i.onPointerMoveObservable.add(e=>{u&&(console.log(),o.left=-(l[0]-e.x)+f[0],o.top=-(l[1]-e.y)+f[1])});o.onDisposeObservable.add(()=>{i.onPointerMoveObservable.remove(e)})}o.addControl(d);const p=new s.FormTextBlock;p.fontSize=6.5*c.scale+"px",p.text="string"==typeof n?[{text:n,color:"white"}]:n,d.addControl(p);const h=new a.Ellipse;h.width=7*c.scale+"px",h.height=7*c.scale+"px",h.left=-2*c.scale+"px",h.thickness=0,h.isPointerBlocker=!0,h.zIndex=200,h.background="#DD4444AE",h.verticalAlignment=2,h.horizontalAlignment=1,h.onPointerClickObservable.add(()=>{o.dispose()}),d.addControl(h);const m=new a.Rectangle;return m.top=12*c.scale+"px",m.width=e*c.scale+"px",m.height=(t-12)*c.scale+"px",m.thickness=0,m.verticalAlignment=0,o.addControl(m),{main:m,bar:d,text:p,window:o}}},function(e,t,n){"use strict";n.r(t);var r=n(293),i=n(123).EventEmitter;function o(e,t){t=t||{},this._noa=e,this._tickRate=t.tickRate,this.element=t.domElement||function(){var e=document.createElement("div");return e.tabindex=1,e.style.position="fixed",e.style.left="0px",e.style.right="0px",e.style.top="0px",e.style.bottom="0px",e.style.height="100%",e.style.overflow="hidden",document.body.appendChild(e),document.body.style.overflow="hidden",document.body.style.height="100%",e.id="noa-container",e}(),this.canvas=function(e){var t=e.querySelector("canvas");t||((t=document.createElement("canvas")).style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.height="100%",t.style.width="100%",t.id="noa-canvas",e.insertBefore(t,e.firstChild));return t}(this.element),this._shell=function(e,t){(t=Object.assign({pointerLock:!1,preventDefaults:!1},t)).element=e;var n=r(t);return n.preventDefaults=t.preventDefaults,n}(this.canvas,t),this.hasPointerLock=!1,this.supportsPointerLock=!1,this.pointerInGame=!1,this.isFocused=document.hasFocus();var n=this,i=function(e){!function(e,t){var n=document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement;n?(e.hasPointerLock=!0,e.emit("gainedPointerLock")):(e.hasPointerLock=!1,e.emit("lostPointerLock"));n&&(e.pointerInGame=!0)}(n)};document.addEventListener("pointerlockchange",i,!1),document.addEventListener("mozpointerlockchange",i,!1),document.addEventListener("webkitpointerlockchange",i,!1),function(e){if("pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document){e.supportsPointerLock=!0;var t=function(n){e.supportsPointerLock=!1,document.removeEventListener(n.type,t)};document.addEventListener("touchmove",t)}}(n),n.element.addEventListener("mouseenter",(function(){n.pointerInGame=!0})),n.element.addEventListener("mouseleave",(function(){n.pointerInGame=!1})),window.addEventListener("focus",(function(){n.isFocused=!0})),window.addEventListener("blur",(function(){n.isFocused=!1})),this._shell.on("init",a.bind(null,this))}function a(e){var t=e._noa;e._shell.on("resize",t.rendering.resize.bind(t.rendering)),function(e){var t=e._noa,n=e._tickRate,r=performance.now(),i=0,o=function(){var e=performance.now();i+=e-r;for(var a=2;i>n&&a-- >0;)t.tick(n),i-=n;i>n&&(i=0);var s=performance.now(),c=i+(s-e),u=Math.min(1,c/n);t.render(u),r=e,requestAnimationFrame(o)};requestAnimationFrame(o)}(e),e.emit("DOMready")}function s(e,t){var n=e.indexOf(t);n<0||(n===e.length-1?e.pop():e[n]=e.pop())}function c(e,t,n){for(var r=(n||performance.now())+e,i=0;i<1e3;i++){if(t()||performance.now()>r)return}}o.prototype=Object.create(i.prototype),o.prototype.appendTo=function(e){this.element.appendChild(e)},o.prototype.setPointerLock=function(e){this._shell.pointerLock=!!e};var u=0,l=0;function f(e,t,n,r,i){e?function(e,t,n,r,i,o,a,s,c,u,l){for(var f=0;f<o;f++)for(var d=0;d<a;d++)for(var p=e.index(n+f,r+d,i),h=t.index(c+f,u+d,l),m=0;m<s;m++)t.data[h]=e.data[p],p+=e.stride[2],h+=t.stride[2]}(e,t,n[0],n[1],n[2],r[0],r[1],r[2],i[0],i[1],i[2]):function(e,t,n,r,i,o,a){for(var s=0;s<i;s++)for(var c=0;c<o;c++)for(var u=e.index(t+s,n+c,r),l=0;l<a;l++)e.data[u]=0,u+=e.stride[2]}(t,i[0],i[1],i[2],r[0],r[1],r[2])}function d(){this.arr=[],this.hash={}}d.prototype.includes=function(e){return this.hash[e]},d.prototype.add=function(e){this.hash[e]||(this.arr.push(e),this.hash[e]=!0)},d.prototype.remove=function(e){this.hash[e]&&(this.arr.splice(this.arr.indexOf(e),1),delete this.hash[e])},d.prototype.count=function(){return this.arr.length},d.prototype.forEach=function(e,t){return this.arr.forEach(e,t)},d.prototype.slice=function(e,t){return this.arr.slice(e,t)},d.prototype.isEmpty=function(){return 0===this.arr.length},d.prototype.empty=function(){this.arr.length=0,this.hash={}},d.prototype.pop=function(){var e=this.arr.pop();return delete this.hash[e],e},d.prototype.sort=function(e){var t={};this.arr.forEach(n=>{t[n]=e(n)}),this.arr.sort((e,n)=>t[n]-t[e])},d.prototype.copyFrom=function(e){this.arr=e.arr.slice(),this.hash=Object.assign({},e.hash)};var p=n(18),h=n(59),m=n(112),y=n(144),v=n(12),g=n(80),b=n(28),w=n(22),_=n(6),k=n(202),x=(n(171),n(77)),O={showFPS:!1,antiAlias:!0,clearColor:[.8,.9,1],ambientColor:[1,1,1],lightDiffuse:[1,1,1],lightSpecular:[1,1,1],groundLightColor:[.5,.5,.5],useAO:!0,AOmultipliers:[.93,.8,.5],reverseAOmultiplier:1,preserveDrawingBuffer:!0};function P(e,t,n){this.noa=e,t=Object.assign({},O,t),this.useAO=!!t.useAO,this.aoVals=t.AOmultipliers,this.revAoVal=t.reverseAOmultiplier,this.meshingCutoffTime=6,this._resizeDebounce=250,function(e,t,n){e._engine=new v.a(t,n.antiAlias,{preserveDrawingBuffer:n.preserveDrawingBuffer},n.adaptToDeviceRatio),e._multiscenes=new Array,e._scene=new p.a(e._engine);var r=e._scene;e._multiscenes.push(r),r.detachControl(),r._addComponent(new k.c(r)),e._octree=new m.a(e=>{}),e._octree.blocks=[],r._selectionOctree=e._octree,e._cameraHolder=new _.a("camHolder",r),e._camera=new h.a("camera",new w.z(0,0,0),r),e._camera.parent=e._cameraHolder,e._camera.minZ=.01,e._cameraHolder.visibility=!1,e._camScreen=_.a.CreatePlane("camScreen",10,r),e.addMeshToScene(e._camScreen),e._camScreen.position.z=.1,e._camScreen.parent=e._camera,e._camScreenMat=e.makeStandardMaterial("camscreenmat"),e._camScreen.material=e._camScreenMat,e._camScreen.setEnabled(!1),e._camLocBlock=0;var i=new w.z(.1,1,.3);function o(e){return new w.e(e[0],e[1],e[2])}e._light=new g.a("light",i,r),r.clearColor=o(n.clearColor),r.ambientColor=o(n.ambientColor),e._light.diffuse=o(n.lightDiffuse),e._light.specular=o(n.lightSpecular),e._light.groundColor=o(n.groundLightColor),e.flatMaterial=e.makeStandardMaterial("flatmat")}(this,n,t),t.showFPS&&function(){var e=document.createElement("div");e.id="noa_fps";"color:white; background-color:rgba(0,0,0,0.5);","font:14px monospace; text-align:center;","min-width:2em; margin:4px;",e.style="position:absolute; top:0; right:0; z-index:0;color:white; background-color:rgba(0,0,0,0.5);font:14px monospace; text-align:center;min-width:2em; margin:4px;",document.body.appendChild(e);var t=0,n=0,r=performance.now(),i=r;E=function(){t++;var o=performance.now();if(o-i>n&&(n=o-i),i=o,!(o-r<1e3)){var a=Math.round(t/(o-r)*1e3),s=Math.round(1/n*1e3);e.innerHTML=a+"<br>"+s,t=0,n=0,r=o}}}()}P.prototype.getScene=function(){return this._scene},P.prototype.getEngine=function(){return this._engine},P.prototype.addScene=function(e){this._multiscenes.push(e)},P.prototype.getSceneArray=function(e){return this._multiscenes},P.prototype.tick=function(e){},P.prototype.render=function(e){T("start"),function(e){var t=e.noa.camera,n=t._localGetTargetPosition();e._cameraHolder.position.copyFromFloats(n[0],n[1],n[2]),e._cameraHolder.rotation.x=t.pitch,e._cameraHolder.rotation.y=t.heading,e._camera.position.z=-t.currentZoom;var r=t._localGetPosition(),i=e.noa.worldOriginOffset,o=Math.floor(r[0]+i[0]),a=Math.floor(r[1]+i[1]),s=Math.floor(r[2]+i[2]),c=e.noa.getBlock(o,a,s);!function(e,t){if(t===e._camLocBlock)return;if(0===t)e._camScreen.setEnabled(!1);else{var n=e.noa.registry.getBlockFaceMaterial(t,0);if(n){var r=e.noa.registry.getMaterialData(n),i=r.color,o=r.alpha;i&&o&&o<1&&(e._camScreenMat.diffuseColor.set(0,0,0),e._camScreenMat.ambientColor.set(i[0],i[1],i[2]),e._camScreenMat.alpha=o,e._camScreen.setEnabled(!0))}}e._camLocBlock=t}(e,c)}(this),T("updateCamera"),this._engine.beginFrame(),T("beginFrame"),this._multiscenes.forEach(e=>{e.render()}),T("render"),E(),this._engine.endFrame(),T("endFrame"),T("end")},P.prototype.resize=function(e){S||(S=!0,setTimeout(()=>{this._engine.resize(),S=!1},this._resizeDebounce))};var S=!1;P.prototype.highlightBlockFace=function(e,t,n){var r=function(e){var t=e._highlightMesh;if(!t){t=_.a.CreatePlane("highlight",1,e._scene);var n=e.makeStandardMaterial("highlightMat");n.backFaceCulling=!1,n.emissiveColor=new w.e(1,1,1),n.alpha=.2,t.material=n;var r=.5,i=_.a.CreateLines("hightlightLines",[new w.z(r,r,0),new w.z(r,-r,0),new w.z(-r,-r,0),new w.z(-r,r,0),new w.z(r,r,0)],e._scene);i.color=new w.e(1,1,1),i.parent=t,e.addMeshToScene(t),e.addMeshToScene(i),e._highlightMesh=t}return t}(this);if(e){this.noa.globalToLocal(t,null,C);for(var i=.001+.001*x.dist(this.noa.camera._localGetPosition(),C),o=0;o<3;o++)0===n[o]?C[o]+=.5:C[o]+=n[o]>0?1+i:-i;r.position.copyFromFloats(C[0],C[1],C[2]),r.rotation.x=n[1]?Math.PI/2:0,r.rotation.y=n[0]?Math.PI/2:0}r.setEnabled(e)};var C=[];P.prototype.addMeshToScene=function(e,t,n,r){if(!e._noaContainingChunk&&!this._octree.dynamicContent.includes(e)){if(!e.parent){n||(n=[e.position.x,e.position.y,e.position.z]);var i=[];this.noa.globalToLocal(n,null,i),e.position.copyFromFloats(i[0],i[1],i[2])}var o=!1;if(t){var a=r||this.noa.world._getChunkByCoords(n[0],n[1],n[2]);o=!(!a||!a.octreeBlock)}o?(a.octreeBlock.entries.push(e),e._noaContainingChunk=a):this._octree.dynamicContent.push(e),t&&(e.freezeWorldMatrix(),e.freezeNormals());var s=this.removeMeshFromScene.bind(this,e);e.onDisposeObservable.add(s)}},P.prototype.removeMeshFromScene=function(e){e._noaContainingChunk&&e._noaContainingChunk.octreeBlock&&s(e._noaContainingChunk.octreeBlock.entries,e),e._noaContainingChunk=null,s(this._octree.dynamicContent,e)},P.prototype.makeStandardMaterial=function(e){var t=new b.a(e,this._scene);return t.specularColor.copyFromFloats(0,0,0),t.ambientColor.copyFromFloats(1,1,1),t.diffuseColor.copyFromFloats(1,1,1),t},P.prototype.prepareChunkForRendering=function(e){var t=e.size,n=[];this.noa.globalToLocal([e.x,e.y,e.z],null,n);var r=new w.z(n[0],n[1],n[2]),i=new w.z(n[0]+t,n[1]+t,n[2]+t);e.octreeBlock=new y.a(r,i,void 0,void 0,void 0,e=>{}),this._octree.blocks.push(e.octreeBlock)},P.prototype.disposeChunkForRendering=function(e){e.octreeBlock&&(s(this._octree.blocks,e.octreeBlock),e.octreeBlock.entries.length=0,e.octreeBlock=null)},P.prototype._rebaseOrigin=function(e){var t=new w.z(e[0],e[1],e[2]);this._scene.meshes.forEach(e=>{e.parent||(e.position.subtractInPlace(t),e._isWorldMatrixFrozen&&e.markAsDirty())}),this._octree.blocks.forEach(e=>{e.minPoint.subtractInPlace(t),e.maxPoint.subtractInPlace(t),e._boundingVectors.forEach(e=>{e.subtractInPlace(t)})})},P.prototype.debug_SceneCheck=function(){var e=this._scene.meshes,t=this._octree.dynamicContent,n=[],r=0,i=0,o=this._scene.materials,a=[];o.forEach(e=>{e.subMaterials?e.subMaterials.forEach(e=>a.push(e)):a.push(e)}),this._octree.blocks.forEach((function(e){r++,e.entries.forEach(e=>n.push(e))})),e.forEach((function(e){if(e._isDisposed&&u(e,"disposed mesh in scene"),0!==e.getIndices().length)if(l(e,t,n)&&u(e,"non-empty mesh missing from octree"),e.material){i+=e.subMeshes?e.subMeshes.length:1;var r=e.material.subMaterials||[e.material];r.forEach((function(e){l(e,r)&&u(e,"mesh material not in scene")}))}else u(e,"non-empty scene mesh with no material")}));var s=[];a.forEach(t=>{var n=!1;e.forEach(e=>{e.material===t&&(n=!0),e.material&&e.material.subMaterials&&e.material.subMaterials.includes(t)&&(n=!0)}),n||s.push(t.name)}),s.length&&console.warn("Materials unused by any mesh: ",s.join(", ")),t.forEach((function(t){l(t,e)&&u(t,"octree/dynamic mesh not in scene")})),n.forEach((function(t){l(t,e)&&u(t,"octree block mesh not in scene")}));var c=Math.round(10*n.length/r)/10;function u(e,t){console.warn(e.name+" --- "+t)}function l(e,t,n){return!!e&&(!t.includes(e)&&(!n||!n.includes(e)))}return console.log("meshes - octree:",n.length,"  dynamic:",t.length,"   subMeshes:",i,"   avg meshes/octreeBlock:",c),"done."},P.prototype.debug_MeshCount=function(){var e={};for(var t in this._scene.meshes.forEach(t=>{var n=t.name||"";n=(n=(n=(n=n.replace(/-\d+.*/,"#")).replace(/\d+.*/,"#")).replace(/(rotHolder|camHolder|camScreen)/,"rendering use")).replace(/atlas sprite .*/,"atlas sprites"),e[n]=e[n]||0,e[n]++}),e)console.log("   "+(e[t]+"       ").substr(0,7)+t)};var T=()=>{},E=function(){};var j=n(132),M=n.n(j),D=n(65),I=n(15),R=n(72),A=n(10),B=function(e){var t=new V(e),n=new U(e);this.meshChunk=function(r,i,o,a,s,c,u){G("start");var l=i||e.registry.getBlockFaceMaterial,d=o||e.registry._getMaterialVertexColor,p=void 0===s?e.rendering.useAO:s,h=c||e.rendering.aoVals,m=isNaN(u)?e.rendering.revAoVal:u,y=function(e){var t=e.voxels.shape[0],n=z;if(t+2!==n.shape[0]){var r=t+2;n=new M.a(new Uint16Array(r*r*r),[r,r,r]),z=n}var i=N[0],o=N[1],a=N[2],s=N[3],c=N[4],u=N[5],l=N[6];t!==L&&(L=t,function(e,t,n,r){for(var i=0;i<3;i++)t[i]=[e-1,0,0][i],n[i]=[1,e,1][i],r[i]=[0,1,e+1][i]}(t,c,u,l));for(var d=0;d<3;d++){i[0]=d;for(var p=0;p<3;p++){i[1]=p;for(var h=0;h<3;h++){i[2]=h;for(var m=0;m<3;m++){var y=i[m];o[m]=c[y],a[m]=u[y],s[m]=l[y]}var v=e._neighbors.get(d-1,p-1,h-1);f(v?v.voxels:null,n,o,a,s)}}}return n}(r);G("copy");var v,g=r.isFull||r.isEmpty,b=t.mesh(y,l,d,p,h,m,g);return b.length&&(v=n.build(r,b,a),G("terrain")),G("end"),v||null}};var L,z=new M.a(new Uint16Array(27),[3,3,3]),N=Array.from(Array(10)).map(e=>[0,0,0]);function F(e){this.id=0|e,this.positions=[],this.indices=[],this.normals=[],this.colors=[],this.uvs=[],this.mergeable=!1}function U(e){function t(e,t){for(var r=[],i=[],o=[],a=null,s=0;s<e.length;++s){var c=e[s];if(t||c.mergeable)if(r.push(c.positions.length),i.push(c.indices.length),o.push(c.id),a){var u=a.positions.length/3;n(a.positions,c.positions),n(a.normals,c.normals),n(a.colors,c.colors),n(a.uvs,c.uvs);for(var l=0,f=c.indices.length;l<f;++l)a.indices.push(c.indices[l]+u);e.splice(s,1),c.dispose(),s--}else a=c}return{vertices:r,indices:i,matIDs:o}}function n(e,t){for(var n=0;n<t.length;n++)e.push(t[n])}this.build=function(n,i,o){for(var a=0,s=0;s<i.length;s++){var c=i[s];if(o)c.mergeable=!0;else{var u=e.registry.getMaterialTexture(c.id),l=e.registry.getMaterialData(c.id);c.mergeable=!u&&1===l.alpha&&!l.renderMat}c.mergeable&&a++}a>1&&t(i,!1);var f=t(i,!0);return function(t,n,r,i,o){var a=e.rendering.getScene(),s=new _.a(n,a),c=new I.a;if(c.positions=t.positions,c.indices=t.indices,c.normals=t.normals,c.colors=t.colors,c.uvs=t.uvs,c.applyToMesh(s),t.dispose(),1===r.length)s.material=r[0];else{var u=new R.a("multimat "+n,a);s.subMeshes=[];for(var l=0,f=0,d=0;d<r.length;d++){u.subMaterials[d]=r[d];var p=new D.a(d,l,i[d],f,o[d],s);s.subMeshes[d]=p,l+=i[d],f+=o[d]}s.material=u}return s}(i[0],"chunk_"+n.id,f.matIDs.map(t=>function(t,n){if(n)return e.rendering.flatMaterial;var i="terrain mat "+t;r[i]||(r[i]=function(t){var n=e.registry.getMaterialData(t);if(n.renderMat)return n.renderMat;var r=e.registry.getMaterialTexture(t),i=n.alpha;if(!r&&1===i)return e.rendering.flatMaterial;var o=e.rendering.flatMaterial.clone("terrain"+t);if(r){var a=e.rendering.getScene(),s=new A.a(r,a,!0,!1,A.a.NEAREST_SAMPLINGMODE);n.textureAlpha&&(s.hasAlpha=!0),o.diffuseTexture=s}n.alpha<1&&(o.alpha=n.alpha);return o}(t));return r[i]}(t,o)),f.vertices,f.indices)};var r={}}function V(e){var t=new Int16Array(16),n=new Uint16Array(16),r=null,i=e.registry._solidityLookup,o=e.registry._opacityLookup;function a(e,i,o,a){for(var c=o.shape[1],u=t,l=n,f=0,d=2*i,p=o.data,h=o.index(e-1,0,0),m=o.stride[0],y=o.stride[1],v=o.stride[2],g=0;g<c;++g){var b=h;h+=v;for(var w=0;w<c;w++,f++,b+=y){var _=p[b],k=p[b+m];if(_!==k){var x=s(_,k,a,d);x&&(u[f]=x>0?a(_,d):-a(k,d+1),r&&(l[f]=x>0?r(o,e,e-1,w,g):r(o,e-1,e,w,g)))}}}}function s(e,t,n,r){var i=o[e],a=o[t];if(i&&a)return 0;if(i)return 1;if(a)return-1;var s=n(e,r),c=n(t,r+1);return s===c?0:0===s?-1:0===c?1:0}function c(e,r,i,o,a,s,c,p,h,m,y){var v=0,g=t,b=n,w=[0,0,0],_=[0,0,0],k=[0,0,0];w[r]=e;for(var x=[0,0,0],O=c?u:l,P=c?d:f,S=0;S<s;++S)for(var C=1,T=1,E=0;E<a;E+=C,v+=C){var j=0|g[v];if(j){var M=0|b[v];for(C=1;C<a-E&&O(v+C,g,j,b,M);++C);e:for(T=1;T<s-S;++T)for(var D=0;D<C;++D){if(!O(v+D+T*a,g,j,b,M))break e}var I=Math.abs(j);p[I]||(p[I]=new F(I));var R=p[I],A=P(R.colors,h(I),M,m,y);w[i]=E,w[o]=S,_[i]=C,k[o]=T;var B=R.positions;B.push(w[0],w[1],w[2],w[0]+_[0],w[1]+_[1],w[2]+_[2],w[0]+_[0]+k[0],w[1]+_[1]+k[1],w[2]+_[2]+k[2],w[0]+k[0],w[1]+k[1],w[2]+k[2]);var L=j>0?1:-1;2===r?R.uvs.push(0,T,-L*C,T,-L*C,0,0,0):R.uvs.push(0,C,0,0,L*T,0,L*T,C);var z=B.length/3-4;j<0?A?R.indices.push(z,z+1,z+2,z,z+2,z+3):R.indices.push(z+1,z+2,z+3,z,z+1,z+3):A?R.indices.push(z,z+2,z+1,z,z+3,z+2):R.indices.push(z+3,z+1,z,z+3,z+2,z+1),x[r]=L,R.normals.push(x[0],x[1],x[2],x[0],x[1],x[2],x[0],x[1],x[2],x[0],x[1],x[2]);for(var N=0;N<T;++N)for(var U=0;U<C;++U)g[v+U+N*a]=0}else C=1}}function u(e,t,n,r,i){return n===t[e]&&i===r[e]}function l(e,t,n,r,i){return n===t[e]}function f(e,t,n,r,i){return e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),!0}function d(e,t,n,r,i){var o=m(n,0,0),a=m(n,1,0),s=m(n,1,1),c=m(n,0,1);y(e,t,o,r,i),y(e,t,a,r,i),y(e,t,s,r,i),y(e,t,c,r,i);return o===s?c!==a||2===c:c!==a&&o+s>c+a}function p(e,t,n,r,o){var a=1,s=1,c=1,u=1;return i[e.get(t,r+1,o)]&&(++c,++u),i[e.get(t,r-1,o)]&&(++a,++s),i[e.get(t,r,o+1)]&&(++s,++u),i[e.get(t,r,o-1)]&&(++a,++c),i[e.get(t,r,o)]?(u=3===u||i[e.get(t,r+1,o+1)]?3:2,s=3===s||i[e.get(t,r-1,o+1)]?3:2,c=3===c||i[e.get(t,r+1,o-1)]?3:2,a=3===a||i[e.get(t,r-1,o-1)]?3:2):(1===u&&i[e.get(t,r+1,o+1)]&&(u=2),1===s&&i[e.get(t,r-1,o+1)]&&(s=2),1===c&&i[e.get(t,r+1,o-1)]&&(c=2),1===a&&i[e.get(t,r-1,o-1)]&&(a=2)),u<<6|c<<4|s<<2|a}function h(e,t,n,r,o){var a=1,s=1,c=1,u=1;return i[e.get(t,r+1,o)]&&(++c,++u),i[e.get(t,r-1,o)]&&(++a,++s),i[e.get(t,r,o+1)]&&(++s,++u),i[e.get(t,r,o-1)]&&(++a,++c),i[e.get(t,r,o)]?(u=3===u||i[e.get(t,r+1,o+1)]?3:2,s=3===s||i[e.get(t,r-1,o+1)]?3:2,c=3===c||i[e.get(t,r+1,o-1)]?3:2,a=3===a||i[e.get(t,r-1,o-1)]?3:2):(1===u&&(i[e.get(t,r+1,o+1)]?u=2:i[e.get(n,r,o+1)]&&i[e.get(n,r+1,o)]&&i[e.get(n,r+1,o+1)]||(u=0)),1===c&&(i[e.get(t,r+1,o-1)]?c=2:i[e.get(n,r,o-1)]&&i[e.get(n,r+1,o)]&&i[e.get(n,r+1,o-1)]||(c=0)),1===s&&(i[e.get(t,r-1,o+1)]?s=2:i[e.get(n,r,o+1)]&&i[e.get(n,r-1,o)]&&i[e.get(n,r-1,o+1)]||(s=0)),1===a&&(i[e.get(t,r-1,o-1)]?a=2:i[e.get(n,r,o-1)]&&i[e.get(n,r-1,o)]&&i[e.get(n,r-1,o-1)]||(a=0))),u<<6|c<<4|s<<2|a}function m(e,t,n){return e>>(t?n?6:4:n?2:0)&3}function y(e,t,n,r,i){var o=0===n?i:r[n-1];e.push(t[0]*o,t[1]*o,t[2]*o,1)}this.mesh=function(s,u,l,f,d,m,y){i=e.registry._solidityLookup,o=e.registry._opacityLookup;var v={},g=m===d[0];r=f?g?p:h:null;for(var b=0;b<3;++b){var w=(b+1)%3,_=(b+2)%3,k=s.shape,x=s.transpose(b,w,_).lo(1,1,1).hi(k[b]-2,k[w]-2,k[_]-2),O=x.shape[0]-1,P=x.shape[1],S=x.shape[2];t.length<P*S&&(t=new Int16Array(P*S),n=new Uint16Array(P*S));for(var C=0;C<=O;++C)a(C,b,x,u),G("masks"),c(C,b,w,_,P,S,f,v,l,d,m),y&&(C+=O-1),G("submeshes")}return Object.keys(v).map(e=>v[e])}}F.prototype.dispose=function(){this.positions=null,this.indices=null,this.normals=null,this.colors=null,this.uvs=null};var G=()=>{},W=n(197),q=new function(){function e(e,t,n,r,i,o){var a=e._objectBlocks,s=new W.a("object_sps_"+e.id,t,{updatable:!1}),c=e.noa.registry._blockHandlerLookup,u=e.noa.registry._blockMeshLookup;for(var l in n){var f,d=u[l],p=n[l],h=p.length,m=c[l];m&&(f=m.onCustomMeshCreate);s.addShape(d,h,{positionFunction:function(e,t,n){var s=p[n],c=a[s];e.position.set(c.x+.5,c.y,c.z+.5),f&&f(e,r+c.x,i+c.y,o+c.z)}}),p.length=0}return s}this.initChunk=function(e){e._objectBlocks={},e._objectSystems=[]},this.disposeChunk=function(e){this.removeObjectMeshes(e),e._objectBlocks=null},this.addObjectBlock=function(e,t,n,r,i){var o=n+"|"+r+"|"+i;e._objectBlocks[o]=new K(t,n,r,i,null)},this.removeObjectBlock=function(e,t,n,r){var i=t+"|"+n+"|"+r;e._objectBlocks[i]&&delete e._objectBlocks[i]},this.removeObjectMeshes=function(e){for(var t=e._objectSystems||[];t.length;){var n=t.pop();n.mesh&&n.mesh.dispose(),n.dispose()}},this.buildObjectMeshes=function(t){Z("start");var n=t.noa.rendering.getScene(),r=t.noa.registry._blockMeshLookup,i={};for(var o in t._objectBlocks){var a=t._objectBlocks[o].id,s=r[a].material,c=s?n.materials.indexOf(s):-1;i[c]||(i[c]={}),i[c][a]||(i[c][a]=[]),i[c][a].push(o)}Z("preprocess");var u=t.i*t.size,l=t.j*t.size,f=t.k*t.size,d=[];for(var p in i){var h=e(t,n,i[p],u,l,f);Z("made SPS");var m=h.buildMesh();Z("built mesh"),m.material=p>-1?n.materials[p]:null,d.push(m),t._objectSystems.push(h)}return Z("end"),d}};function K(e,t,n,r){this.id=0|e,this.x=0|t,this.y=0|n,this.z=0|r}var Y,J,H,X,$,Z=()=>{},Q=n(132),ee=te;function te(e,t,n,r,i,o,a){this.id=t,this.requestID="",this.noa=e,this.isDisposed=!1,this.octreeBlock=null,this.voxels=a,this.i=n,this.j=r,this.k=i,this.size=o,this.x=n*o,this.y=r*o,this.z=i*o,this._terrainDirty=!1,this._objectsDirty=!1,Y=e.registry._solidityLookup,J=e.registry._opacityLookup,H=e.registry._objectLookup,X=e.registry._blockHandlerLookup,this._terrainMesh=null,this._objectBlocks=null,this._objectSystems=null,q.initChunk(this),this.isFull=!1,this.isEmpty=!1;var s=Array.from(Array(27)).map(()=>null);this._neighbors=new Q(s,[3,3,3]).lo(1,1,1),this._neighbors.set(0,0,0,this),this._neighborCount=0,this._maxMeshedNeighbors=0,this._timesMeshed=0,ie(this)}function ne(e,t,n,r,i,o){var a=X[t];if(a){var s=a[n];s&&s(e.x+r,e.y+i,e.z+o)}}function re(e){return 0!==e&&(!!Y[e]||!H[e])}function ie(e){for(var t=!0,n=!0,r=!1,i=e.voxels,o=i.shape[0],a=0;a<o;++a)for(var s=0;s<o;++s)for(var c=i.index(a,s,0),u=0;u<o;++u,++c){var l=i.data[c];0!==l?(t=t&&J[l],n=!1,H[l]&&(oe(e,l,a,s,u),r=!0),ne(e,l,"onLoad",a,s,u)):t=!1}e.isFull=t,e.isEmpty=n,e._terrainDirty=!e.isEmpty,e._objectsDirty=r}function oe(e,t,n,r,i){q.addObjectBlock(e,t,n,r,i),e._objectsDirty=!0}function ae(e,t){for(var n=e.voxels,r=n.shape[0],i=0;i<r;++i)for(var o=0;o<r;++o)for(var a=0;a<r;++a){var s=n.get(i,o,a);s>0&&ne(e,s,t,i,o,a)}}te._createVoxelArray=function(e){var t=new Uint16Array(e*e*e);return new Q(t,[e,e,e])},te.prototype._updateVoxelArray=function(e){ae(this,"onUnload"),q.disposeChunk(this),this.voxels=e,this._terrainDirty=!1,this._objectsDirty=!1,q.initChunk(this),ie(this)},te.prototype.get=function(e,t,n){return this.voxels.get(e,t,n)},te.prototype.getSolidityAt=function(e,t,n){return Y[this.voxels.get(e,t,n)]},te.prototype.set=function(e,t,n,r){var i=this.voxels.get(e,t,n),o=i;if(r!==o){this.voxels.set(e,t,n,r),H[i]&&function(e,t,n,r){q.removeObjectBlock(e,t,n,r),e._objectsDirty=!0}(this,e,t,n),H[r]&&oe(this,r,e,t,n),ne(this,o,"onUnset",e,t,n),ne(this,r,"onSet",e,t,n),J[r]||(this.isFull=!1),0!==r&&(this.isEmpty=!1),(re(r)||re(i))&&(this._terrainDirty=!0),(this._terrainDirty||this._objectsDirty)&&this.noa.world._queueChunkForRemesh(this);var a=!1;if(Y[i]!==Y[r]&&(a=!0),J[i]!==J[r]&&(a=!0),a){var s=this.size-1,c=0===e?-1:e<s?0:1,u=0===t?-1:t<s?0:1,l=0===n?-1:n<s?0:1;if(c|u|l){var f=u?[0,u]:[0],d=l?[0,l]:[0];(c?[0,c]:[0]).forEach(e=>{f.forEach(t=>{d.forEach(n=>{if(0!=(e|t|n)){var r=this._neighbors.get(e,t,n);r&&(r._terrainDirty=!0,this.noa.world._queueChunkForRemesh(r))}})})})}}}},te.prototype.mesh=function(e,t,n,r,i){return $||($=new B(this.noa)),$.meshChunk(this,e,t,!1,n,r,i)},te.prototype.updateMeshes=function(){var e=this.noa.rendering;if(this._terrainDirty){this._terrainMesh&&this._terrainMesh.dispose();var t=this.mesh();if(t&&t.getIndices().length>0){var n=[this.x,this.y,this.z];e.addMeshToScene(t,!0,n,this)}this._terrainMesh=t||null,this._terrainDirty=!1,this._timesMeshed++,this._maxMeshedNeighbors=Math.max(this._maxMeshedNeighbors,this._neighborCount)}if(this._objectsDirty){q.removeObjectMeshes(this);var r=q.buildObjectMeshes(this),i=[this.x,this.y,this.z];r.forEach(t=>e.addMeshToScene(t,!0,i,this)),this._objectsDirty=!1}},te.prototype.dispose=function(){ae(this,"onUnload"),q.disposeChunk(this),this._terrainMesh&&this._terrainMesh.dispose(),this.voxels.data=null,this.voxels=null,this._neighbors.data=null,this._neighbors=null,this.isDisposed=!0};var se=n(123).EventEmitter,ce={chunkSize:24,chunkAddDistance:3,chunkRemoveDistance:4,worldGenWhilePaused:!1,manuallyControlChunkLoading:!1};function ue(e,t){var n;this.noa=e,t=Object.assign({},ce,t),this.playerChunkLoaded=!1,this.Chunk=ee,this.chunkSize=t.chunkSize,this.chunkAddDistance=t.chunkAddDistance,this.chunkRemoveDistance=t.chunkRemoveDistance,this.chunkRemoveDistance<this.chunkAddDistance&&(this.chunkRemoveDistance=this.chunkAddDistance),this.manuallyControlChunkLoading=!!t.manuallyControlChunkLoading,this.minNeighborsToMesh=6,this.maxChunksPendingCreation=10,this.maxChunksPendingMeshing=10,this.maxProcessingPerTick=9,this.maxProcessingPerRender=5,this.worldGenWhilePaused=t.worldGenWhilePaused,this._cachedWorldName="",this._lastPlayerChunkID="",this._chunkStorage={},(n=this)._chunkIDsKnown=new d,n._chunkIDsToRequest=new d,n._chunkIDsPending=new d,n._chunkIDsToMesh=new d,n._chunkIDsToMeshFirst=new d,n._chunkIDsToRemove=new d,n._queueChunkForRemesh=e=>{ve(n,e)},function(e){e._getChunk=(t,n,r)=>{var i=fe(t,n,r);return e._chunkStorage[i]||null},e._setChunk=(t,n,r,i)=>{var o=fe(t,n,r);i?e._chunkStorage[o]=i:delete e._chunkStorage[o]},e._getChunkByCoords=function(t,n,r){var i=e._worldCoordToChunkCoord(t),o=e._worldCoordToChunkCoord(n),a=e._worldCoordToChunkCoord(r);return e._getChunk(i,o,a)}}(this),this.removeChunk=function(e){ye(this,e)};var r=this.chunkSize;if(0==(r&r-1)){var i=0|Math.log2(r),o=r-1|0;this._worldCoordToChunkCoord=e=>e>>i|0,this._worldCoordToChunkIndex=e=>e&o|0}else this._worldCoordToChunkCoord=e=>0|Math.floor(e/r),this._worldCoordToChunkIndex=e=>(e%r+r)%r|0}ue.prototype=Object.create(se.prototype),ue.prototype.getBlockID=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return r?r.get(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n)):0},ue.prototype.getBlockSolidity=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return!!r&&!!r.getSolidityAt(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n))},ue.prototype.getBlockOpacity=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockOpacity(r)},ue.prototype.getBlockFluidity=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockFluidity(r)},ue.prototype.getBlockProperties=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockProps(r)},ue.prototype.getBlockObjectMesh=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return r?r.getObjectMeshAt(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n)):0},ue.prototype.setBlockID=function(e,t,n,r){var i=this._worldCoordToChunkCoord(t),o=this._worldCoordToChunkCoord(n),a=this._worldCoordToChunkCoord(r),s=this._worldCoordToChunkIndex(t),c=this._worldCoordToChunkIndex(n),u=this._worldCoordToChunkIndex(r),l=this._getChunk(i,o,a);l&&l.set(s,c,u,e)},ue.prototype.isBoxUnobstructed=function(e){for(var t=e.base,n=e.max,r=Math.floor(t[0]);r<n[0]+1;r++)for(var i=Math.floor(t[1]);i<n[1]+1;i++)for(var o=Math.floor(t[2]);o<n[2]+1;o++)if(this.getBlockSolidity(r,i,o))return!1;return!0},ue.prototype.setChunkData=function(e,t,n){!function(e,t,n,r){var i=t.split("|"),o=parseInt(i.shift()),a=parseInt(i.shift()),s=parseInt(i.shift()),c=i.join("|"),u=fe(o,a,s);if(e._chunkIDsPending.remove(u),c!==e.noa.worldName)return;if(!e._chunkIDsKnown.includes(u))return;if(e._chunkIDsToRemove.includes(u))return;var l=e._chunkStorage[u];if(l){l._updateVoxelArray(n),l._neighbors.data.forEach(t=>{t&&t!==l&&t._neighborCount>20&&ve(e,t)})}else{var f=e.chunkSize;l=new ee(e.noa,u,o,a,s,f,n),e._setChunk(o,a,s,l),l.requestID=t,l.userData=r,be(e,o,a,s,l),e.noa.rendering.prepareChunkForRendering(l),e.emit("chunkAdded",l)}ve(e,l),ke("receive")}(this,e,t,n)},ue.prototype.invalidateVoxelsInAABB=function(e){!function(e,t){var n=t.base.map(t=>Math.floor(e._worldCoordToChunkCoord(t))),r=t.max.map(t=>Math.floor(e._worldCoordToChunkCoord(t)));e._chunkIDsKnown.forEach(t=>{for(var i=de(t),o=0;o<3;o++)if(i[o]<n[o]||i[o]>r[o])return;e._chunkIDsToRemove.includes(t)||e._chunkIDsToRequest.add(t)})}(this,e)},ue.prototype.manuallyLoadChunk=function(e,t,n){if(!this.manuallyControlChunkLoading)throw le;var r=fe(this._worldCoordToChunkCoord(e),this._worldCoordToChunkCoord(t),this._worldCoordToChunkCoord(n));this._chunkIDsKnown.add(r),this._chunkIDsToRequest.add(r)},ue.prototype.manuallyUnloadChunk=function(e,t,n){if(!this.manuallyControlChunkLoading)throw le;var r=fe(this._worldCoordToChunkCoord(e),this._worldCoordToChunkCoord(t),this._worldCoordToChunkCoord(n));this._chunkIDsToRemove.add(r),this._chunkIDsToRequest.remove(r),this._chunkIDsToMesh.remove(r),this._chunkIDsToMeshFirst.remove(r)};var le="Set `noa.world.manuallyControlChunkLoading` if you need this API";function fe(e,t,n){return e+"|"+t+"|"+n}function de(e){return e.split("|").map(e=>parseInt(e))}function pe(e){var t=e.noa.entities.getPosition(e.noa.playerEntity);return[e._worldCoordToChunkCoord(t[0]),e._worldCoordToChunkCoord(t[1]),e._worldCoordToChunkCoord(t[2])]}ue.prototype.tick=function(){var e=performance.now();this._cachedWorldName!==this.noa.worldName&&(!function(e){e._chunkIDsToRemove.copyFrom(e._chunkIDsKnown),e._chunkIDsToRequest.empty(),e._chunkIDsToMesh.empty(),e._chunkIDsToMeshFirst.empty();var t=pe(e);ge(e._chunkIDsToRemove,t[0],t[1],t[2])}(this),this._cachedWorldName=this.noa.worldName);var t,n,r,i,o,a,s=pe(this),f=fe(s[0],s[1],s[2]),d=f!=this._lastPlayerChunkID;if(d&&(this.emit("playerEnteredChunk",s[0],s[1],s[2]),this._lastPlayerChunkID=f),_e("start"),ke("start"),!this.manuallyControlChunkLoading){d&&(t=this,n=s[0],r=s[1],i=s[2],o=t.chunkRemoveDistance*t.chunkRemoveDistance,a=t._chunkIDsToRemove,t._chunkIDsKnown.forEach(e=>{if(!a.includes(e)){var s=de(e),c=s[0]-n,u=s[1]-r,l=s[2]-i;c*c+u*u+l*l<o||(t._chunkIDsToRemove.add(e),t._chunkIDsToRequest.remove(e),t._chunkIDsToMesh.remove(e),t._chunkIDsToMeshFirst.remove(e))}}),ge(a,n,r,i),_e("remQueue"));var p=function(e){if(e===u)return l;for(var t=Math.ceil(e),n=0,r=e*e,i=-t;i<=t;++i)for(var o=-t;o<=t;++o)for(var a=-t;a<=t;++a){i*i+o*o+a*a<r&&n++}return u=e,l=n,n}(this.chunkAddDistance);(d||this._chunkIDsKnown.count()<p)&&(!function(e,t,n,r){for(var i=Math.ceil(e.chunkAddDistance),o=e.chunkAddDistance*e.chunkAddDistance,a=e._chunkIDsKnown,s=e._chunkIDsToRequest,c=t-i;c<=t+i;++c)for(var u=n-i;u<=n+i;++u)for(var l=r-i;l<=r+i;++l){var f=fe(c,u,l);if(!a.includes(f)){var d=c-t,p=u-n,h=l-r;d*d+p*p+h*h>o||(a.add(f),s.add(f))}}ge(s,t,n,r)}(this,s[0],s[1],s[2]),_e("addQueue"))}c(this.maxProcessingPerTick,()=>{var e=function(e){var t=e._chunkIDsToRequest;if(t.isEmpty())return!0;var n=e._chunkIDsPending.count(),r=e._chunkIDsToMesh.count();if(n>=e.maxChunksPendingCreation)return!0;if(r>=e.maxChunksPendingMeshing)return!0;var i=t.pop();return function(e,t){var n=de(t),r=n[0],i=n[1],o=n[2],a=e.chunkSize,s=ee._createVoxelArray(e.chunkSize),c=e.noa.worldName,u=[r,i,o,c].join("|"),l=r*a,f=i*a,d=o*a;e._chunkIDsPending.add(t),e.emit("worldDataNeeded",u,s,l,f,d,c),ke("request")}(e,i),t.isEmpty()}(this);return _e("requests"),e=e&&function(e){var t=e._chunkIDsToRemove;return!!t.isEmpty()||(ye(e,t.pop()),t.isEmpty())}(this),_e("removes"),e=e&&me(this,!1),_e("meshes"),e},e),performance.now()-e+2<this.maxProcessingPerTick&&(!function(e){for(var t=e._chunkIDsKnown.arr,n=Math.min(50,t.length),r=e._chunkIDsToMesh.count()+e._chunkIDsToMeshFirst.count(),i=0;i<n;i++){he=(he+1)%t.length;var o=t[he],a=e._chunkStorage[o];if(a){var s=a._neighborCount;if(!(s<e.minNeighborsToMesh)&&!(s<=a._maxMeshedNeighbors)&&(ve(e,a),++r>10))return}}}(this),_e("looking"),c(this.maxProcessingPerTick,()=>{var e=me(this,!1);return _e("meshes"),e},e));var h=this._getChunk(s[0],s[1],s[2]);this.playerChunkLoaded=!!h,ke("end",this),_e("end")},ue.prototype.render=function(){c(this.maxProcessingPerRender,()=>me(this,!0))};var he=-1;function me(e,t){var n=e._chunkIDsToMeshFirst;if(n.isEmpty()&&!t&&(n=e._chunkIDsToMesh),n.isEmpty())return!0;var r=n.pop();if(!e._chunkIDsToRemove.includes(r)){var i=e._chunkStorage[r];i&&function(e,t){e._chunkIDsToMesh.remove(t.id),e._chunkIDsToMeshFirst.remove(t.id),t.updateMeshes(),ke("mesh")}(e,i)}}function ye(e,t){var n=de(t),r=e._getChunk(n[0],n[1],n[2]);r&&(e.emit("chunkBeingRemoved",r.requestID,r.voxels,r.userData),e.noa.rendering.disposeChunkForRendering(r),r.dispose(),ke("dispose"),be(e,n[0],n[1],n[2],null)),e._setChunk(n[0],n[1],n[2],null),e._chunkIDsKnown.remove(t),e._chunkIDsToMesh.remove(t),e._chunkIDsToMeshFirst.remove(t)}function ve(e,t){var n=t._neighborCount;n<Math.min(e.minNeighborsToMesh,26)||(t._terrainDirty=!0,(26===n?e._chunkIDsToMeshFirst:e._chunkIDsToMesh).add(t.id))}function ge(e,t,n,r){e.sort(e=>{var i=de(e),o=i[0]-t,a=i[1]-n,s=i[2]-r;return o*o+s*s+Math.abs(a)})}function be(e,t,n,r,i){for(var o=-1;o<=1;o++)for(var a=-1;a<=1;a++)for(var s=-1;s<=1;s++)if(0!=(o|a|s)){var c=fe(t+o,n+a,r+s),u=e._chunkStorage[c];u&&(i?(i._neighborCount++,i._neighbors.set(o,a,s,u),u._neighborCount++,u._neighbors.set(-o,-a,-s,i),26===u._neighborCount&&ve(e,u)):(u._neighborCount--,u._neighbors.set(-o,-a,-s,null)))}}function we(e,t,n,r){var i=0,o=0,a=0,s=0,c=[];n.forEach(t=>{var n=e._chunkStorage[t];n&&(a++,c.push(n._timesMeshed),n.isFull&&i++,n.isEmpty&&o++,26===n._neighborCount&&s++)});var u=n.length.toString().padEnd(8);if(u+=("exist: "+a).padEnd(12),u+=("full: "+i).padEnd(12),u+=("empty: "+o).padEnd(12),u+=("surr: "+s).padEnd(12),r){var l=c.reduce((e,t)=>e+t,0),f=c.reduce((e,t)=>Math.max(e,t),0),d=c.reduce((e,t)=>Math.min(e,t),0);u+="times meshed: avg "+(l/a).toFixed(2),u+="  max "+f,u+="  min "+d}console.log(t,u)}ue.prototype.report=function(){console.log("World report - playerChunkLoaded: ",this.playerChunkLoaded),we(this,"  known:     ",this._chunkIDsKnown.arr,!0),we(this,"  to request:",this._chunkIDsToRequest.arr),we(this,"  to remove: ",this._chunkIDsToRemove.arr),we(this,"  creating:  ",this._chunkIDsPending.arr),we(this,"  to mesh:   ",this._chunkIDsToMesh.arr.concat(this._chunkIDsToMeshFirst.arr))};var _e=()=>{},ke=()=>{};var xe=n(306),Oe=function(e,t,n){return function(e,t,n){t=Object.assign({},Pe,t);var r=xe(n,t),i=t.bindings;for(var o in i){var a=Array.isArray(i[o])?i[o]:[i[o]];a.unshift(o),r.bind.apply(r,a)}return r}(0,t,n)},Pe={bindings:{forward:["W","<up>"],left:["A","<left>"],backward:["S","<down>"],right:["D","<right>"],fire:"<mouse 1>","mid-fire":["<mouse 2>","Q"],"alt-fire":["<mouse 3>","E"],jump:"<space>",sprint:"<shift>",crouch:"<control>"}};var Se=n(309),Ce=function(e,t){return function(e,t){t=Object.assign({},Te,t);var n=e.world,r=e.registry._solidityLookup,i=e.registry._fluidityLookup,o=e.worldOriginOffset;return Se(t,(e,t,i)=>{var a=n.getBlockID(e+o[0],t+o[1],i+o[2]);return r[a]},(e,t,r)=>{var a=n.getBlockID(e+o[0],t+o[1],r+o[2]);return i[a]})}(e,t)},Te={gravity:[0,-10,0],airDrag:.1};var Ee=n(77),je=n(211),Me=n(242),De={inverseX:!1,inverseY:!1,sensitivityX:10,sensitivityY:10,initialZoom:0,zoomSpeed:.2};function Ie(e,t){this.noa=e,t=Object.assign({},De,t),this.sensitivityX=t.sensitivityX,this.sensitivityY=t.sensitivityY,this.inverseX=t.inverseX,this.inverseY=t.inverseY,this.heading=0,this.pitch=0,this.cameraTarget=this.noa.ents.createEntity(["position"]);var n=.9*e.ents.getPositionData(e.playerEntity).height;e.ents.addComponent(this.cameraTarget,"followsEntity",{entity:e.playerEntity,offset:[0,n,0]}),this.zoomDistance=t.initialZoom,this.zoomSpeed=t.zoomSpeed,this.currentZoom=t.initialZoom,this._dirVector=Ee.fromValues(0,1,0)}Ie.prototype._localGetTargetPosition=function(){var e=this.noa.ents.getPositionData(this.cameraTarget);return Ee.copy(Re,e._renderPosition)},Ie.prototype._localGetPosition=function(){var e=this._localGetTargetPosition();return 0===this.currentZoom?e:Ee.scaleAndAdd(e,e,this._dirVector,-this.currentZoom)};var Re=Ee.create();Ie.prototype.getTargetPosition=function(){var e=this._localGetTargetPosition();return this.noa.localToGlobal(e,Ae)};var Ae=[];Ie.prototype.getPosition=function(){var e=this._localGetPosition();return this.noa.localToGlobal(e,Ae)},Ie.prototype.getDirection=function(){return this._dirVector},Ie.prototype.applyInputsToCamera=function(){var e=this.noa.inputs.state;!function(e){var t=e.dx,n=e.dy,r=document.body.clientWidth/6,i=document.body.clientHeight/6,o=Math.abs(t)>r&&t/Ve<-1,a=Math.abs(n)>i&&n/Ge<-1;o||a?(e.dx=Ve,e.dy=Ge,Ve=t>0?1:-1,Ge=n>0?1:-1):(t&&(Ve=t),n&&(Ge=n))}(e);var t=.0066*Math.PI/180,n=e.dy*this.sensitivityY*t,r=e.dx*this.sensitivityX*t;this.inverseY&&(n=-n),this.inverseX&&(r=-r);var i=2*Math.PI;this.heading+=r<0?r+i:r,this.heading>i&&(this.heading-=i);var o=Math.PI/2-.001;this.pitch=Math.max(-o,Math.min(o,this.pitch+n)),Ee.set(this._dirVector,0,0,1),Ee.rotateX(this._dirVector,this._dirVector,Be,this.pitch),Ee.rotateY(this._dirVector,this._dirVector,Be,this.heading)};var Be=Ee.create();Ie.prototype.updateBeforeEntityRenderSystems=function(){this.currentZoom+=(this.zoomDistance-this.currentZoom)*this.zoomSpeed},Ie.prototype.updateAfterEntityRenderSystems=function(){var e=function(e){if(!Le){var t=e.noa.worldOriginOffset;Le=new je([0,0,0],Ee.clone(Ne)),ze=(n,r,i)=>e.noa.world.getBlockSolidity(n+t[0],r+t[1],i+t[2]),Ee.scale(Ne,Ne,-.5)}Le.setPosition(e._localGetTargetPosition()),Le.translate(Ne);var n=Math.max(e.zoomDistance,e.currentZoom)+.1;return Ee.scale(Fe,e.getDirection(),-n),Me(ze,Le,Fe,Ue,!0)}(this);this.currentZoom>e&&(this.currentZoom=e)};var Le,ze,Ne=Ee.fromValues(.2,.2,.2),Fe=Ee.create(),Ue=()=>!0;var Ve=0,Ge=0,We={texturePath:""},qe={solid:!0,opaque:!0,fluidDensity:1,viscosity:.5};function Ke(e,t){this.noa=e,t=Object.assign({},We,t);var n=[!1],r=[!1],i=[!1],o=[!1],a=[0,0,0,0,0,0],s=[null],c=[null],u=[null],l={},f=[null],d=t.texturePath;this.registerBlock=function(e,t){t=t||{},qe.solid=!t.fluid,qe.opaque=!t.fluid;var f=Object.assign({},qe,t);if(e<1||e>65535)throw"Block id out of range: "+e;for(;e>n.length;)this.registerBlock(n.length,{});n[e]=!!f.solid,r[e]=!!f.opaque,i[e]=!!f.fluid,o[e]=!!f.blockMesh,c[e]=f.blockMesh||null;var d,p=f.material||null;if(p)if("string"==typeof p)d=[p,p,p,p,p,p];else if(p.length&&2==p.length)d=[p[1],p[1],p[0],p[0],p[1],p[1]];else if(p.length&&3==p.length)d=[p[2],p[2],p[0],p[1],p[2],p[2]];else{if(!p.length||6!=p.length)throw"Invalid material parameter: "+p;d=p}else d=[null,null,null,null,null,null];for(var h=0;h<6;++h)a[6*e+h]=Ye(this,l,d[h],!0);s[e]={},i[e]&&(s[e].fluidDensity=f.fluidDensity,s[e].viscosity=f.viscosity);var m=f.onLoad||f.onUnload||f.onSet||f.onUnset||f.onCustomMeshCreate;return u[e]=m?new Je(f):null,e},this.registerMaterial=function(e,t,n,r,i){var o=l[e]||f.length;l[e]=o;var a=1;return t&&4==t.length&&(a=t.pop()),f[o]={color:t||[1,1,1],alpha:a,texture:n?d+n:"",textureAlpha:!!r,renderMat:i||null},o},this.getBlockSolidity=function(e){return n[e]},this.getBlockOpacity=function(e){return r[e]},this.getBlockFluidity=function(e){return i[e]},this.getBlockProps=function(e){return s[e]},this.getBlockFaceMaterial=function(e,t){return a[6*e+t]},this.getMaterialColor=function(e){return f[e].color},this.getMaterialTexture=function(e){return f[e].texture},this.getMaterialData=function(e){return f[e]},this._solidityLookup=n,this._opacityLookup=r,this._fluidityLookup=i,this._objectLookup=o,this._blockMeshLookup=c,this._blockHandlerLookup=u,this._getMaterialVertexColor=function(e){return f[e].texture?p:f[e].color};var p=[1,1,1];this.registerMaterial("dirt",[.4,.3,0],null),this.registerBlock(1,{material:"dirt"})}function Ye(e,t,n,r){if(!n)return 0;var i=t[n];return void 0===i&&r&&(i=e.registerMaterial(n)),i}function Je(e){this.onLoad=e.onLoad||null,this.onUnload=e.onUnload||null,this.onSet=e.onSet||null,this.onUnset=e.onUnset||null,this.onCustomMeshCreate=e.onCustomMeshCreate||null}var He=n(219),Xe=n(220),$e=n(77),Ze=n(311),Qe={shadowDistance:10};function et(e,t){Ze.call(this),this.noa=e,t=Object.assign({},Qe,t),this.names={};var r={shadow:t.shadowDistance},i=n(313);i.keys().forEach(t=>{var n=/\.\/(.*)\.js/.exec(t)[1],o=r[n]||void 0,a=i(t);a.default&&(a=a.default);var s=a(e,o),c=this.createComponent(s);this.names[n]=c}),this.isPlayer=function(t){return t===e.playerEntity},this.hasPhysics=this.getComponentAccessor(this.names.physics),this.cameraSmoothed=this.getComponentAccessor(this.names.smoothCamera),this.hasMesh=this.getComponentAccessor(this.names.mesh),this.hasPosition=this.getComponentAccessor(this.names.position);var o=this.getStateAccessor(this.names.position);function a(t,n){$e.copy(n._renderPosition,n._localPosition),$e.add(n.position,n._localPosition,e.worldOriginOffset),Object(He.updatePositionExtents)(n);var r=s(t);r&&Object(Xe.setPhysicsFromPosition)(r,n)}this.getPositionData=o,this._localGetPosition=function(e){return o(e)._localPosition},this.getPosition=function(e){return o(e).position},this._localSetPosition=function(e,t){var n=o(e);$e.copy(n._localPosition,t),a(e,n)},this.setPosition=(t,n,r,i)=>{"number"==typeof n&&(n=[n,r,i]);var o=e.globalToLocal(n,null,[]);this._localSetPosition(t,o)},this.setEntitySize=function(e,t,n,r){var i=o(e);i.width=(t+r)/2,i.height=n,a(e,i)},this._rebaseOrigin=function(e){this.getStatesList(this.names.position).forEach(t=>{$e.subtract(t._localPosition,t._localPosition,e),a(t.__id,t)})};var s=this.getStateAccessor(this.names.physics);this.getPhysics=s,this.getPhysicsBody=function(e){return s(e).body},this.getMeshData=this.getStateAccessor(this.names.mesh),this.getMovement=this.getStateAccessor(this.names.movement),this.getCollideTerrain=this.getStateAccessor(this.names.collideTerrain),this.getCollideEntities=this.getStateAccessor(this.names.collideEntities),this.onPairwiseEntityCollision=function(e,t){}}function tt(e,t){return!(e[0]>t[3])&&(!(e[1]>t[4])&&(!(e[2]>t[5])&&(!(e[3]<t[0])&&(!(e[4]<t[1])&&!(e[5]<t[2])))))}et.prototype=Object.create(Ze.prototype),et.prototype.constructor=et,et.prototype.addComponentAgain=function(e,t,n){this.hasComponent(e,t)&&this.removeComponent(e,t,!0),this.addComponent(e,t,n)},et.prototype.isTerrainBlocked=function(e,t,n){for(var r=this.noa.worldOriginOffset,i=Math.floor(e-r[0]),o=Math.floor(t-r[1]),a=Math.floor(n-r[2]),s=[i+.001,o+.001,a+.001,i+.999,o+.999,a+.999],c=this.getStatesList(this.names.collideTerrain),u=0;u<c.length;u++){var l=c[u].__id;if(tt(s,this.getPositionData(l)._extents))return!0}return!1},et.prototype.getEntitiesInAABB=function(e,t){var n=this.noa.worldOriginOffset,r=[e.base[0]+n[0],e.base[1]+n[1],e.base[2]+n[2],e.max[0]+n[0],e.max[1]+n[1],e.max[2]+n[2]],i=t?this.getStatesList(t).map(e=>this.getPositionData(e.__id)):this.getStatesList(this.names.position),o=[];return i.forEach(e=>{tt(r,e._extents)&&o.push(e.__id)}),o},et.prototype.add=function(e,t,n,r,i,o,a){var s=this,c=this.createEntity();if(this.addComponent(c,this.names.position,{position:e||[0,0,0],width:t,height:n}),o){this.addComponent(c,this.names.physics);var u=this.getPhysicsBody(c),l=this.names.smoothCamera;u.onStep=function(){s.addComponentAgain(c,l)}}return r&&(i||(i=$e.create()),this.addComponent(c,this.names.mesh,{mesh:r,offset:i})),a&&this.addComponent(c,this.names.shadow,{size:t}),c}
/*!
 * noa: an experimental voxel game engine.
 * @url      github.com/andyhall/noa
 * @author   Andy Hall <andy@fenomas.com>
 * @license  MIT
 */;var nt=n(77),rt=n(132),it=n(292),ot=n(123).EventEmitter,at=(t.default=st,{debug:!1,silent:!1,playerHeight:1.8,playerWidth:.6,playerStart:[0,10,0],playerAutoStep:!1,tickRate:33,blockTestDistance:10,stickyPointerLock:!0,dragCameraOutsidePointerLock:!0,skipDefaultHighlighting:!1,originRebaseDistance:25});function st(e){if(!(this instanceof st))return new st(e);this.version=n(333).version,e=Object.assign({},at,e),this._tickRate=e.tickRate,this._lastRenderTime=0,this._paused=!1,this._dragOutsideLock=e.dragCameraOutsidePointerLock;var t=this;if(!e.silent){var r=e.debug?" (debug)":"";console.log(`noa-engine v${this.version}${r}`)}this.worldOriginOffset=[0,0,0],this._originRebaseDistance=e.originRebaseDistance,this.vec3=nt,this.positionInCurrentTick=0,this.worldName="default",this.container=function(e,t){return new o(e,t)}(this,e),this.inputs=Oe(0,e,this.container.element),this.registry=function(e,t){return new Ke(e,t)}(this,e),this.world=function(e,t){return new ue(e,t)}(this,e),this.rendering=function(e,t,n){return new P(e,t,n)}(this,e,this.container.canvas),this.physics=Ce(this,e),this.entities=function(e,t){return new et(e,t)}(this,e),this.ents=this.entities;var i=this.ents;this.playerEntity=i.add(e.playerStart,e.playerWidth,e.playerHeight,null,null,!0,!0),i.addComponent(this.playerEntity,i.names.collideTerrain),i.addComponent(this.playerEntity,i.names.collideEntities);var a=i.getPhysicsBody(this.playerEntity);a.gravityMultiplier=2,a.autoStep=e.playerAutoStep,i.addComponent(this.playerEntity,i.names.receivesInputs),i.addComponent(this.playerEntity,i.names.fadeOnZoom);var s,c,u;i.addComponent(this.playerEntity,i.names.movement,{airJumps:1}),this.camera=function(e,t){return new Ie(e,t)}(this,e),this.blockTestDistance=e.blockTestDistance,this.blockTargetIdCheck=this.registry.getBlockSolidity,this.targetedBlock=null,e.skipDefaultHighlighting||(this.defaultBlockHighlightFunction=function(e){e?t.rendering.highlightBlockFace(!0,e.position,e.normal):t.rendering.highlightBlockFace(!1)},this.on("targetBlockChanged",this.defaultBlockHighlightFunction)),e.debug&&(window.noa=this,window.scene=this.rendering._scene,window.ndarray=rt,window.vec3=nt,i.getMovement(1).airJumps=999,this.setViewDistance=function(e){var t=this.world.chunkSize;this.world.chunkAddDistance=e/t,this.world.chunkRemoveDistance=e/t+1,this.world._lastPlayerChunkID=""}),c="0.27",(u=(e,t,n)=>{var r=()=>{throw`This property changed in ${c} - ${n}`};Object.defineProperty(e,t,{get:r,set:r})})(s=this,"getPlayerEyePosition","to get the camera/player offset see API docs for `noa.camera.cameraTarget`"),u(s,"setPlayerEyePosition","to set the camera/player offset see API docs for `noa.camera.cameraTarget`"),u(s,"getPlayerPosition","use `noa.ents.getPosition(noa.playerEntity)` or similar"),u(s,"getCameraVector","use `noa.camera.getDirection`"),u(s,"getPlayerMesh","use `noa.ents.getMeshData(noa.playerEntity).mesh` or similar"),u(s,"playerBody","use `noa.ents.getPhysicsBody(noa.playerEntity)`"),u(s.rendering,"zoomDistance","use `noa.camera.zoomDistance`"),u(s.rendering,"_currentZoom","use `noa.camera.currentZoom`"),u(s.rendering,"_cameraZoomSpeed","use `noa.camera.zoomSpeed`"),u(s.rendering,"getCameraVector","use `noa.camera.getDirection`"),u(s.rendering,"getCameraPosition","use `noa.camera.getLocalPosition`"),u(s.rendering,"getCameraRotation","use `noa.camera.heading` and `noa.camera.pitch`"),u(s.rendering,"setCameraRotation","to customize camera behavior see API docs for `noa.camera`"),c="0.28",u(s.rendering,"makeMeshInstance","removed, use Babylon's `mesh.createInstance`"),u(s.world,"_maxChunksPendingCreation",'use `maxChunksPendingCreation` (no "_")'),u(s.world,"_maxChunksPendingMeshing",'use `maxChunksPendingMeshing` (no "_")'),u(s.world,"_maxProcessingPerTick",'use `maxProcessingPerTick` (no "_")'),u(s.world,"_maxProcessingPerRender",'use `maxProcessingPerRender` (no "_")'),c="0.29",u(s,"_constants","removed, voxel IDs are no longer packed with bit flags")}st.prototype=Object.create(ot.prototype),st.prototype.tick=function(){if(this._paused)this.world.worldGenWhilePaused&&this.world.tick(e);else{dt("start"),function(e){var t=e.ents.getPositionData(e.playerEntity)._localPosition,n=e._originRebaseDistance;if(nt.sqrLen(t)<n*n)return;for(var r=[],i=0;i<3;i++){var o=Math.floor(t[i]);r[i]=o,e.worldOriginOffset[i]+=o}e.rendering._rebaseOrigin(r),e.entities._rebaseOrigin(r)}(this);var e=this._tickRate;this.world.tick(e),dt("world"),this.physics.tick(e),dt("physics"),this.rendering.tick(e),dt("rendering"),function(e){var t="",n=e.blockTargetIdCheck||e.registry.getBlockSolidity,r=e._localPick(null,null,null,n);if(r){var i=lt;nt.floor(i.adjacent,r.position),nt.copy(i.normal,r.normal),nt.sub(i.position,i.adjacent,i.normal),i.blockID=e.world.getBlockID(i.position[0],i.position[1],i.position[2]),e.targetedBlock=i,t=i.position.join("|")+i.normal.join("|")+"|"+i.blockID}else e.targetedBlock=null;t!=ft&&(e.emit("targetBlockChanged",e.targetedBlock),ft=t)}(this),dt("targets"),this.entities.tick(e),dt("entities"),this.emit("tick",e),dt("tick event"),dt("end");var t=this.inputs.state;t.scrollx=t.scrolly=t.scrollz=0}},st.prototype.render=function(e){this.positionInCurrentTick=e;var t=performance.now(),n=t-(this._lastRenderTime||t-16);this._lastRenderTime=t,this._paused?this.world.worldGenWhilePaused&&this.world.render():(pt("start"),(this.container.hasPointerLock||!this.container.supportsPointerLock||this._dragOutsideLock&&this.inputs.state.fire)&&this.camera.applyInputsToCamera(),pt("init"),this.world.render(n),pt("meshing"),this.camera.updateBeforeEntityRenderSystems(),this.entities.render(n),this.camera.updateAfterEntityRenderSystems(),pt("entities"),this.emit("beforeRender",n),pt("before render"),this.rendering.render(n),pt("render"),this.emit("afterRender",n),pt("after render"),pt("end"),this.inputs.state.dx=this.inputs.state.dy=0)},st.prototype.globalToLocal=function(e,t,n){var r=this.worldOriginOffset;if(t){for(var i=0;i<3;i++){var o=e[i]-r[i];o+=t[i],n[i]=o}return n}return nt.sub(n,e,r)},st.prototype.localToGlobal=function(e,t,n){var r=this.worldOriginOffset;if(n){for(var i=0;i<3;i++){var o=Math.floor(e[i]);t[i]=o+r[i],n[i]=e[i]-o}return t}return nt.add(t,e,r)},st.prototype.setPaused=function(e){this._paused=!!e,e||(this.inputs.state.dx=this.inputs.state.dy=0)},st.prototype.getBlock=function(e,t,n){return e.length?this.world.getBlockID(e[0],e[1],e[2]):this.world.getBlockID(e,t,n)},st.prototype.setBlock=function(e,t,n,r){return t.length?this.world.setBlockID(e,t[0],t[1],t[2]):this.world.setBlockID(e,t,n,r)},st.prototype.addBlock=function(e,t,n,r){if(t.length){if(this.entities.isTerrainBlocked(t[0],t[1],t[2]))return;return this.world.setBlockID(e,t[0],t[1],t[2]),e}if(!this.entities.isTerrainBlocked(t,n,r))return this.world.setBlockID(e,t,n,r),e},st.prototype.pick=function(e,t,n,r){return 0===n?null:(e&&(this.globalToLocal(e,null,ct),e=ct),this._localPick(e,t,n,r))};var ct=nt.create();st.prototype._localPick=function(e,t,n,r){if(0===n)return null;var i=r||this.registry.getBlockSolidity,o=this.world,a=this.worldOriginOffset;e||(e=this.camera._localGetTargetPosition()),t=t||this.camera.getDirection(),n=n||this.blockTestDistance;var s=ut._localPosition,c=ut.normal;return it((function(e,t,n){var r=o.getBlockID(e+a[0],t+a[1],n+a[2]);return i(r)}),e,t,n,s,c)?(nt.scaleAndAdd(s,s,c,.01),this.localToGlobal(s,ut.position),ut):null};var ut={_localPosition:nt.create(),position:[0,0,0],normal:[0,0,0]};var lt={blockID:0,position:[],normal:[],adjacent:[]},ft="";var dt=()=>{},pt=()=>{}}]);